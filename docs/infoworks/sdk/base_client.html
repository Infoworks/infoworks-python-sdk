<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="pdoc 11.2.0"/>
    <title>infoworks.sdk.base_client API documentation</title>

    <style>/*! * Bootstrap Reboot v5.0.0 (https://getbootstrap.com/) * Copyright 2011-2021 The Bootstrap Authors * Copyright 2011-2021 Twitter, Inc. * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE) * Forked from Normalize.css, licensed MIT (https://github.com/necolas/normalize.css/blob/master/LICENSE.md) */*,::after,::before{box-sizing:border-box}@media (prefers-reduced-motion:no-preference){:root{scroll-behavior:smooth}}body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans","Liberation Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;background-color:#fff;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}hr{margin:1rem 0;color:inherit;background-color:currentColor;border:0;opacity:.25}hr:not([size]){height:1px}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem;font-weight:500;line-height:1.2}h1{font-size:calc(1.375rem + 1.5vw)}@media (min-width:1200px){h1{font-size:2.5rem}}h2{font-size:calc(1.325rem + .9vw)}@media (min-width:1200px){h2{font-size:2rem}}h3{font-size:calc(1.3rem + .6vw)}@media (min-width:1200px){h3{font-size:1.75rem}}h4{font-size:calc(1.275rem + .3vw)}@media (min-width:1200px){h4{font-size:1.5rem}}h5{font-size:1.25rem}h6{font-size:1rem}p{margin-top:0;margin-bottom:1rem}abbr[data-bs-original-title],abbr[title]{-webkit-text-decoration:underline dotted;text-decoration:underline dotted;cursor:help;-webkit-text-decoration-skip-ink:none;text-decoration-skip-ink:none}address{margin-bottom:1rem;font-style:normal;line-height:inherit}ol,ul{padding-left:2rem}dl,ol,ul{margin-top:0;margin-bottom:1rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}dt{font-weight:700}dd{margin-bottom:.5rem;margin-left:0}blockquote{margin:0 0 1rem}b,strong{font-weight:bolder}small{font-size:.875em}mark{padding:.2em;background-color:#fcf8e3}sub,sup{position:relative;font-size:.75em;line-height:0;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}a{color:#0d6efd;text-decoration:underline}a:hover{color:#0a58ca}a:not([href]):not([class]),a:not([href]):not([class]):hover{color:inherit;text-decoration:none}code,kbd,pre,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em;direction:ltr;unicode-bidi:bidi-override}pre{display:block;margin-top:0;margin-bottom:1rem;overflow:auto;font-size:.875em}pre code{font-size:inherit;color:inherit;word-break:normal}code{font-size:.875em;color:#d63384;word-wrap:break-word}a>code{color:inherit}kbd{padding:.2rem .4rem;font-size:.875em;color:#fff;background-color:#212529;border-radius:.2rem}kbd kbd{padding:0;font-size:1em;font-weight:700}figure{margin:0 0 1rem}img,svg{vertical-align:middle}table{caption-side:bottom;border-collapse:collapse}caption{padding-top:.5rem;padding-bottom:.5rem;color:#6c757d;text-align:left}th{text-align:inherit;text-align:-webkit-match-parent}tbody,td,tfoot,th,thead,tr{border-color:inherit;border-style:solid;border-width:0}label{display:inline-block}button{border-radius:0}button:focus:not(:focus-visible){outline:0}button,input,optgroup,select,textarea{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}button,select{text-transform:none}[role=button]{cursor:pointer}select{word-wrap:normal}select:disabled{opacity:1}[list]::-webkit-calendar-picker-indicator{display:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled),button:not(:disabled){cursor:pointer}::-moz-focus-inner{padding:0;border-style:none}textarea{resize:vertical}fieldset{min-width:0;padding:0;margin:0;border:0}legend{float:left;width:100%;padding:0;margin-bottom:.5rem;font-size:calc(1.275rem + .3vw);line-height:inherit}@media (min-width:1200px){legend{font-size:1.5rem}}legend+*{clear:left}::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-fields-wrapper,::-webkit-datetime-edit-hour-field,::-webkit-datetime-edit-minute,::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-text,::-webkit-datetime-edit-year-field{padding:0}::-webkit-inner-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:textfield}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-color-swatch-wrapper{padding:0}::file-selector-button{font:inherit}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}output{display:inline-block}iframe{border:0}summary{display:list-item;cursor:pointer}progress{vertical-align:baseline}[hidden]{display:none!important}</style>
    <style>/*! syntax-highlighting.css */pre{line-height:125%;}span.linenos{color:inherit; background-color:transparent; padding-left:5px; padding-right:20px;}.pdoc-code .hll{background-color:#ffffcc}.pdoc-code{background:#f8f8f8;}.pdoc-code .c{color:#3D7B7B; font-style:italic}.pdoc-code .err{border:1px solid #FF0000}.pdoc-code .k{color:#008000; font-weight:bold}.pdoc-code .o{color:#666666}.pdoc-code .ch{color:#3D7B7B; font-style:italic}.pdoc-code .cm{color:#3D7B7B; font-style:italic}.pdoc-code .cp{color:#9C6500}.pdoc-code .cpf{color:#3D7B7B; font-style:italic}.pdoc-code .c1{color:#3D7B7B; font-style:italic}.pdoc-code .cs{color:#3D7B7B; font-style:italic}.pdoc-code .gd{color:#A00000}.pdoc-code .ge{font-style:italic}.pdoc-code .gr{color:#E40000}.pdoc-code .gh{color:#000080; font-weight:bold}.pdoc-code .gi{color:#008400}.pdoc-code .go{color:#717171}.pdoc-code .gp{color:#000080; font-weight:bold}.pdoc-code .gs{font-weight:bold}.pdoc-code .gu{color:#800080; font-weight:bold}.pdoc-code .gt{color:#0044DD}.pdoc-code .kc{color:#008000; font-weight:bold}.pdoc-code .kd{color:#008000; font-weight:bold}.pdoc-code .kn{color:#008000; font-weight:bold}.pdoc-code .kp{color:#008000}.pdoc-code .kr{color:#008000; font-weight:bold}.pdoc-code .kt{color:#B00040}.pdoc-code .m{color:#666666}.pdoc-code .s{color:#BA2121}.pdoc-code .na{color:#687822}.pdoc-code .nb{color:#008000}.pdoc-code .nc{color:#0000FF; font-weight:bold}.pdoc-code .no{color:#880000}.pdoc-code .nd{color:#AA22FF}.pdoc-code .ni{color:#717171; font-weight:bold}.pdoc-code .ne{color:#CB3F38; font-weight:bold}.pdoc-code .nf{color:#0000FF}.pdoc-code .nl{color:#767600}.pdoc-code .nn{color:#0000FF; font-weight:bold}.pdoc-code .nt{color:#008000; font-weight:bold}.pdoc-code .nv{color:#19177C}.pdoc-code .ow{color:#AA22FF; font-weight:bold}.pdoc-code .w{color:#bbbbbb}.pdoc-code .mb{color:#666666}.pdoc-code .mf{color:#666666}.pdoc-code .mh{color:#666666}.pdoc-code .mi{color:#666666}.pdoc-code .mo{color:#666666}.pdoc-code .sa{color:#BA2121}.pdoc-code .sb{color:#BA2121}.pdoc-code .sc{color:#BA2121}.pdoc-code .dl{color:#BA2121}.pdoc-code .sd{color:#BA2121; font-style:italic}.pdoc-code .s2{color:#BA2121}.pdoc-code .se{color:#AA5D1F; font-weight:bold}.pdoc-code .sh{color:#BA2121}.pdoc-code .si{color:#A45A77; font-weight:bold}.pdoc-code .sx{color:#008000}.pdoc-code .sr{color:#A45A77}.pdoc-code .s1{color:#BA2121}.pdoc-code .ss{color:#19177C}.pdoc-code .bp{color:#008000}.pdoc-code .fm{color:#0000FF}.pdoc-code .vc{color:#19177C}.pdoc-code .vg{color:#19177C}.pdoc-code .vi{color:#19177C}.pdoc-code .vm{color:#19177C}.pdoc-code .il{color:#666666}</style>
    <style>/*! theme.css */:root{--pdoc-background:#fff;}.pdoc{--text:#212529;--muted:#6c757d;--link:#3660a5;--link-hover:#1659c5;--code:#f8f8f8;--active:#fff598;--accent:#eee;--accent2:#c1c1c1;--nav-hover:rgba(255, 255, 255, 0.5);--name:#0066BB;--def:#008800;--annotation:#007020;}</style>
    <style>/*! layout.css */html, body{width:100%;height:100%;}html, main{scroll-behavior:smooth;}body{background-color:var(--pdoc-background);}@media (max-width:769px){#navtoggle{cursor:pointer;position:absolute;width:50px;height:40px;top:1rem;right:1rem;border-color:var(--text);color:var(--text);display:flex;opacity:0.8;}#navtoggle:hover{opacity:1;}#togglestate + div{display:none;}#togglestate:checked + div{display:inherit;}main, header{padding:2rem 3vw;}header + main{margin-top:-3rem;}.git-button{display:none !important;}nav input[type="search"]{max-width:77%;}nav input[type="search"]:first-child{margin-top:-6px;}nav input[type="search"]:valid ~ *{display:none !important;}}@media (min-width:770px){:root{--sidebar-width:clamp(12.5rem, 28vw, 22rem);}nav{position:fixed;overflow:auto;height:100vh;width:var(--sidebar-width);}main, header{padding:3rem 2rem 3rem calc(var(--sidebar-width) + 3rem);width:calc(54rem + var(--sidebar-width));max-width:100%;}header + main{margin-top:-4rem;}#navtoggle{display:none;}}#togglestate{position:absolute;height:0;}nav.pdoc{--pad:clamp(0.5rem, 2vw, 1.75rem);--indent:1.5rem;background-color:var(--accent);border-right:1px solid var(--accent2);box-shadow:0 0 20px rgba(50, 50, 50, .2) inset;padding:0 0 0 var(--pad);overflow-wrap:anywhere;scrollbar-width:thin; scrollbar-color:var(--accent2) transparent }nav.pdoc::-webkit-scrollbar{width:.4rem; }nav.pdoc::-webkit-scrollbar-thumb{background-color:var(--accent2); }nav.pdoc > div{padding:var(--pad) 0;}nav.pdoc .module-list-button{display:inline-flex;align-items:center;color:var(--text);border-color:var(--muted);margin-bottom:1rem;}nav.pdoc .module-list-button:hover{border-color:var(--text);}nav.pdoc input[type=search]{display:block;outline-offset:0;width:calc(100% - var(--pad));}nav.pdoc .logo{max-width:calc(100% - var(--pad));max-height:35vh;display:block;margin:0 auto 1rem;transform:translate(calc(-.5 * var(--pad)), 0);}nav.pdoc ul{list-style:none;padding-left:0;}nav.pdoc > div > ul{margin-left:calc(0px - var(--pad));}nav.pdoc li a{padding:.2rem 0 .2rem calc(var(--pad) + var(--indent));}nav.pdoc > div > ul > li > a{padding-left:var(--pad);}nav.pdoc li{transition:all 100ms;}nav.pdoc li:hover{background-color:var(--nav-hover);}nav.pdoc a, nav.pdoc a:hover{color:var(--text);}nav.pdoc a{display:block;}nav.pdoc > h2:first-of-type{margin-top:1.5rem;}nav.pdoc .class:before{content:"class ";color:var(--muted);}nav.pdoc .function:after{content:"()";color:var(--muted);}nav.pdoc footer:before{content:"";display:block;width:calc(100% - var(--pad));border-top:solid var(--accent2) 1px;margin-top:1.5rem;padding-top:.5rem;}nav.pdoc footer{font-size:small;}</style>
    <style>/*! content.css */.pdoc{color:var(--text);box-sizing:border-box;line-height:1.5;background:none;}.pdoc .pdoc-button{display:inline-block;border:solid black 1px;border-radius:2px;font-size:.75rem;padding:calc(0.5em - 1px) 1em;transition:100ms all;}.pdoc .pdoc-alert{padding:1rem 1rem 1rem calc(1.5rem + 24px);border:1px solid transparent;border-radius:.25rem;background-repeat:no-repeat;background-position:1rem center;margin-bottom:1rem;}.pdoc .pdoc-alert > *:last-child{margin-bottom:0;}.pdoc .pdoc-alert-note {color:#084298;background-color:#cfe2ff;border-color:#b6d4fe;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23084298%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8%2016A8%208%200%201%200%208%200a8%208%200%200%200%200%2016zm.93-9.412-1%204.705c-.07.34.029.533.304.533.194%200%20.487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703%200-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381%202.29-.287zM8%205.5a1%201%200%201%201%200-2%201%201%200%200%201%200%202z%22/%3E%3C/svg%3E");}.pdoc .pdoc-alert-warning{color:#664d03;background-color:#fff3cd;border-color:#ffecb5;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23664d03%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8.982%201.566a1.13%201.13%200%200%200-1.96%200L.165%2013.233c-.457.778.091%201.767.98%201.767h13.713c.889%200%201.438-.99.98-1.767L8.982%201.566zM8%205c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%205.995A.905.905%200%200%201%208%205zm.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2z%22/%3E%3C/svg%3E");}.pdoc .pdoc-alert-danger{color:#842029;background-color:#f8d7da;border-color:#f5c2c7;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23842029%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M5.52.359A.5.5%200%200%201%206%200h4a.5.5%200%200%201%20.474.658L8.694%206H12.5a.5.5%200%200%201%20.395.807l-7%209a.5.5%200%200%201-.873-.454L6.823%209.5H3.5a.5.5%200%200%201-.48-.641l2.5-8.5z%22/%3E%3C/svg%3E");}.pdoc .visually-hidden{position:absolute !important;width:1px !important;height:1px !important;padding:0 !important;margin:-1px !important;overflow:hidden !important;clip:rect(0, 0, 0, 0) !important;white-space:nowrap !important;border:0 !important;}.pdoc h1, .pdoc h2, .pdoc h3{font-weight:300;margin:.3em 0;padding:.2em 0;}.pdoc > section:not(.module-info) h1{font-size:1.5rem;font-weight:500;}.pdoc > section:not(.module-info) h2{font-size:1.4rem;font-weight:500;}.pdoc > section:not(.module-info) h3{font-size:1.3rem;font-weight:500;}.pdoc > section:not(.module-info) h4{font-size:1.2rem;}.pdoc > section:not(.module-info) h5{font-size:1.1rem;}.pdoc a{text-decoration:none;color:var(--link);}.pdoc a:hover{color:var(--link-hover);}.pdoc blockquote{margin-left:2rem;}.pdoc pre{border-top:1px solid var(--accent2);border-bottom:1px solid var(--accent2);margin-top:0;margin-bottom:1em;padding:.5rem 0 .5rem .5rem;overflow-x:auto;background-color:var(--code);}.pdoc code{color:var(--text);padding:.2em .4em;margin:0;font-size:85%;background-color:var(--code);border-radius:6px;}.pdoc a > code{color:inherit;}.pdoc pre > code{display:inline-block;font-size:inherit;background:none;border:none;padding:0;}.pdoc > section:not(.module-info){margin-bottom:1.5rem;}.pdoc .modulename{margin-top:0;font-weight:bold;}.pdoc .modulename a{color:var(--link);transition:100ms all;}.pdoc .git-button{float:right;border:solid var(--link) 1px;}.pdoc .git-button:hover{background-color:var(--link);color:var(--pdoc-background);}.pdoc details{filter:opacity(1);}.pdoc details:not([open]){height:0;}.pdoc details > summary{position:absolute;top:-35px;right:0;font-size:.75rem;color:var(--muted);padding:0 .7em;user-select:none;cursor:pointer;}.pdoc details > summary:focus{outline:0;}.pdoc > section.module-info details > summary{top:-20px;}.pdoc .docstring{margin-bottom:1.5rem;}.pdoc section:not(.module-info) .docstring{margin-left:clamp(0rem, 5vw - 2rem, 1rem);}.pdoc .docstring .pdoc-code{margin-left:1em;margin-right:1em;}.pdoc h1:target,.pdoc h2:target,.pdoc h3:target,.pdoc h4:target,.pdoc h5:target,.pdoc h6:target,.pdoc .pdoc-code > pre > span:target{background-color:var(--active);box-shadow:-1rem 0 0 0 var(--active);}.pdoc .pdoc-code > pre > span:target{display:block;}.pdoc div:target > .attr,.pdoc section:target > .attr,.pdoc dd:target > a{background-color:var(--active);}.pdoc *{scroll-margin:2rem;}.pdoc .attr:hover{filter:contrast(0.95);}.pdoc .headerlink{position:absolute;width:0;margin-left:-1.5rem;line-height:1.4rem;font-size:1.5rem;font-weight:normal;transition:all 100ms ease-in-out;opacity:0;user-select:none;}.pdoc .attr > .headerlink{margin-left:-2.5rem;}.pdoc *:hover > .headerlink,.pdoc *:target > .attr > .headerlink{opacity:1;}.pdoc .attr{display:block;color:var(--text);margin:.5rem 0 .5rem;padding:.4rem 5rem .4rem 1rem;background-color:var(--accent);}.pdoc .classattr{margin-left:2rem;}.pdoc .name{color:var(--name);font-weight:bold;}.pdoc .def{color:var(--def);font-weight:bold;}.pdoc .signature{white-space:pre-wrap;}.pdoc .annotation{color:var(--annotation);}.pdoc .inherited{margin-left:2rem;}.pdoc .inherited dt{font-weight:700;}.pdoc .inherited dt, .pdoc .inherited dd{display:inline;margin-left:0;margin-bottom:.5rem;}.pdoc .inherited dd:not(:last-child):after{content:", ";}.pdoc .inherited .class:before{content:"class ";}.pdoc .inherited .function a:after{content:"()";}.pdoc .search-result .docstring{overflow:auto;max-height:25vh;}.pdoc .search-result.focused > .attr{background-color:var(--active);}.pdoc .attribution{margin-top:2rem;display:block;opacity:0.5;transition:all 200ms;filter:grayscale(100%);}.pdoc .attribution:hover{opacity:1;filter:grayscale(0%);}.pdoc .attribution img{margin-left:5px;height:35px;vertical-align:middle;width:70px;transition:all 200ms;}.pdoc table{display:block;width:max-content;max-width:100%;overflow:auto;margin-bottom:1rem;}.pdoc table th{font-weight:600;}.pdoc table th, .pdoc table td{padding:6px 13px;border:1px solid var(--accent2);}</style>
    <style>/*! custom.css */</style></head>
<body>
    <nav class="pdoc">
        <label id="navtoggle" for="togglestate" class="pdoc-button"><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'><path stroke-linecap='round' stroke="currentColor" stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/></svg></label>
        <input id="togglestate" type="checkbox" aria-hidden="true" tabindex="-1">
        <div>            <a class="pdoc-button module-list-button" href="../sdk.html">
<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-box-arrow-in-left" viewBox="0 0 16 16">
  <path fill-rule="evenodd" d="M10 3.5a.5.5 0 0 0-.5-.5h-8a.5.5 0 0 0-.5.5v9a.5.5 0 0 0 .5.5h8a.5.5 0 0 0 .5-.5v-2a.5.5 0 0 1 1 0v2A1.5 1.5 0 0 1 9.5 14h-8A1.5 1.5 0 0 1 0 12.5v-9A1.5 1.5 0 0 1 1.5 2h8A1.5 1.5 0 0 1 11 3.5v2a.5.5 0 0 1-1 0v-2z"/>
  <path fill-rule="evenodd" d="M4.146 8.354a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L5.707 7.5H14.5a.5.5 0 0 1 0 1H5.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3z"/>
</svg>                &nbsp;infoworks.sdk</a>


            <input type="search" placeholder="Search..." role="searchbox" aria-label="search"
                   pattern=".+" required>



        <h2>API Documentation</h2>
            <ul class="memberlist">
            <li>
                    <a class="class" href="#TimeoutHTTPAdapter">TimeoutHTTPAdapter</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#TimeoutHTTPAdapter.__init__">TimeoutHTTPAdapter</a>
                        </li>
                        <li>
                                <a class="function" href="#TimeoutHTTPAdapter.send">send</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="function" href="#initialise_http_client">initialise_http_client</a>
            </li>
            <li>
                    <a class="class" href="#BaseClient">BaseClient</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#BaseClient.__init__">BaseClient</a>
                        </li>
                        <li>
                                <a class="function" href="#BaseClient.initialize_client">initialize_client</a>
                        </li>
                        <li>
                                <a class="function" href="#BaseClient.initialize_client_with_defaults">initialize_client_with_defaults</a>
                        </li>
                        <li>
                                <a class="function" href="#BaseClient.get_configurations">get_configurations</a>
                        </li>
                        <li>
                                <a class="function" href="#BaseClient.regenerate_bearer_token_if_needed">regenerate_bearer_token_if_needed</a>
                        </li>
                        <li>
                                <a class="function" href="#BaseClient.call_api">call_api</a>
                        </li>
                        <li>
                                <a class="function" href="#BaseClient.get_mappings_from_config_file">get_mappings_from_config_file</a>
                        </li>
                        <li>
                                <a class="function" href="#BaseClient.get_all_secrets">get_all_secrets</a>
                        </li>
                </ul>

            </li>
    </ul>



        <a class="attribution" title="pdoc: Python API documentation generator" href="https://pdoc.dev" target="_blank">
            built with <span class="visually-hidden">pdoc</span><img
                alt="pdoc logo"
                src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20role%3D%22img%22%20aria-label%3D%22pdoc%20logo%22%20width%3D%22300%22%20height%3D%22150%22%20viewBox%3D%22-1%200%2060%2030%22%3E%3Ctitle%3Epdoc%3C/title%3E%3Cpath%20d%3D%22M29.621%2021.293c-.011-.273-.214-.475-.511-.481a.5.5%200%200%200-.489.503l-.044%201.393c-.097.551-.695%201.215-1.566%201.704-.577.428-1.306.486-2.193.182-1.426-.617-2.467-1.654-3.304-2.487l-.173-.172a3.43%203.43%200%200%200-.365-.306.49.49%200%200%200-.286-.196c-1.718-1.06-4.931-1.47-7.353.191l-.219.15c-1.707%201.187-3.413%202.131-4.328%201.03-.02-.027-.49-.685-.141-1.763.233-.721.546-2.408.772-4.076.042-.09.067-.187.046-.288.166-1.347.277-2.625.241-3.351%201.378-1.008%202.271-2.586%202.271-4.362%200-.976-.272-1.935-.788-2.774-.057-.094-.122-.18-.184-.268.033-.167.052-.339.052-.516%200-1.477-1.202-2.679-2.679-2.679-.791%200-1.496.352-1.987.9a6.3%206.3%200%200%200-1.001.029c-.492-.564-1.207-.929-2.012-.929-1.477%200-2.679%201.202-2.679%202.679A2.65%202.65%200%200%200%20.97%206.554c-.383.747-.595%201.572-.595%202.41%200%202.311%201.507%204.29%203.635%205.107-.037.699-.147%202.27-.423%203.294l-.137.461c-.622%202.042-2.515%208.257%201.727%2010.643%201.614.908%203.06%201.248%204.317%201.248%202.665%200%204.492-1.524%205.322-2.401%201.476-1.559%202.886-1.854%206.491.82%201.877%201.393%203.514%201.753%204.861%201.068%202.223-1.713%202.811-3.867%203.399-6.374.077-.846.056-1.469.054-1.537zm-4.835%204.313c-.054.305-.156.586-.242.629-.034-.007-.131-.022-.307-.157-.145-.111-.314-.478-.456-.908.221.121.432.25.675.355.115.039.219.051.33.081zm-2.251-1.238c-.05.33-.158.648-.252.694-.022.001-.125-.018-.307-.157-.217-.166-.488-.906-.639-1.573.358.344.754.693%201.198%201.036zm-3.887-2.337c-.006-.116-.018-.231-.041-.342.635.145%201.189.368%201.599.625.097.231.166.481.174.642-.03.049-.055.101-.067.158-.046.013-.128.026-.298.004-.278-.037-.901-.57-1.367-1.087zm-1.127-.497c.116.306.176.625.12.71-.019.014-.117.045-.345.016-.206-.027-.604-.332-.986-.695.41-.051.816-.056%201.211-.031zm-4.535%201.535c.209.22.379.47.358.598-.006.041-.088.138-.351.234-.144.055-.539-.063-.979-.259a11.66%2011.66%200%200%200%20.972-.573zm.983-.664c.359-.237.738-.418%201.126-.554.25.237.479.548.457.694-.006.042-.087.138-.351.235-.174.064-.694-.105-1.232-.375zm-3.381%201.794c-.022.145-.061.29-.149.401-.133.166-.358.248-.69.251h-.002c-.133%200-.306-.26-.45-.621.417.091.854.07%201.291-.031zm-2.066-8.077a4.78%204.78%200%200%201-.775-.584c.172-.115.505-.254.88-.378l-.105.962zm-.331%202.302a10.32%2010.32%200%200%201-.828-.502c.202-.143.576-.328.984-.49l-.156.992zm-.45%202.157l-.701-.403c.214-.115.536-.249.891-.376a11.57%2011.57%200%200%201-.19.779zm-.181%201.716c.064.398.194.702.298.893-.194-.051-.435-.162-.736-.398.061-.119.224-.3.438-.495zM8.87%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zm-.735-.389a1.15%201.15%200%200%200-.314.783%201.16%201.16%200%200%200%201.162%201.162c.457%200%20.842-.27%201.032-.653.026.117.042.238.042.362a1.68%201.68%200%200%201-1.679%201.679%201.68%201.68%200%200%201-1.679-1.679c0-.843.626-1.535%201.436-1.654zM5.059%205.406A1.68%201.68%200%200%201%203.38%207.085a1.68%201.68%200%200%201-1.679-1.679c0-.037.009-.072.011-.109.21.3.541.508.935.508a1.16%201.16%200%200%200%201.162-1.162%201.14%201.14%200%200%200-.474-.912c.015%200%20.03-.005.045-.005.926.001%201.679.754%201.679%201.68zM3.198%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zM1.375%208.964c0-.52.103-1.035.288-1.52.466.394%201.06.64%201.717.64%201.144%200%202.116-.725%202.499-1.738.383%201.012%201.355%201.738%202.499%201.738.867%200%201.631-.421%202.121-1.062.307.605.478%201.267.478%201.942%200%202.486-2.153%204.51-4.801%204.51s-4.801-2.023-4.801-4.51zm24.342%2019.349c-.985.498-2.267.168-3.813-.979-3.073-2.281-5.453-3.199-7.813-.705-1.315%201.391-4.163%203.365-8.423.97-3.174-1.786-2.239-6.266-1.261-9.479l.146-.492c.276-1.02.395-2.457.444-3.268a6.11%206.11%200%200%200%201.18.115%206.01%206.01%200%200%200%202.536-.562l-.006.175c-.802.215-1.848.612-2.021%201.25-.079.295.021.601.274.837.219.203.415.364.598.501-.667.304-1.243.698-1.311%201.179-.02.144-.022.507.393.787.213.144.395.26.564.365-1.285.521-1.361.96-1.381%201.126-.018.142-.011.496.427.746l.854.489c-.473.389-.971.914-.999%201.429-.018.278.095.532.316.713.675.556%201.231.721%201.653.721.059%200%20.104-.014.158-.02.207.707.641%201.64%201.513%201.64h.013c.8-.008%201.236-.345%201.462-.626.173-.216.268-.457.325-.692.424.195.93.374%201.372.374.151%200%20.294-.021.423-.068.732-.27.944-.704.993-1.021.009-.061.003-.119.002-.179.266.086.538.147.789.147.15%200%20.294-.021.423-.069.542-.2.797-.489.914-.754.237.147.478.258.704.288.106.014.205.021.296.021.356%200%20.595-.101.767-.229.438.435%201.094.992%201.656%201.067.106.014.205.021.296.021a1.56%201.56%200%200%200%20.323-.035c.17.575.453%201.289.866%201.605.358.273.665.362.914.362a.99.99%200%200%200%20.421-.093%201.03%201.03%200%200%200%20.245-.164c.168.428.39.846.68%201.068.358.273.665.362.913.362a.99.99%200%200%200%20.421-.093c.317-.148.512-.448.639-.762.251.157.495.257.726.257.127%200%20.25-.024.37-.071.427-.17.706-.617.841-1.314.022-.015.047-.022.068-.038.067-.051.133-.104.196-.159-.443%201.486-1.107%202.761-2.086%203.257zM8.66%209.925a.5.5%200%201%200-1%200c0%20.653-.818%201.205-1.787%201.205s-1.787-.552-1.787-1.205a.5.5%200%201%200-1%200c0%201.216%201.25%202.205%202.787%202.205s2.787-.989%202.787-2.205zm4.4%2015.965l-.208.097c-2.661%201.258-4.708%201.436-6.086.527-1.542-1.017-1.88-3.19-1.844-4.198a.4.4%200%200%200-.385-.414c-.242-.029-.406.164-.414.385-.046%201.249.367%203.686%202.202%204.896.708.467%201.547.7%202.51.7%201.248%200%202.706-.392%204.362-1.174l.185-.086a.4.4%200%200%200%20.205-.527c-.089-.204-.326-.291-.527-.206zM9.547%202.292c.093.077.205.114.317.114a.5.5%200%200%200%20.318-.886L8.817.397a.5.5%200%200%200-.703.068.5.5%200%200%200%20.069.703l1.364%201.124zm-7.661-.065c.086%200%20.173-.022.253-.068l1.523-.893a.5.5%200%200%200-.506-.863l-1.523.892a.5.5%200%200%200-.179.685c.094.158.261.247.432.247z%22%20transform%3D%22matrix%28-1%200%200%201%2058%200%29%22%20fill%3D%22%233bb300%22/%3E%3Cpath%20d%3D%22M.3%2021.86V10.18q0-.46.02-.68.04-.22.18-.5.28-.54%201.34-.54%201.06%200%201.42.28.38.26.44.78.76-1.04%202.38-1.04%201.64%200%203.1%201.54%201.46%201.54%201.46%203.58%200%202.04-1.46%203.58-1.44%201.54-3.08%201.54-1.64%200-2.38-.92v4.04q0%20.46-.04.68-.02.22-.18.5-.14.3-.5.42-.36.12-.98.12-.62%200-1-.12-.36-.12-.52-.4-.14-.28-.18-.5-.02-.22-.02-.68zm3.96-9.42q-.46.54-.46%201.18%200%20.64.46%201.18.48.52%201.2.52.74%200%201.24-.52.52-.52.52-1.18%200-.66-.48-1.18-.48-.54-1.26-.54-.76%200-1.22.54zm14.741-8.36q.16-.3.54-.42.38-.12%201-.12.64%200%201.02.12.38.12.52.42.16.3.18.54.04.22.04.68v11.94q0%20.46-.04.7-.02.22-.18.5-.3.54-1.7.54-1.38%200-1.54-.98-.84.96-2.34.96-1.8%200-3.28-1.56-1.48-1.58-1.48-3.66%200-2.1%201.48-3.68%201.5-1.58%203.28-1.58%201.48%200%202.3%201v-4.2q0-.46.02-.68.04-.24.18-.52zm-3.24%2010.86q.52.54%201.26.54.74%200%201.22-.54.5-.54.5-1.18%200-.66-.48-1.22-.46-.56-1.26-.56-.8%200-1.28.56-.48.54-.48%201.2%200%20.66.52%201.2zm7.833-1.2q0-2.4%201.68-3.96%201.68-1.56%203.84-1.56%202.16%200%203.82%201.56%201.66%201.54%201.66%203.94%200%201.66-.86%202.96-.86%201.28-2.1%201.9-1.22.6-2.54.6-1.32%200-2.56-.64-1.24-.66-2.1-1.92-.84-1.28-.84-2.88zm4.18%201.44q.64.48%201.3.48.66%200%201.32-.5.66-.5.66-1.48%200-.98-.62-1.46-.62-.48-1.34-.48-.72%200-1.34.5-.62.5-.62%201.48%200%20.96.64%201.46zm11.412-1.44q0%20.84.56%201.32.56.46%201.18.46.64%200%201.18-.36.56-.38.9-.38.6%200%201.46%201.06.46.58.46%201.04%200%20.76-1.1%201.42-1.14.8-2.8.8-1.86%200-3.58-1.34-.82-.64-1.34-1.7-.52-1.08-.52-2.36%200-1.3.52-2.34.52-1.06%201.34-1.7%201.66-1.32%203.54-1.32.76%200%201.48.22.72.2%201.06.4l.32.2q.36.24.56.38.52.4.52.92%200%20.5-.42%201.14-.72%201.1-1.38%201.1-.38%200-1.08-.44-.36-.34-1.04-.34-.66%200-1.24.48-.58.48-.58%201.34z%22%20fill%3D%22green%22/%3E%3C/svg%3E"/>
        </a>
</div>
    </nav>
    <main class="pdoc">
            <section class="module-info">
                    <h1 class="modulename">
<a href="./../../infoworks.html">infoworks</a><wbr>.<a href="./../sdk.html">sdk</a><wbr>.base_client    </h1>

                
                        <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="L-0"><a href="#L-0"><span class="linenos">  0</span></a><span class="kn">import</span> <span class="nn">json</span>
</span><span id="L-1"><a href="#L-1"><span class="linenos">  1</span></a><span class="kn">import</span> <span class="nn">logging.config</span>
</span><span id="L-2"><a href="#L-2"><span class="linenos">  2</span></a><span class="kn">import</span> <span class="nn">os</span>
</span><span id="L-3"><a href="#L-3"><span class="linenos">  3</span></a><span class="kn">from</span> <span class="nn">configparser</span> <span class="kn">import</span> <span class="n">ConfigParser</span>
</span><span id="L-4"><a href="#L-4"><span class="linenos">  4</span></a><span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
</span><span id="L-5"><a href="#L-5"><span class="linenos">  5</span></a><span class="kn">import</span> <span class="nn">requests</span>
</span><span id="L-6"><a href="#L-6"><span class="linenos">  6</span></a><span class="kn">from</span> <span class="nn">google.cloud</span> <span class="kn">import</span> <span class="n">kms</span><span class="p">,</span> <span class="n">storage</span>
</span><span id="L-7"><a href="#L-7"><span class="linenos">  7</span></a><span class="kn">import</span> <span class="nn">boto3</span>
</span><span id="L-8"><a href="#L-8"><span class="linenos">  8</span></a><span class="kn">import</span> <span class="nn">base64</span>
</span><span id="L-9"><a href="#L-9"><span class="linenos">  9</span></a><span class="kn">from</span> <span class="nn">cryptography.fernet</span> <span class="kn">import</span> <span class="n">Fernet</span>
</span><span id="L-10"><a href="#L-10"><span class="linenos"> 10</span></a><span class="kn">from</span> <span class="nn">infoworks.core.iw_authentication</span> <span class="kn">import</span> <span class="n">is_token_valid</span><span class="p">,</span> <span class="n">get_bearer_token</span><span class="p">,</span> <span class="n">aes_encrypt</span>
</span><span id="L-11"><a href="#L-11"><span class="linenos"> 11</span></a><span class="kn">from</span> <span class="nn">infoworks.sdk</span> <span class="kn">import</span> <span class="n">local_configurations</span>
</span><span id="L-12"><a href="#L-12"><span class="linenos"> 12</span></a><span class="kn">from</span> <span class="nn">requests.adapters</span> <span class="kn">import</span> <span class="n">HTTPAdapter</span>
</span><span id="L-13"><a href="#L-13"><span class="linenos"> 13</span></a><span class="kn">from</span> <span class="nn">urllib3.util.retry</span> <span class="kn">import</span> <span class="n">Retry</span>
</span><span id="L-14"><a href="#L-14"><span class="linenos"> 14</span></a>
</span><span id="L-15"><a href="#L-15"><span class="linenos"> 15</span></a><span class="kn">from</span> <span class="nn">infoworks.sdk.utils</span> <span class="kn">import</span> <span class="n">IWUtils</span>
</span><span id="L-16"><a href="#L-16"><span class="linenos"> 16</span></a>
</span><span id="L-17"><a href="#L-17"><span class="linenos"> 17</span></a>
</span><span id="L-18"><a href="#L-18"><span class="linenos"> 18</span></a><span class="k">class</span> <span class="nc">TimeoutHTTPAdapter</span><span class="p">(</span><span class="n">HTTPAdapter</span><span class="p">):</span>
</span><span id="L-19"><a href="#L-19"><span class="linenos"> 19</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-20"><a href="#L-20"><span class="linenos"> 20</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">timeout</span> <span class="o">=</span> <span class="n">local_configurations</span><span class="o">.</span><span class="n">REQUEST_TIMEOUT_IN_SEC</span>
</span><span id="L-21"><a href="#L-21"><span class="linenos"> 21</span></a>        <span class="k">if</span> <span class="s2">&quot;timeout&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
</span><span id="L-22"><a href="#L-22"><span class="linenos"> 22</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">timeout</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;timeout&quot;</span><span class="p">]</span>
</span><span id="L-23"><a href="#L-23"><span class="linenos"> 23</span></a>            <span class="k">del</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;timeout&quot;</span><span class="p">]</span>
</span><span id="L-24"><a href="#L-24"><span class="linenos"> 24</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-25"><a href="#L-25"><span class="linenos"> 25</span></a>
</span><span id="L-26"><a href="#L-26"><span class="linenos"> 26</span></a>    <span class="k">def</span> <span class="nf">send</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-27"><a href="#L-27"><span class="linenos"> 27</span></a>        <span class="n">timeout</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;timeout&quot;</span><span class="p">)</span>
</span><span id="L-28"><a href="#L-28"><span class="linenos"> 28</span></a>        <span class="k">if</span> <span class="n">timeout</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-29"><a href="#L-29"><span class="linenos"> 29</span></a>            <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;timeout&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">timeout</span>
</span><span id="L-30"><a href="#L-30"><span class="linenos"> 30</span></a>        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-31"><a href="#L-31"><span class="linenos"> 31</span></a>
</span><span id="L-32"><a href="#L-32"><span class="linenos"> 32</span></a>
</span><span id="L-33"><a href="#L-33"><span class="linenos"> 33</span></a><span class="k">def</span> <span class="nf">initialise_http_client</span><span class="p">():</span>
</span><span id="L-34"><a href="#L-34"><span class="linenos"> 34</span></a>    <span class="n">retries</span> <span class="o">=</span> <span class="n">Retry</span><span class="p">(</span><span class="n">total</span><span class="o">=</span><span class="n">local_configurations</span><span class="o">.</span><span class="n">MAX_RETRIES</span><span class="p">,</span> <span class="n">backoff_factor</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span><span id="L-35"><a href="#L-35"><span class="linenos"> 35</span></a>                    <span class="n">status_forcelist</span><span class="o">=</span><span class="p">[</span><span class="mi">429</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="mi">502</span><span class="p">,</span> <span class="mi">503</span><span class="p">,</span> <span class="mi">504</span><span class="p">])</span>
</span><span id="L-36"><a href="#L-36"><span class="linenos"> 36</span></a>    <span class="n">http</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">Session</span><span class="p">()</span>
</span><span id="L-37"><a href="#L-37"><span class="linenos"> 37</span></a>    <span class="n">adapter</span> <span class="o">=</span> <span class="n">TimeoutHTTPAdapter</span><span class="p">(</span><span class="n">max_retries</span><span class="o">=</span><span class="n">retries</span><span class="p">)</span>
</span><span id="L-38"><a href="#L-38"><span class="linenos"> 38</span></a>    <span class="n">http</span><span class="o">.</span><span class="n">mount</span><span class="p">(</span><span class="s2">&quot;https://&quot;</span><span class="p">,</span> <span class="n">adapter</span><span class="p">)</span>
</span><span id="L-39"><a href="#L-39"><span class="linenos"> 39</span></a>    <span class="n">http</span><span class="o">.</span><span class="n">mount</span><span class="p">(</span><span class="s2">&quot;http://&quot;</span><span class="p">,</span> <span class="n">adapter</span><span class="p">)</span>
</span><span id="L-40"><a href="#L-40"><span class="linenos"> 40</span></a>    <span class="k">return</span> <span class="n">http</span>
</span><span id="L-41"><a href="#L-41"><span class="linenos"> 41</span></a>
</span><span id="L-42"><a href="#L-42"><span class="linenos"> 42</span></a>
</span><span id="L-43"><a href="#L-43"><span class="linenos"> 43</span></a><span class="k">class</span> <span class="nc">BaseClient</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
</span><span id="L-44"><a href="#L-44"><span class="linenos"> 44</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-45"><a href="#L-45"><span class="linenos"> 45</span></a>        <span class="c1"># print(&quot;Inside BaseClient&quot;)</span>
</span><span id="L-46"><a href="#L-46"><span class="linenos"> 46</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">client_config</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="L-47"><a href="#L-47"><span class="linenos"> 47</span></a>            <span class="s1">&#39;protocol&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-48"><a href="#L-48"><span class="linenos"> 48</span></a>            <span class="s1">&#39;ip&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-49"><a href="#L-49"><span class="linenos"> 49</span></a>            <span class="s1">&#39;port&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-50"><a href="#L-50"><span class="linenos"> 50</span></a>            <span class="s1">&#39;refresh_token&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-51"><a href="#L-51"><span class="linenos"> 51</span></a>            <span class="s1">&#39;bearer_token&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-52"><a href="#L-52"><span class="linenos"> 52</span></a>            <span class="s1">&#39;default_environment_id&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-53"><a href="#L-53"><span class="linenos"> 53</span></a>            <span class="s1">&#39;default_storage_id&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-54"><a href="#L-54"><span class="linenos"> 54</span></a>            <span class="s1">&#39;default_compute_id&#39;</span><span class="p">:</span> <span class="kc">None</span>
</span><span id="L-55"><a href="#L-55"><span class="linenos"> 55</span></a>        <span class="p">}</span>
</span><span id="L-56"><a href="#L-56"><span class="linenos"> 56</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">secrets_config</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;custom_secrets_read&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">}</span>
</span><span id="L-57"><a href="#L-57"><span class="linenos"> 57</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mappings</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="L-58"><a href="#L-58"><span class="linenos"> 58</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">http</span> <span class="o">=</span> <span class="n">initialise_http_client</span><span class="p">()</span>
</span><span id="L-59"><a href="#L-59"><span class="linenos"> 59</span></a>        <span class="n">log_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">local_configurations</span><span class="o">.</span><span class="n">LOG_LOCATION</span><span class="p">)</span>
</span><span id="L-60"><a href="#L-60"><span class="linenos"> 60</span></a>        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">log_path</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">absolute</span><span class="p">()):</span>
</span><span id="L-61"><a href="#L-61"><span class="linenos"> 61</span></a>            <span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="n">local_configurations</span><span class="o">.</span><span class="n">LOG_LOCATION</span><span class="p">,</span> <span class="n">filemode</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span>
</span><span id="L-62"><a href="#L-62"><span class="linenos"> 62</span></a>                                <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%(asctime)s</span><span class="s1"> - </span><span class="si">%(module)s</span><span class="s1"> - </span><span class="si">%(pathname)s</span><span class="s1"> - </span><span class="si">%(lineno)d</span><span class="s1"> - </span><span class="si">%(levelname)s</span><span class="s1"> - </span><span class="si">%(message)s</span><span class="s1">&#39;</span><span class="p">,</span>
</span><span id="L-63"><a href="#L-63"><span class="linenos"> 63</span></a>                                <span class="n">level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">DEBUG</span><span class="p">,</span> <span class="n">datefmt</span><span class="o">=</span><span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1"> %H:%M:%S&#39;</span><span class="p">)</span>
</span><span id="L-64"><a href="#L-64"><span class="linenos"> 64</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-65"><a href="#L-65"><span class="linenos"> 65</span></a>            <span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span>
</span><span id="L-66"><a href="#L-66"><span class="linenos"> 66</span></a>                <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%(asctime)s</span><span class="s1"> - </span><span class="si">%(module)s</span><span class="s1"> - </span><span class="si">%(pathname)s</span><span class="s1"> - </span><span class="si">%(lineno)d</span><span class="s1"> - </span><span class="si">%(levelname)s</span><span class="s1"> - </span><span class="si">%(message)s</span><span class="s1">&#39;</span><span class="p">,</span>
</span><span id="L-67"><a href="#L-67"><span class="linenos"> 67</span></a>                <span class="n">level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">DEBUG</span><span class="p">,</span> <span class="n">datefmt</span><span class="o">=</span><span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1"> %H:%M:%S&#39;</span><span class="p">)</span>
</span><span id="L-68"><a href="#L-68"><span class="linenos"> 68</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s1">&#39;infoworks_sdk_logs&#39;</span><span class="p">)</span>
</span><span id="L-69"><a href="#L-69"><span class="linenos"> 69</span></a>
</span><span id="L-70"><a href="#L-70"><span class="linenos"> 70</span></a>    <span class="k">def</span> <span class="nf">initialize_client</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">protocol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ip</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="p">):</span>
</span><span id="L-71"><a href="#L-71"><span class="linenos"> 71</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-72"><a href="#L-72"><span class="linenos"> 72</span></a><span class="sd">        initialize the client</span>
</span><span id="L-73"><a href="#L-73"><span class="linenos"> 73</span></a><span class="sd">        :param protocol: protocol to be used for server call</span>
</span><span id="L-74"><a href="#L-74"><span class="linenos"> 74</span></a><span class="sd">        :type protocol: String</span>
</span><span id="L-75"><a href="#L-75"><span class="linenos"> 75</span></a><span class="sd">        :param ip: Client IP</span>
</span><span id="L-76"><a href="#L-76"><span class="linenos"> 76</span></a><span class="sd">        :type ip: String</span>
</span><span id="L-77"><a href="#L-77"><span class="linenos"> 77</span></a><span class="sd">        :param port: Client Port</span>
</span><span id="L-78"><a href="#L-78"><span class="linenos"> 78</span></a><span class="sd">        :type port: String</span>
</span><span id="L-79"><a href="#L-79"><span class="linenos"> 79</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-80"><a href="#L-80"><span class="linenos"> 80</span></a>
</span><span id="L-81"><a href="#L-81"><span class="linenos"> 81</span></a>        <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="n">v</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="p">[</span><span class="n">protocol</span><span class="p">,</span> <span class="n">ip</span><span class="p">,</span> <span class="n">port</span><span class="p">]):</span>
</span><span id="L-82"><a href="#L-82"><span class="linenos"> 82</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">client_config</span><span class="p">[</span><span class="s1">&#39;protocol&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">protocol</span>
</span><span id="L-83"><a href="#L-83"><span class="linenos"> 83</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">client_config</span><span class="p">[</span><span class="s1">&#39;ip&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ip</span>
</span><span id="L-84"><a href="#L-84"><span class="linenos"> 84</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">client_config</span><span class="p">[</span><span class="s1">&#39;port&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">port</span>
</span><span id="L-85"><a href="#L-85"><span class="linenos"> 85</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-86"><a href="#L-86"><span class="linenos"> 86</span></a>            <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Pass valid values&quot;</span><span class="p">))</span>
</span><span id="L-87"><a href="#L-87"><span class="linenos"> 87</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Pass valid values&quot;</span><span class="p">)</span>
</span><span id="L-88"><a href="#L-88"><span class="linenos"> 88</span></a>
</span><span id="L-89"><a href="#L-89"><span class="linenos"> 89</span></a>    <span class="k">def</span> <span class="nf">initialize_client_with_defaults</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">protocol</span><span class="p">,</span> <span class="n">ip</span><span class="p">,</span> <span class="n">port</span><span class="p">,</span> <span class="n">refresh_token</span><span class="p">,</span> <span class="n">default_environment_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="L-90"><a href="#L-90"><span class="linenos"> 90</span></a>                                        <span class="n">default_storage_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">default_compute_id</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="L-91"><a href="#L-91"><span class="linenos"> 91</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-92"><a href="#L-92"><span class="linenos"> 92</span></a><span class="sd">        initializes the client and a user with given configuration</span>
</span><span id="L-93"><a href="#L-93"><span class="linenos"> 93</span></a><span class="sd">        :param protocol: protocol to be used for server call</span>
</span><span id="L-94"><a href="#L-94"><span class="linenos"> 94</span></a><span class="sd">        :type protocol: String</span>
</span><span id="L-95"><a href="#L-95"><span class="linenos"> 95</span></a><span class="sd">        :param ip: ip address of the server</span>
</span><span id="L-96"><a href="#L-96"><span class="linenos"> 96</span></a><span class="sd">        :type ip: String</span>
</span><span id="L-97"><a href="#L-97"><span class="linenos"> 97</span></a><span class="sd">        :param port: port on which the rest service resides</span>
</span><span id="L-98"><a href="#L-98"><span class="linenos"> 98</span></a><span class="sd">        :type port: String</span>
</span><span id="L-99"><a href="#L-99"><span class="linenos"> 99</span></a><span class="sd">        :param refresh_token: refresh_token of the user</span>
</span><span id="L-100"><a href="#L-100"><span class="linenos">100</span></a><span class="sd">        :type refresh_token: String</span>
</span><span id="L-101"><a href="#L-101"><span class="linenos">101</span></a><span class="sd">        :param default_compute_id: Pass the default compute id to be used for all the artifacts to be created</span>
</span><span id="L-102"><a href="#L-102"><span class="linenos">102</span></a><span class="sd">        :param default_storage_id: Pass the default storage id to be used for all the artifacts to be created</span>
</span><span id="L-103"><a href="#L-103"><span class="linenos">103</span></a><span class="sd">        :param default_environment_id: Pass the default environment id to be used for all the artifacts to be created</span>
</span><span id="L-104"><a href="#L-104"><span class="linenos">104</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-105"><a href="#L-105"><span class="linenos">105</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">client_config</span><span class="p">[</span><span class="s1">&#39;refresh_token&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">refresh_token</span>
</span><span id="L-106"><a href="#L-106"><span class="linenos">106</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">client_config</span><span class="p">[</span><span class="s1">&#39;bearer_token&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_bearer_token</span><span class="p">(</span><span class="n">protocol</span><span class="p">,</span> <span class="n">ip</span><span class="p">,</span> <span class="n">port</span><span class="p">,</span> <span class="n">refresh_token</span><span class="p">)</span>
</span><span id="L-107"><a href="#L-107"><span class="linenos">107</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">initialize_client</span><span class="p">(</span><span class="n">protocol</span><span class="p">,</span> <span class="n">ip</span><span class="p">,</span> <span class="n">port</span><span class="p">)</span>
</span><span id="L-108"><a href="#L-108"><span class="linenos">108</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">client_config</span><span class="p">[</span>
</span><span id="L-109"><a href="#L-109"><span class="linenos">109</span></a>            <span class="s1">&#39;default_environment_id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">default_environment_id</span> <span class="k">if</span> <span class="n">default_environment_id</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span>
</span><span id="L-110"><a href="#L-110"><span class="linenos">110</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">client_config</span><span class="p">[</span><span class="s1">&#39;default_storage_id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">default_storage_id</span> <span class="k">if</span> <span class="n">default_storage_id</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span>
</span><span id="L-111"><a href="#L-111"><span class="linenos">111</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">client_config</span><span class="p">[</span><span class="s1">&#39;default_compute_id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">default_compute_id</span> <span class="k">if</span> <span class="n">default_compute_id</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span>
</span><span id="L-112"><a href="#L-112"><span class="linenos">112</span></a>
</span><span id="L-113"><a href="#L-113"><span class="linenos">113</span></a>    <span class="k">def</span> <span class="nf">get_configurations</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-114"><a href="#L-114"><span class="linenos">114</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-115"><a href="#L-115"><span class="linenos">115</span></a><span class="sd">        returns client configurations</span>
</span><span id="L-116"><a href="#L-116"><span class="linenos">116</span></a><span class="sd">        :return: configuration dictionary</span>
</span><span id="L-117"><a href="#L-117"><span class="linenos">117</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-118"><a href="#L-118"><span class="linenos">118</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">client_config</span>
</span><span id="L-119"><a href="#L-119"><span class="linenos">119</span></a>
</span><span id="L-120"><a href="#L-120"><span class="linenos">120</span></a>    <span class="k">def</span> <span class="nf">regenerate_bearer_token_if_needed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">headers</span><span class="p">):</span>
</span><span id="L-121"><a href="#L-121"><span class="linenos">121</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">is_token_valid</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">client_config</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">http</span><span class="p">):</span>
</span><span id="L-122"><a href="#L-122"><span class="linenos">122</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">client_config</span><span class="p">[</span><span class="s1">&#39;bearer_token&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_bearer_token</span><span class="p">(</span><span class="n">protocol</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">client_config</span><span class="p">[</span><span class="s2">&quot;protocol&quot;</span><span class="p">],</span>
</span><span id="L-123"><a href="#L-123"><span class="linenos">123</span></a>                                                                  <span class="n">ip</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">client_config</span><span class="p">[</span><span class="s2">&quot;ip&quot;</span><span class="p">],</span>
</span><span id="L-124"><a href="#L-124"><span class="linenos">124</span></a>                                                                  <span class="n">port</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">client_config</span><span class="p">[</span><span class="s2">&quot;port&quot;</span><span class="p">],</span>
</span><span id="L-125"><a href="#L-125"><span class="linenos">125</span></a>                                                                  <span class="n">refresh_token</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">client_config</span><span class="p">[</span><span class="s2">&quot;refresh_token&quot;</span><span class="p">])</span>
</span><span id="L-126"><a href="#L-126"><span class="linenos">126</span></a>            <span class="n">headers</span> <span class="o">=</span> <span class="n">IWUtils</span><span class="o">.</span><span class="n">get_default_header_for_v3</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">client_config</span><span class="p">[</span><span class="s1">&#39;bearer_token&#39;</span><span class="p">])</span>
</span><span id="L-127"><a href="#L-127"><span class="linenos">127</span></a>        <span class="k">return</span> <span class="n">headers</span>
</span><span id="L-128"><a href="#L-128"><span class="linenos">128</span></a>
</span><span id="L-129"><a href="#L-129"><span class="linenos">129</span></a>    <span class="k">def</span> <span class="nf">call_api</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="L-130"><a href="#L-130"><span class="linenos">130</span></a>        <span class="c1"># headers = self.regenerate_bearer_token_if_needed(headers)</span>
</span><span id="L-131"><a href="#L-131"><span class="linenos">131</span></a>        <span class="k">if</span> <span class="n">method</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;GET&quot;</span><span class="p">:</span>
</span><span id="L-132"><a href="#L-132"><span class="linenos">132</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Calling </span><span class="si">{</span><span class="n">url</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-133"><a href="#L-133"><span class="linenos">133</span></a>            <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">http</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="n">local_configurations</span><span class="o">.</span><span class="n">REQUEST_TIMEOUT_IN_SEC</span><span class="p">,</span>
</span><span id="L-134"><a href="#L-134"><span class="linenos">134</span></a>                                     <span class="n">verify</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
</span><span id="L-135"><a href="#L-135"><span class="linenos">135</span></a>            <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">406</span><span class="p">:</span>
</span><span id="L-136"><a href="#L-136"><span class="linenos">136</span></a>                <span class="n">headers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">regenerate_bearer_token_if_needed</span><span class="p">(</span><span class="n">headers</span><span class="p">)</span>
</span><span id="L-137"><a href="#L-137"><span class="linenos">137</span></a>                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">http</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="n">local_configurations</span><span class="o">.</span><span class="n">REQUEST_TIMEOUT_IN_SEC</span><span class="p">,</span>
</span><span id="L-138"><a href="#L-138"><span class="linenos">138</span></a>                                     <span class="n">verify</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
</span><span id="L-139"><a href="#L-139"><span class="linenos">139</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-140"><a href="#L-140"><span class="linenos">140</span></a>                <span class="k">return</span> <span class="n">response</span>
</span><span id="L-141"><a href="#L-141"><span class="linenos">141</span></a>        <span class="k">elif</span> <span class="n">method</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;POST&quot;</span><span class="p">:</span>
</span><span id="L-142"><a href="#L-142"><span class="linenos">142</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Calling </span><span class="si">{</span><span class="n">url</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-143"><a href="#L-143"><span class="linenos">143</span></a>            <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">http</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
</span><span id="L-144"><a href="#L-144"><span class="linenos">144</span></a>                                      <span class="n">timeout</span><span class="o">=</span><span class="n">local_configurations</span><span class="o">.</span><span class="n">REQUEST_TIMEOUT_IN_SEC</span><span class="p">,</span> <span class="n">verify</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="L-145"><a href="#L-145"><span class="linenos">145</span></a>            <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">406</span><span class="p">:</span>
</span><span id="L-146"><a href="#L-146"><span class="linenos">146</span></a>                <span class="n">headers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">regenerate_bearer_token_if_needed</span><span class="p">(</span><span class="n">headers</span><span class="p">)</span>
</span><span id="L-147"><a href="#L-147"><span class="linenos">147</span></a>                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">http</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
</span><span id="L-148"><a href="#L-148"><span class="linenos">148</span></a>                                      <span class="n">timeout</span><span class="o">=</span><span class="n">local_configurations</span><span class="o">.</span><span class="n">REQUEST_TIMEOUT_IN_SEC</span><span class="p">,</span> <span class="n">verify</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="L-149"><a href="#L-149"><span class="linenos">149</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-150"><a href="#L-150"><span class="linenos">150</span></a>                <span class="k">return</span> <span class="n">response</span>
</span><span id="L-151"><a href="#L-151"><span class="linenos">151</span></a>        <span class="k">elif</span> <span class="n">method</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;PUT&quot;</span><span class="p">:</span>
</span><span id="L-152"><a href="#L-152"><span class="linenos">152</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Calling </span><span class="si">{</span><span class="n">url</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-153"><a href="#L-153"><span class="linenos">153</span></a>            <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">http</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
</span><span id="L-154"><a href="#L-154"><span class="linenos">154</span></a>                                     <span class="n">timeout</span><span class="o">=</span><span class="n">local_configurations</span><span class="o">.</span><span class="n">REQUEST_TIMEOUT_IN_SEC</span><span class="p">,</span> <span class="n">verify</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="L-155"><a href="#L-155"><span class="linenos">155</span></a>            <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">406</span><span class="p">:</span>
</span><span id="L-156"><a href="#L-156"><span class="linenos">156</span></a>                <span class="n">headers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">regenerate_bearer_token_if_needed</span><span class="p">(</span><span class="n">headers</span><span class="p">)</span>
</span><span id="L-157"><a href="#L-157"><span class="linenos">157</span></a>                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">http</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
</span><span id="L-158"><a href="#L-158"><span class="linenos">158</span></a>                                     <span class="n">timeout</span><span class="o">=</span><span class="n">local_configurations</span><span class="o">.</span><span class="n">REQUEST_TIMEOUT_IN_SEC</span><span class="p">,</span> <span class="n">verify</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="L-159"><a href="#L-159"><span class="linenos">159</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-160"><a href="#L-160"><span class="linenos">160</span></a>                <span class="k">return</span> <span class="n">response</span>
</span><span id="L-161"><a href="#L-161"><span class="linenos">161</span></a>        <span class="k">elif</span> <span class="n">method</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;PATCH&quot;</span><span class="p">:</span>
</span><span id="L-162"><a href="#L-162"><span class="linenos">162</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Calling </span><span class="si">{</span><span class="n">url</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-163"><a href="#L-163"><span class="linenos">163</span></a>            <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">http</span><span class="o">.</span><span class="n">patch</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
</span><span id="L-164"><a href="#L-164"><span class="linenos">164</span></a>                                       <span class="n">timeout</span><span class="o">=</span><span class="n">local_configurations</span><span class="o">.</span><span class="n">REQUEST_TIMEOUT_IN_SEC</span><span class="p">,</span> <span class="n">verify</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="L-165"><a href="#L-165"><span class="linenos">165</span></a>            <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">406</span><span class="p">:</span>
</span><span id="L-166"><a href="#L-166"><span class="linenos">166</span></a>                <span class="n">headers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">regenerate_bearer_token_if_needed</span><span class="p">(</span><span class="n">headers</span><span class="p">)</span>
</span><span id="L-167"><a href="#L-167"><span class="linenos">167</span></a>                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">http</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
</span><span id="L-168"><a href="#L-168"><span class="linenos">168</span></a>                                     <span class="n">timeout</span><span class="o">=</span><span class="n">local_configurations</span><span class="o">.</span><span class="n">REQUEST_TIMEOUT_IN_SEC</span><span class="p">,</span> <span class="n">verify</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="L-169"><a href="#L-169"><span class="linenos">169</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-170"><a href="#L-170"><span class="linenos">170</span></a>                <span class="k">return</span> <span class="n">response</span>
</span><span id="L-171"><a href="#L-171"><span class="linenos">171</span></a>        <span class="k">elif</span> <span class="n">method</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;DELETE&quot;</span><span class="p">:</span>
</span><span id="L-172"><a href="#L-172"><span class="linenos">172</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Calling </span><span class="si">{</span><span class="n">url</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-173"><a href="#L-173"><span class="linenos">173</span></a>            <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">http</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="n">local_configurations</span><span class="o">.</span><span class="n">REQUEST_TIMEOUT_IN_SEC</span><span class="p">,</span>
</span><span id="L-174"><a href="#L-174"><span class="linenos">174</span></a>                                        <span class="n">verify</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="L-175"><a href="#L-175"><span class="linenos">175</span></a>            <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">406</span><span class="p">:</span>
</span><span id="L-176"><a href="#L-176"><span class="linenos">176</span></a>                <span class="n">headers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">regenerate_bearer_token_if_needed</span><span class="p">(</span><span class="n">headers</span><span class="p">)</span>
</span><span id="L-177"><a href="#L-177"><span class="linenos">177</span></a>                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">http</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="n">local_configurations</span><span class="o">.</span><span class="n">REQUEST_TIMEOUT_IN_SEC</span><span class="p">,</span>
</span><span id="L-178"><a href="#L-178"><span class="linenos">178</span></a>                                        <span class="n">verify</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="L-179"><a href="#L-179"><span class="linenos">179</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-180"><a href="#L-180"><span class="linenos">180</span></a>                <span class="k">return</span> <span class="n">response</span>
</span><span id="L-181"><a href="#L-181"><span class="linenos">181</span></a>
</span><span id="L-182"><a href="#L-182"><span class="linenos">182</span></a>    <span class="k">def</span> <span class="nf">get_mappings_from_config_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ini_config_file_path</span><span class="p">):</span>
</span><span id="L-183"><a href="#L-183"><span class="linenos">183</span></a>        <span class="n">config</span> <span class="o">=</span> <span class="n">ConfigParser</span><span class="p">()</span>
</span><span id="L-184"><a href="#L-184"><span class="linenos">184</span></a>        <span class="n">config</span><span class="o">.</span><span class="n">optionxform</span> <span class="o">=</span> <span class="nb">str</span>
</span><span id="L-185"><a href="#L-185"><span class="linenos">185</span></a>        <span class="n">config</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">ini_config_file_path</span><span class="p">)</span>
</span><span id="L-186"><a href="#L-186"><span class="linenos">186</span></a>        <span class="k">if</span> <span class="s2">&quot;environment&quot;</span> <span class="ow">in</span> <span class="n">config</span><span class="p">:</span>
</span><span id="L-187"><a href="#L-187"><span class="linenos">187</span></a>            <span class="n">default_environment_id</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;environment&quot;</span><span class="p">,</span> <span class="s2">&quot;environment_id&quot;</span><span class="p">)</span>
</span><span id="L-188"><a href="#L-188"><span class="linenos">188</span></a>            <span class="n">default_storage_id</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;environment&quot;</span><span class="p">,</span> <span class="s2">&quot;storage_id&quot;</span><span class="p">)</span>
</span><span id="L-189"><a href="#L-189"><span class="linenos">189</span></a>            <span class="n">default_interactive_id</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;environment&quot;</span><span class="p">,</span> <span class="s2">&quot;interactive_id&quot;</span><span class="p">)</span>
</span><span id="L-190"><a href="#L-190"><span class="linenos">190</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">client_config</span><span class="p">[</span><span class="s2">&quot;default_environment_id&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">default_environment_id</span>
</span><span id="L-191"><a href="#L-191"><span class="linenos">191</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">client_config</span><span class="p">[</span><span class="s2">&quot;default_storage_id&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">default_storage_id</span>
</span><span id="L-192"><a href="#L-192"><span class="linenos">192</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">client_config</span><span class="p">[</span><span class="s2">&quot;default_compute_id&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">default_interactive_id</span>
</span><span id="L-193"><a href="#L-193"><span class="linenos">193</span></a>        <span class="k">if</span> <span class="s2">&quot;environment_mappings&quot;</span> <span class="ow">in</span> <span class="n">config</span><span class="p">:</span>
</span><span id="L-194"><a href="#L-194"><span class="linenos">194</span></a>            <span class="n">environment_mappings</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">items</span><span class="p">(</span><span class="s2">&quot;environment_mappings&quot;</span><span class="p">))</span>
</span><span id="L-195"><a href="#L-195"><span class="linenos">195</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">mappings</span><span class="p">[</span><span class="s2">&quot;environment_mappings&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">environment_mappings</span>
</span><span id="L-196"><a href="#L-196"><span class="linenos">196</span></a>        <span class="k">if</span> <span class="s2">&quot;storage_mappings&quot;</span> <span class="ow">in</span> <span class="n">config</span><span class="p">:</span>
</span><span id="L-197"><a href="#L-197"><span class="linenos">197</span></a>            <span class="n">storage_mappings</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">items</span><span class="p">(</span><span class="s2">&quot;storage_mappings&quot;</span><span class="p">))</span>
</span><span id="L-198"><a href="#L-198"><span class="linenos">198</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">mappings</span><span class="p">[</span><span class="s2">&quot;storage_mappings&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">storage_mappings</span>
</span><span id="L-199"><a href="#L-199"><span class="linenos">199</span></a>        <span class="k">if</span> <span class="s2">&quot;compute_mappings&quot;</span> <span class="ow">in</span> <span class="n">config</span><span class="p">:</span>
</span><span id="L-200"><a href="#L-200"><span class="linenos">200</span></a>            <span class="n">compute_mappings</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">items</span><span class="p">(</span><span class="s2">&quot;compute_mappings&quot;</span><span class="p">))</span>
</span><span id="L-201"><a href="#L-201"><span class="linenos">201</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">mappings</span><span class="p">[</span><span class="s2">&quot;compute_mappings&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">compute_mappings</span>
</span><span id="L-202"><a href="#L-202"><span class="linenos">202</span></a>        <span class="k">if</span> <span class="s2">&quot;gcp_details&quot;</span> <span class="ow">in</span> <span class="n">config</span><span class="p">:</span>
</span><span id="L-203"><a href="#L-203"><span class="linenos">203</span></a>            <span class="n">gcp_details</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">items</span><span class="p">(</span><span class="s2">&quot;gcp_details&quot;</span><span class="p">))</span>
</span><span id="L-204"><a href="#L-204"><span class="linenos">204</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">mappings</span><span class="p">[</span><span class="s2">&quot;gcp_details&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">gcp_details</span>
</span><span id="L-205"><a href="#L-205"><span class="linenos">205</span></a>        <span class="k">if</span> <span class="s2">&quot;gcp_project_id_mappings&quot;</span> <span class="ow">in</span> <span class="n">config</span><span class="p">:</span>
</span><span id="L-206"><a href="#L-206"><span class="linenos">206</span></a>            <span class="n">gcp_project_id_mappings</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">items</span><span class="p">(</span><span class="s2">&quot;gcp_project_id_mappings&quot;</span><span class="p">))</span>
</span><span id="L-207"><a href="#L-207"><span class="linenos">207</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">mappings</span><span class="p">[</span><span class="s2">&quot;gcp_project_id_mappings&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">gcp_project_id_mappings</span>
</span><span id="L-208"><a href="#L-208"><span class="linenos">208</span></a>        <span class="k">if</span> <span class="s2">&quot;service_json_mappings&quot;</span> <span class="ow">in</span> <span class="n">config</span><span class="p">:</span>
</span><span id="L-209"><a href="#L-209"><span class="linenos">209</span></a>            <span class="n">service_json_mappings</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">items</span><span class="p">(</span><span class="s2">&quot;service_json_mappings&quot;</span><span class="p">))</span>
</span><span id="L-210"><a href="#L-210"><span class="linenos">210</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">mappings</span><span class="p">[</span><span class="s2">&quot;service_json_mappings&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">service_json_mappings</span>
</span><span id="L-211"><a href="#L-211"><span class="linenos">211</span></a>        <span class="k">if</span> <span class="s2">&quot;table_group_compute_mappings&quot;</span> <span class="ow">in</span> <span class="n">config</span><span class="p">:</span>
</span><span id="L-212"><a href="#L-212"><span class="linenos">212</span></a>            <span class="n">table_group_compute_mappings</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">items</span><span class="p">(</span><span class="s2">&quot;table_group_compute_mappings&quot;</span><span class="p">))</span>
</span><span id="L-213"><a href="#L-213"><span class="linenos">213</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">mappings</span><span class="p">[</span><span class="s2">&quot;table_group_compute_mappings&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">table_group_compute_mappings</span>
</span><span id="L-214"><a href="#L-214"><span class="linenos">214</span></a>        <span class="k">if</span> <span class="s2">&quot;kms&quot;</span> <span class="ow">in</span> <span class="n">config</span><span class="p">:</span>
</span><span id="L-215"><a href="#L-215"><span class="linenos">215</span></a>            <span class="n">kms</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">items</span><span class="p">(</span><span class="s2">&quot;kms&quot;</span><span class="p">))</span>
</span><span id="L-216"><a href="#L-216"><span class="linenos">216</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">mappings</span><span class="p">[</span><span class="s2">&quot;kms&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kms</span>
</span><span id="L-217"><a href="#L-217"><span class="linenos">217</span></a>
</span><span id="L-218"><a href="#L-218"><span class="linenos">218</span></a>    <span class="k">def</span> <span class="nf">_topological_sort_grouping</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">g</span><span class="p">):</span>
</span><span id="L-219"><a href="#L-219"><span class="linenos">219</span></a>        <span class="c1"># copy the graph</span>
</span><span id="L-220"><a href="#L-220"><span class="linenos">220</span></a>        <span class="n">_g</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="L-221"><a href="#L-221"><span class="linenos">221</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-222"><a href="#L-222"><span class="linenos">222</span></a>        <span class="c1"># while _g is not empty</span>
</span><span id="L-223"><a href="#L-223"><span class="linenos">223</span></a>        <span class="k">while</span> <span class="n">_g</span><span class="p">:</span>
</span><span id="L-224"><a href="#L-224"><span class="linenos">224</span></a>            <span class="n">zero_indegree</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span> <span class="k">for</span> <span class="n">v</span><span class="p">,</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">_g</span><span class="o">.</span><span class="n">in_degree</span><span class="p">()</span> <span class="k">if</span> <span class="n">d</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span>
</span><span id="L-225"><a href="#L-225"><span class="linenos">225</span></a>            <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">zero_indegree</span><span class="p">)</span>
</span><span id="L-226"><a href="#L-226"><span class="linenos">226</span></a>            <span class="n">_g</span><span class="o">.</span><span class="n">remove_nodes_from</span><span class="p">(</span><span class="n">zero_indegree</span><span class="p">)</span>
</span><span id="L-227"><a href="#L-227"><span class="linenos">227</span></a>        <span class="k">return</span> <span class="n">res</span>
</span><span id="L-228"><a href="#L-228"><span class="linenos">228</span></a>
</span><span id="L-229"><a href="#L-229"><span class="linenos">229</span></a>    <span class="k">def</span> <span class="nf">get_all_secrets</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">secret_type</span><span class="p">,</span> <span class="n">ini_config_file_path</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">keys</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="L-230"><a href="#L-230"><span class="linenos">230</span></a>        <span class="c1"># Read all secrets from file and load inmemory</span>
</span><span id="L-231"><a href="#L-231"><span class="linenos">231</span></a>        <span class="c1"># Encrypt using infoworks encoding</span>
</span><span id="L-232"><a href="#L-232"><span class="linenos">232</span></a>        <span class="k">if</span> <span class="n">secret_type</span> <span class="o">==</span> <span class="s2">&quot;gcp_kms&quot;</span> <span class="ow">and</span> <span class="n">ini_config_file_path</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-233"><a href="#L-233"><span class="linenos">233</span></a>            <span class="n">config</span> <span class="o">=</span> <span class="n">ConfigParser</span><span class="p">()</span>
</span><span id="L-234"><a href="#L-234"><span class="linenos">234</span></a>            <span class="n">config</span><span class="o">.</span><span class="n">optionxform</span> <span class="o">=</span> <span class="nb">str</span>
</span><span id="L-235"><a href="#L-235"><span class="linenos">235</span></a>            <span class="n">config</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">ini_config_file_path</span><span class="p">)</span>
</span><span id="L-236"><a href="#L-236"><span class="linenos">236</span></a>            <span class="c1"># Cloud KMS CryptoKey Encrypter</span>
</span><span id="L-237"><a href="#L-237"><span class="linenos">237</span></a>            <span class="n">service_json_path</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;gcp_kms&quot;</span><span class="p">,</span> <span class="s2">&quot;service_json_path&quot;</span><span class="p">)</span>
</span><span id="L-238"><a href="#L-238"><span class="linenos">238</span></a>            <span class="c1"># Reading Config Parameters</span>
</span><span id="L-239"><a href="#L-239"><span class="linenos">239</span></a>            <span class="n">projectId</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;gcp_kms&quot;</span><span class="p">,</span> <span class="s2">&quot;projectId&quot;</span><span class="p">)</span>
</span><span id="L-240"><a href="#L-240"><span class="linenos">240</span></a>            <span class="n">locationId</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;gcp_kms&quot;</span><span class="p">,</span> <span class="s2">&quot;locationId&quot;</span><span class="p">)</span>
</span><span id="L-241"><a href="#L-241"><span class="linenos">241</span></a>            <span class="n">keyRingId</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;gcp_kms&quot;</span><span class="p">,</span> <span class="s2">&quot;keyRingId&quot;</span><span class="p">)</span>
</span><span id="L-242"><a href="#L-242"><span class="linenos">242</span></a>            <span class="n">keyId</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;gcp_kms&quot;</span><span class="p">,</span> <span class="s2">&quot;keyId&quot;</span><span class="p">)</span>
</span><span id="L-243"><a href="#L-243"><span class="linenos">243</span></a>            <span class="n">bucketName</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;gcp_kms&quot;</span><span class="p">,</span> <span class="s2">&quot;bucketName&quot;</span><span class="p">)</span>
</span><span id="L-244"><a href="#L-244"><span class="linenos">244</span></a>            <span class="n">blobName</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;gcp_kms&quot;</span><span class="p">,</span> <span class="s2">&quot;encrypted_key_filename&quot;</span><span class="p">)</span>
</span><span id="L-245"><a href="#L-245"><span class="linenos">245</span></a>            <span class="c1"># Reading Encrypted Password File from Cloud Storage</span>
</span><span id="L-246"><a href="#L-246"><span class="linenos">246</span></a>            <span class="n">storageClient</span> <span class="o">=</span> <span class="n">storage</span><span class="o">.</span><span class="n">Client</span><span class="o">.</span><span class="n">from_service_account_json</span><span class="p">(</span><span class="n">service_json_path</span><span class="p">)</span>
</span><span id="L-247"><a href="#L-247"><span class="linenos">247</span></a>            <span class="n">bucket</span> <span class="o">=</span> <span class="n">storageClient</span><span class="o">.</span><span class="n">get_bucket</span><span class="p">(</span><span class="n">bucketName</span><span class="p">)</span>
</span><span id="L-248"><a href="#L-248"><span class="linenos">248</span></a>            <span class="n">blobFile</span> <span class="o">=</span> <span class="n">bucket</span><span class="o">.</span><span class="n">get_blob</span><span class="p">(</span><span class="n">blobName</span><span class="p">)</span>
</span><span id="L-249"><a href="#L-249"><span class="linenos">249</span></a>            <span class="n">cipherText</span> <span class="o">=</span> <span class="n">blobFile</span><span class="o">.</span><span class="n">download_as_string</span><span class="p">()</span>
</span><span id="L-250"><a href="#L-250"><span class="linenos">250</span></a>            <span class="n">kmsClient</span> <span class="o">=</span> <span class="n">kms</span><span class="o">.</span><span class="n">KeyManagementServiceClient</span><span class="o">.</span><span class="n">from_service_account_json</span><span class="p">(</span><span class="n">service_json_path</span><span class="p">)</span>
</span><span id="L-251"><a href="#L-251"><span class="linenos">251</span></a>            <span class="n">keyName</span> <span class="o">=</span> <span class="n">kmsClient</span><span class="o">.</span><span class="n">crypto_key_path</span><span class="p">(</span><span class="n">projectId</span><span class="p">,</span> <span class="n">locationId</span><span class="p">,</span> <span class="n">keyRingId</span><span class="p">,</span> <span class="n">keyId</span><span class="p">)</span>
</span><span id="L-252"><a href="#L-252"><span class="linenos">252</span></a>            <span class="c1"># Decrypt Password</span>
</span><span id="L-253"><a href="#L-253"><span class="linenos">253</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="L-254"><a href="#L-254"><span class="linenos">254</span></a>                <span class="n">decryptPassword</span> <span class="o">=</span> <span class="n">kmsClient</span><span class="o">.</span><span class="n">decrypt</span><span class="p">(</span><span class="n">request</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="n">keyName</span><span class="p">,</span> <span class="s1">&#39;ciphertext&#39;</span><span class="p">:</span> <span class="n">cipherText</span><span class="p">})</span>
</span><span id="L-255"><a href="#L-255"><span class="linenos">255</span></a>                <span class="n">plainText</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">decryptPassword</span><span class="o">.</span><span class="n">plaintext</span><span class="p">,</span> <span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>
</span><span id="L-256"><a href="#L-256"><span class="linenos">256</span></a>                <span class="n">plainTextStr</span> <span class="o">=</span> <span class="n">plainText</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span><span id="L-257"><a href="#L-257"><span class="linenos">257</span></a>                <span class="n">passwordsDictPlain</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">plainTextStr</span><span class="p">)</span>
</span><span id="L-258"><a href="#L-258"><span class="linenos">258</span></a>                <span class="n">passwordsDictEncrypted</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="L-259"><a href="#L-259"><span class="linenos">259</span></a>                <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">passwordsDictPlain</span><span class="p">:</span>
</span><span id="L-260"><a href="#L-260"><span class="linenos">260</span></a>                    <span class="n">passwordsDictEncrypted</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">aes_encrypt</span><span class="p">(</span><span class="n">passwordsDictPlain</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
</span><span id="L-261"><a href="#L-261"><span class="linenos">261</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">secrets_config</span> <span class="o">=</span> <span class="n">passwordsDictEncrypted</span>
</span><span id="L-262"><a href="#L-262"><span class="linenos">262</span></a>            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="L-263"><a href="#L-263"><span class="linenos">263</span></a>                <span class="nb">print</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
</span><span id="L-264"><a href="#L-264"><span class="linenos">264</span></a>                <span class="k">return</span> <span class="s2">&quot;&quot;</span>
</span><span id="L-265"><a href="#L-265"><span class="linenos">265</span></a>        <span class="k">elif</span> <span class="n">secret_type</span> <span class="o">==</span> <span class="s2">&quot;aws_kms&quot;</span> <span class="ow">and</span> <span class="n">ini_config_file_path</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-266"><a href="#L-266"><span class="linenos">266</span></a>            <span class="n">config</span> <span class="o">=</span> <span class="n">ConfigParser</span><span class="p">()</span>
</span><span id="L-267"><a href="#L-267"><span class="linenos">267</span></a>            <span class="n">config</span><span class="o">.</span><span class="n">optionxform</span> <span class="o">=</span> <span class="nb">str</span>
</span><span id="L-268"><a href="#L-268"><span class="linenos">268</span></a>            <span class="n">config</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">ini_config_file_path</span><span class="p">)</span>
</span><span id="L-269"><a href="#L-269"><span class="linenos">269</span></a>            <span class="c1"># Read the encrypted file into memory</span>
</span><span id="L-270"><a href="#L-270"><span class="linenos">270</span></a>            <span class="n">encrypted_filename</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;aws_kms&quot;</span><span class="p">,</span> <span class="s2">&quot;encrypted_filename&quot;</span><span class="p">)</span>
</span><span id="L-271"><a href="#L-271"><span class="linenos">271</span></a>            <span class="n">available_keys</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">items</span><span class="p">(</span><span class="s2">&quot;aws_kms&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
</span><span id="L-272"><a href="#L-272"><span class="linenos">272</span></a>            <span class="k">if</span> <span class="s2">&quot;access_id&quot;</span> <span class="ow">in</span> <span class="n">available_keys</span> <span class="ow">and</span> <span class="s2">&quot;secret_key&quot;</span> <span class="ow">in</span> <span class="n">available_keys</span><span class="p">:</span>
</span><span id="L-273"><a href="#L-273"><span class="linenos">273</span></a>                <span class="n">ACCESS_KEY</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;aws_kms&quot;</span><span class="p">,</span> <span class="s2">&quot;access_id&quot;</span><span class="p">)</span>
</span><span id="L-274"><a href="#L-274"><span class="linenos">274</span></a>                <span class="n">SECRET_KEY</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;aws_kms&quot;</span><span class="p">,</span> <span class="s2">&quot;secret_key&quot;</span><span class="p">)</span>
</span><span id="L-275"><a href="#L-275"><span class="linenos">275</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-276"><a href="#L-276"><span class="linenos">276</span></a>                <span class="n">ACCESS_KEY</span><span class="p">,</span> <span class="n">SECRET_KEY</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>
</span><span id="L-277"><a href="#L-277"><span class="linenos">277</span></a>            <span class="c1"># Read</span>
</span><span id="L-278"><a href="#L-278"><span class="linenos">278</span></a>            <span class="n">NUM_BYTES_FOR_LEN</span> <span class="o">=</span> <span class="mi">4</span>
</span><span id="L-279"><a href="#L-279"><span class="linenos">279</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="L-280"><a href="#L-280"><span class="linenos">280</span></a>                <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">encrypted_filename</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
</span><span id="L-281"><a href="#L-281"><span class="linenos">281</span></a>                    <span class="n">file_contents</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span><span id="L-282"><a href="#L-282"><span class="linenos">282</span></a>            <span class="k">except</span> <span class="ne">IOError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="L-283"><a href="#L-283"><span class="linenos">283</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
</span><span id="L-284"><a href="#L-284"><span class="linenos">284</span></a>                <span class="k">return</span> <span class="kc">False</span>
</span><span id="L-285"><a href="#L-285"><span class="linenos">285</span></a>            <span class="n">data_key_encrypted_len</span> <span class="o">=</span> <span class="nb">int</span><span class="o">.</span><span class="n">from_bytes</span><span class="p">(</span><span class="n">file_contents</span><span class="p">[:</span><span class="n">NUM_BYTES_FOR_LEN</span><span class="p">],</span>
</span><span id="L-286"><a href="#L-286"><span class="linenos">286</span></a>                                                    <span class="n">byteorder</span><span class="o">=</span><span class="s1">&#39;big&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="n">NUM_BYTES_FOR_LEN</span>
</span><span id="L-287"><a href="#L-287"><span class="linenos">287</span></a>            <span class="n">data_key_encrypted</span> <span class="o">=</span> <span class="n">file_contents</span><span class="p">[</span><span class="n">NUM_BYTES_FOR_LEN</span><span class="p">:</span><span class="n">data_key_encrypted_len</span><span class="p">]</span>
</span><span id="L-288"><a href="#L-288"><span class="linenos">288</span></a>            <span class="c1"># Decrypt the data key before using it</span>
</span><span id="L-289"><a href="#L-289"><span class="linenos">289</span></a>            <span class="k">if</span> <span class="n">ACCESS_KEY</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">SECRET_KEY</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-290"><a href="#L-290"><span class="linenos">290</span></a>                <span class="n">kms_client</span> <span class="o">=</span> <span class="n">boto3</span><span class="o">.</span><span class="n">client</span><span class="p">(</span><span class="s1">&#39;kms&#39;</span><span class="p">,</span> <span class="n">aws_access_key_id</span><span class="o">=</span><span class="n">ACCESS_KEY</span><span class="p">,</span> <span class="n">aws_secret_access_key</span><span class="o">=</span><span class="n">SECRET_KEY</span><span class="p">)</span>
</span><span id="L-291"><a href="#L-291"><span class="linenos">291</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-292"><a href="#L-292"><span class="linenos">292</span></a>                <span class="n">kms_client</span> <span class="o">=</span> <span class="n">boto3</span><span class="o">.</span><span class="n">client</span><span class="p">(</span><span class="s1">&#39;kms&#39;</span><span class="p">)</span>
</span><span id="L-293"><a href="#L-293"><span class="linenos">293</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="L-294"><a href="#L-294"><span class="linenos">294</span></a>                <span class="n">response</span> <span class="o">=</span> <span class="n">kms_client</span><span class="o">.</span><span class="n">decrypt</span><span class="p">(</span><span class="n">CiphertextBlob</span><span class="o">=</span><span class="n">data_key_encrypted</span><span class="p">)</span>
</span><span id="L-295"><a href="#L-295"><span class="linenos">295</span></a>                <span class="n">data_key_plaintext</span> <span class="o">=</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64encode</span><span class="p">((</span><span class="n">response</span><span class="p">[</span><span class="s1">&#39;Plaintext&#39;</span><span class="p">]))</span>
</span><span id="L-296"><a href="#L-296"><span class="linenos">296</span></a>            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="L-297"><a href="#L-297"><span class="linenos">297</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
</span><span id="L-298"><a href="#L-298"><span class="linenos">298</span></a>                <span class="k">return</span> <span class="kc">False</span>
</span><span id="L-299"><a href="#L-299"><span class="linenos">299</span></a>
</span><span id="L-300"><a href="#L-300"><span class="linenos">300</span></a>            <span class="k">if</span> <span class="n">data_key_plaintext</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-301"><a href="#L-301"><span class="linenos">301</span></a>                <span class="k">return</span> <span class="kc">False</span>
</span><span id="L-302"><a href="#L-302"><span class="linenos">302</span></a>            <span class="c1"># Decrypt the rest of the file</span>
</span><span id="L-303"><a href="#L-303"><span class="linenos">303</span></a>            <span class="n">f</span> <span class="o">=</span> <span class="n">Fernet</span><span class="p">(</span><span class="n">data_key_plaintext</span><span class="p">)</span>
</span><span id="L-304"><a href="#L-304"><span class="linenos">304</span></a>            <span class="n">file_contents_decrypted</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">decrypt</span><span class="p">(</span><span class="n">file_contents</span><span class="p">[</span><span class="n">data_key_encrypted_len</span><span class="p">:])</span>
</span><span id="L-305"><a href="#L-305"><span class="linenos">305</span></a>            <span class="n">passwordsDictPlain</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">file_contents_decrypted</span><span class="p">)</span>
</span><span id="L-306"><a href="#L-306"><span class="linenos">306</span></a>            <span class="n">passwordsDictEncrypted</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="L-307"><a href="#L-307"><span class="linenos">307</span></a>            <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">passwordsDictPlain</span><span class="p">:</span>
</span><span id="L-308"><a href="#L-308"><span class="linenos">308</span></a>                <span class="n">passwordsDictEncrypted</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">aes_encrypt</span><span class="p">(</span><span class="n">passwordsDictPlain</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
</span><span id="L-309"><a href="#L-309"><span class="linenos">309</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">secrets_config</span> <span class="o">=</span> <span class="n">passwordsDictEncrypted</span>
</span><span id="L-310"><a href="#L-310"><span class="linenos">310</span></a>            <span class="k">return</span> <span class="kc">True</span>
</span><span id="L-311"><a href="#L-311"><span class="linenos">311</span></a>        <span class="k">elif</span> <span class="n">secret_type</span> <span class="o">==</span> <span class="s2">&quot;aws_secrets&quot;</span><span class="p">:</span>
</span><span id="L-312"><a href="#L-312"><span class="linenos">312</span></a>            <span class="n">ACCESS_KEY</span><span class="p">,</span> <span class="n">SECRET_KEY</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>
</span><span id="L-313"><a href="#L-313"><span class="linenos">313</span></a>            <span class="n">region</span> <span class="o">=</span> <span class="s1">&#39;us-west-2&#39;</span>
</span><span id="L-314"><a href="#L-314"><span class="linenos">314</span></a>            <span class="k">if</span> <span class="n">ini_config_file_path</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-315"><a href="#L-315"><span class="linenos">315</span></a>                <span class="n">config</span> <span class="o">=</span> <span class="n">ConfigParser</span><span class="p">()</span>
</span><span id="L-316"><a href="#L-316"><span class="linenos">316</span></a>                <span class="n">config</span><span class="o">.</span><span class="n">optionxform</span> <span class="o">=</span> <span class="nb">str</span>
</span><span id="L-317"><a href="#L-317"><span class="linenos">317</span></a>                <span class="n">config</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">ini_config_file_path</span><span class="p">)</span>
</span><span id="L-318"><a href="#L-318"><span class="linenos">318</span></a>                <span class="n">available_keys</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">items</span><span class="p">(</span><span class="s2">&quot;aws_secrets&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
</span><span id="L-319"><a href="#L-319"><span class="linenos">319</span></a>                <span class="k">if</span> <span class="s2">&quot;access_id&quot;</span> <span class="ow">in</span> <span class="n">available_keys</span> <span class="ow">and</span> <span class="s2">&quot;secret_key&quot;</span> <span class="ow">in</span> <span class="n">available_keys</span><span class="p">:</span>
</span><span id="L-320"><a href="#L-320"><span class="linenos">320</span></a>                    <span class="n">ACCESS_KEY</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;aws_secrets&quot;</span><span class="p">,</span> <span class="s2">&quot;access_id&quot;</span><span class="p">)</span>
</span><span id="L-321"><a href="#L-321"><span class="linenos">321</span></a>                    <span class="n">SECRET_KEY</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;aws_secrets&quot;</span><span class="p">,</span> <span class="s2">&quot;secret_key&quot;</span><span class="p">)</span>
</span><span id="L-322"><a href="#L-322"><span class="linenos">322</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="L-323"><a href="#L-323"><span class="linenos">323</span></a>                    <span class="n">ACCESS_KEY</span><span class="p">,</span> <span class="n">SECRET_KEY</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>
</span><span id="L-324"><a href="#L-324"><span class="linenos">324</span></a>                <span class="k">if</span> <span class="s2">&quot;region&quot;</span> <span class="ow">in</span> <span class="n">available_keys</span><span class="p">:</span>
</span><span id="L-325"><a href="#L-325"><span class="linenos">325</span></a>                    <span class="n">region</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;aws_secrets&quot;</span><span class="p">,</span> <span class="s2">&quot;region&quot;</span><span class="p">)</span>
</span><span id="L-326"><a href="#L-326"><span class="linenos">326</span></a>            <span class="k">if</span> <span class="n">keys</span><span class="p">:</span>
</span><span id="L-327"><a href="#L-327"><span class="linenos">327</span></a>                <span class="n">output_values</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-328"><a href="#L-328"><span class="linenos">328</span></a>                <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">keys</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">):</span>
</span><span id="L-329"><a href="#L-329"><span class="linenos">329</span></a>                    <span class="n">secrets_client</span> <span class="o">=</span> <span class="n">boto3</span><span class="o">.</span><span class="n">client</span><span class="p">(</span><span class="s2">&quot;secretsmanager&quot;</span><span class="p">,</span> <span class="n">region_name</span><span class="o">=</span><span class="n">region</span><span class="p">)</span>
</span><span id="L-330"><a href="#L-330"><span class="linenos">330</span></a>                    <span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;SecretId&#39;</span><span class="p">:</span> <span class="n">key</span><span class="p">}</span>
</span><span id="L-331"><a href="#L-331"><span class="linenos">331</span></a>                    <span class="k">try</span><span class="p">:</span>
</span><span id="L-332"><a href="#L-332"><span class="linenos">332</span></a>                        <span class="n">value</span> <span class="o">=</span> <span class="n">secrets_client</span><span class="o">.</span><span class="n">get_secret_value</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)[</span><span class="s2">&quot;SecretString&quot;</span><span class="p">]</span>
</span><span id="L-333"><a href="#L-333"><span class="linenos">333</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">secrets_config</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="L-334"><a href="#L-334"><span class="linenos">334</span></a>                        <span class="n">output_values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="L-335"><a href="#L-335"><span class="linenos">335</span></a>                    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="L-336"><a href="#L-336"><span class="linenos">336</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
</span><span id="L-337"><a href="#L-337"><span class="linenos">337</span></a>                <span class="k">return</span> <span class="n">output_values</span>
</span><span id="L-338"><a href="#L-338"><span class="linenos">338</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-339"><a href="#L-339"><span class="linenos">339</span></a>                <span class="c1"># Get all the secrets</span>
</span><span id="L-340"><a href="#L-340"><span class="linenos">340</span></a>                <span class="k">if</span> <span class="n">ACCESS_KEY</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">SECRET_KEY</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-341"><a href="#L-341"><span class="linenos">341</span></a>                    <span class="n">secrets_client</span> <span class="o">=</span> <span class="n">boto3</span><span class="o">.</span><span class="n">client</span><span class="p">(</span><span class="s2">&quot;secretsmanager&quot;</span><span class="p">,</span> <span class="n">aws_access_key_id</span><span class="o">=</span><span class="n">ACCESS_KEY</span><span class="p">,</span>
</span><span id="L-342"><a href="#L-342"><span class="linenos">342</span></a>                                                  <span class="n">aws_secret_access_key</span><span class="o">=</span><span class="n">SECRET_KEY</span><span class="p">,</span> <span class="n">region</span><span class="o">=</span><span class="n">region</span><span class="p">)</span>
</span><span id="L-343"><a href="#L-343"><span class="linenos">343</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="L-344"><a href="#L-344"><span class="linenos">344</span></a>                    <span class="n">secrets_client</span> <span class="o">=</span> <span class="n">boto3</span><span class="o">.</span><span class="n">client</span><span class="p">(</span><span class="s2">&quot;secretsmanager&quot;</span><span class="p">,</span><span class="n">region</span><span class="o">=</span><span class="n">region</span><span class="p">)</span>
</span><span id="L-345"><a href="#L-345"><span class="linenos">345</span></a>                <span class="n">temp</span> <span class="o">=</span> <span class="n">secrets_client</span><span class="o">.</span><span class="n">list_secrets</span><span class="p">()[</span><span class="s2">&quot;SecretList&quot;</span><span class="p">]</span>
</span><span id="L-346"><a href="#L-346"><span class="linenos">346</span></a>                <span class="n">all_secrets</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="p">[</span><span class="s2">&quot;Name&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">temp</span><span class="p">]</span>
</span><span id="L-347"><a href="#L-347"><span class="linenos">347</span></a>                <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">all_secrets</span><span class="p">:</span>
</span><span id="L-348"><a href="#L-348"><span class="linenos">348</span></a>                    <span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;SecretId&#39;</span><span class="p">:</span> <span class="n">key</span><span class="p">}</span>
</span><span id="L-349"><a href="#L-349"><span class="linenos">349</span></a>                    <span class="k">try</span><span class="p">:</span>
</span><span id="L-350"><a href="#L-350"><span class="linenos">350</span></a>                        <span class="n">value</span> <span class="o">=</span> <span class="n">secrets_client</span><span class="o">.</span><span class="n">get_secret_value</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)[</span><span class="s2">&quot;SecretString&quot;</span><span class="p">]</span>
</span><span id="L-351"><a href="#L-351"><span class="linenos">351</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">secrets_config</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="L-352"><a href="#L-352"><span class="linenos">352</span></a>                    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="L-353"><a href="#L-353"><span class="linenos">353</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
</span><span id="L-354"><a href="#L-354"><span class="linenos">354</span></a>        <span class="k">elif</span> <span class="n">secret_type</span> <span class="o">==</span> <span class="s2">&quot;azure_keyvault&quot;</span><span class="p">:</span>
</span><span id="L-355"><a href="#L-355"><span class="linenos">355</span></a>            <span class="kn">from</span> <span class="nn">azure.keyvault.secrets</span> <span class="kn">import</span> <span class="n">SecretClient</span>
</span><span id="L-356"><a href="#L-356"><span class="linenos">356</span></a>            <span class="kn">from</span> <span class="nn">azure.identity</span> <span class="kn">import</span> <span class="n">ClientSecretCredential</span>
</span><span id="L-357"><a href="#L-357"><span class="linenos">357</span></a>            <span class="n">config</span> <span class="o">=</span> <span class="n">ConfigParser</span><span class="p">()</span>
</span><span id="L-358"><a href="#L-358"><span class="linenos">358</span></a>            <span class="n">config</span><span class="o">.</span><span class="n">optionxform</span> <span class="o">=</span> <span class="nb">str</span>
</span><span id="L-359"><a href="#L-359"><span class="linenos">359</span></a>            <span class="n">config</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">ini_config_file_path</span><span class="p">)</span>
</span><span id="L-360"><a href="#L-360"><span class="linenos">360</span></a>            <span class="c1"># Read the encrypted file into memory</span>
</span><span id="L-361"><a href="#L-361"><span class="linenos">361</span></a>            <span class="n">available_keys</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">items</span><span class="p">(</span><span class="s2">&quot;azure_keyvault&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
</span><span id="L-362"><a href="#L-362"><span class="linenos">362</span></a>            <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="n">x</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;keyVaultName&#39;</span><span class="p">,</span> <span class="s1">&#39;tenant_id&#39;</span><span class="p">,</span> <span class="s1">&#39;client_id&#39;</span><span class="p">,</span> <span class="s1">&#39;client_secret&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">available_keys</span><span class="p">):</span>
</span><span id="L-363"><a href="#L-363"><span class="linenos">363</span></a>                <span class="n">keyVaultName</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;azure_keyvault&quot;</span><span class="p">,</span> <span class="s2">&quot;keyVaultName&quot;</span><span class="p">)</span>
</span><span id="L-364"><a href="#L-364"><span class="linenos">364</span></a>                <span class="n">KVUri</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;https://</span><span class="si">{</span><span class="n">keyVaultName</span><span class="si">}</span><span class="s2">.vault.azure.net&quot;</span>
</span><span id="L-365"><a href="#L-365"><span class="linenos">365</span></a>                <span class="n">tenant_id</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;azure_keyvault&quot;</span><span class="p">,</span> <span class="s2">&quot;tenant_id&quot;</span><span class="p">)</span>
</span><span id="L-366"><a href="#L-366"><span class="linenos">366</span></a>                <span class="n">client_id</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;azure_keyvault&quot;</span><span class="p">,</span> <span class="s2">&quot;client_id&quot;</span><span class="p">)</span>
</span><span id="L-367"><a href="#L-367"><span class="linenos">367</span></a>                <span class="n">client_secret</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;azure_keyvault&quot;</span><span class="p">,</span> <span class="s2">&quot;client_secret&quot;</span><span class="p">)</span>
</span><span id="L-368"><a href="#L-368"><span class="linenos">368</span></a>                <span class="n">credential</span> <span class="o">=</span> <span class="n">ClientSecretCredential</span><span class="p">(</span><span class="n">tenant_id</span><span class="p">,</span> <span class="n">client_id</span><span class="p">,</span> <span class="n">client_secret</span><span class="p">)</span>
</span><span id="L-369"><a href="#L-369"><span class="linenos">369</span></a>                <span class="n">client</span> <span class="o">=</span> <span class="n">SecretClient</span><span class="p">(</span><span class="n">vault_url</span><span class="o">=</span><span class="n">KVUri</span><span class="p">,</span> <span class="n">credential</span><span class="o">=</span><span class="n">credential</span><span class="p">)</span>
</span><span id="L-370"><a href="#L-370"><span class="linenos">370</span></a>                <span class="k">if</span> <span class="n">keys</span><span class="p">:</span>
</span><span id="L-371"><a href="#L-371"><span class="linenos">371</span></a>                    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">keys</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">):</span>
</span><span id="L-372"><a href="#L-372"><span class="linenos">372</span></a>                        <span class="n">retrieved_secret</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">get_secret</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
</span><span id="L-373"><a href="#L-373"><span class="linenos">373</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">secrets_config</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">aes_encrypt</span><span class="p">(</span><span class="n">retrieved_secret</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
</span><span id="L-374"><a href="#L-374"><span class="linenos">374</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="L-375"><a href="#L-375"><span class="linenos">375</span></a>                    <span class="n">secret_properties</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">list_properties_of_secrets</span><span class="p">()</span>
</span><span id="L-376"><a href="#L-376"><span class="linenos">376</span></a>                    <span class="n">all_secrets</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">secret_properties</span><span class="p">]</span>
</span><span id="L-377"><a href="#L-377"><span class="linenos">377</span></a>                    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">all_secrets</span><span class="p">:</span>
</span><span id="L-378"><a href="#L-378"><span class="linenos">378</span></a>                        <span class="n">retrieved_secret</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">get_secret</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
</span><span id="L-379"><a href="#L-379"><span class="linenos">379</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">secrets_config</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">aes_encrypt</span><span class="p">(</span><span class="n">retrieved_secret</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
</span><span id="L-380"><a href="#L-380"><span class="linenos">380</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">secrets_config</span><span class="p">[</span><span class="s2">&quot;custom_secrets_read&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
</span></pre></div>

        </details>

            </section>
                <section id="TimeoutHTTPAdapter">
                                <div class="attr class">
        <a class="headerlink" href="#TimeoutHTTPAdapter">#&nbsp;&nbsp</a>

        
        <span class="def">class</span>
        <span class="name">TimeoutHTTPAdapter</span><wbr>(<span class="base">requests.adapters.HTTPAdapter</span>):
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="TimeoutHTTPAdapter-19"><a href="#TimeoutHTTPAdapter-19"><span class="linenos">19</span></a><span class="k">class</span> <span class="nc">TimeoutHTTPAdapter</span><span class="p">(</span><span class="n">HTTPAdapter</span><span class="p">):</span>
</span><span id="TimeoutHTTPAdapter-20"><a href="#TimeoutHTTPAdapter-20"><span class="linenos">20</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="TimeoutHTTPAdapter-21"><a href="#TimeoutHTTPAdapter-21"><span class="linenos">21</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">timeout</span> <span class="o">=</span> <span class="n">local_configurations</span><span class="o">.</span><span class="n">REQUEST_TIMEOUT_IN_SEC</span>
</span><span id="TimeoutHTTPAdapter-22"><a href="#TimeoutHTTPAdapter-22"><span class="linenos">22</span></a>        <span class="k">if</span> <span class="s2">&quot;timeout&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
</span><span id="TimeoutHTTPAdapter-23"><a href="#TimeoutHTTPAdapter-23"><span class="linenos">23</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">timeout</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;timeout&quot;</span><span class="p">]</span>
</span><span id="TimeoutHTTPAdapter-24"><a href="#TimeoutHTTPAdapter-24"><span class="linenos">24</span></a>            <span class="k">del</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;timeout&quot;</span><span class="p">]</span>
</span><span id="TimeoutHTTPAdapter-25"><a href="#TimeoutHTTPAdapter-25"><span class="linenos">25</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="TimeoutHTTPAdapter-26"><a href="#TimeoutHTTPAdapter-26"><span class="linenos">26</span></a>
</span><span id="TimeoutHTTPAdapter-27"><a href="#TimeoutHTTPAdapter-27"><span class="linenos">27</span></a>    <span class="k">def</span> <span class="nf">send</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="TimeoutHTTPAdapter-28"><a href="#TimeoutHTTPAdapter-28"><span class="linenos">28</span></a>        <span class="n">timeout</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;timeout&quot;</span><span class="p">)</span>
</span><span id="TimeoutHTTPAdapter-29"><a href="#TimeoutHTTPAdapter-29"><span class="linenos">29</span></a>        <span class="k">if</span> <span class="n">timeout</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="TimeoutHTTPAdapter-30"><a href="#TimeoutHTTPAdapter-30"><span class="linenos">30</span></a>            <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;timeout&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">timeout</span>
</span><span id="TimeoutHTTPAdapter-31"><a href="#TimeoutHTTPAdapter-31"><span class="linenos">31</span></a>        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span></pre></div>

        </details>

            <div class="docstring"><p>The built-in HTTP Adapter for urllib3.</p>

<p>Provides a general-case interface for Requests sessions to contact HTTP and
HTTPS urls by implementing the Transport Adapter interface. This class will
usually be created by the <code>Session &lt;Session&gt;</code> class under the
covers.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>pool_connections</strong>:  The number of urllib3 connection pools to cache.</li>
<li><strong>pool_maxsize</strong>:  The maximum number of connections to save in the pool.</li>
<li><strong>max_retries</strong>:  The maximum number of retries each connection
should attempt. Note, this applies only to failed DNS lookups, socket
connections and connection timeouts, never to requests where data has
made it to the server. By default, Requests does not retry failed
connections. If you need granular control over the conditions under
which we retry a request, import urllib3's <code>Retry</code> class and pass
that instead.</li>
<li><strong>pool_block</strong>:  Whether the connection pool should block for connections.</li>
</ul>

<p>Usage::</p>

<div class="pdoc-code codehilite"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">requests</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">Session</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">adapters</span><span class="o">.</span><span class="n">HTTPAdapter</span><span class="p">(</span><span class="n">max_retries</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">mount</span><span class="p">(</span><span class="s1">&#39;http://&#39;</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>
</code></pre></div>
</div>


                            <div id="TimeoutHTTPAdapter.__init__" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#TimeoutHTTPAdapter.__init__">#&nbsp;&nbsp</a>

        
            <span class="name">TimeoutHTTPAdapter</span><span class="signature">(*args, **kwargs)</span>
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="TimeoutHTTPAdapter.__init__-20"><a href="#TimeoutHTTPAdapter.__init__-20"><span class="linenos">20</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="TimeoutHTTPAdapter.__init__-21"><a href="#TimeoutHTTPAdapter.__init__-21"><span class="linenos">21</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">timeout</span> <span class="o">=</span> <span class="n">local_configurations</span><span class="o">.</span><span class="n">REQUEST_TIMEOUT_IN_SEC</span>
</span><span id="TimeoutHTTPAdapter.__init__-22"><a href="#TimeoutHTTPAdapter.__init__-22"><span class="linenos">22</span></a>        <span class="k">if</span> <span class="s2">&quot;timeout&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
</span><span id="TimeoutHTTPAdapter.__init__-23"><a href="#TimeoutHTTPAdapter.__init__-23"><span class="linenos">23</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">timeout</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;timeout&quot;</span><span class="p">]</span>
</span><span id="TimeoutHTTPAdapter.__init__-24"><a href="#TimeoutHTTPAdapter.__init__-24"><span class="linenos">24</span></a>            <span class="k">del</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;timeout&quot;</span><span class="p">]</span>
</span><span id="TimeoutHTTPAdapter.__init__-25"><a href="#TimeoutHTTPAdapter.__init__-25"><span class="linenos">25</span></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span></pre></div>

        </details>

    

                            </div>
                            <div id="TimeoutHTTPAdapter.send" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#TimeoutHTTPAdapter.send">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">send</span><span class="signature">(self, request, **kwargs)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="TimeoutHTTPAdapter.send-27"><a href="#TimeoutHTTPAdapter.send-27"><span class="linenos">27</span></a>    <span class="k">def</span> <span class="nf">send</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="TimeoutHTTPAdapter.send-28"><a href="#TimeoutHTTPAdapter.send-28"><span class="linenos">28</span></a>        <span class="n">timeout</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;timeout&quot;</span><span class="p">)</span>
</span><span id="TimeoutHTTPAdapter.send-29"><a href="#TimeoutHTTPAdapter.send-29"><span class="linenos">29</span></a>        <span class="k">if</span> <span class="n">timeout</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="TimeoutHTTPAdapter.send-30"><a href="#TimeoutHTTPAdapter.send-30"><span class="linenos">30</span></a>            <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;timeout&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">timeout</span>
</span><span id="TimeoutHTTPAdapter.send-31"><a href="#TimeoutHTTPAdapter.send-31"><span class="linenos">31</span></a>        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span></pre></div>

        </details>

            <div class="docstring"><p>Sends PreparedRequest object. Returns Response object.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>request</strong>:  The <code>PreparedRequest &lt;PreparedRequest&gt;</code> being sent.</li>
<li><strong>stream</strong>:  (optional) Whether to stream the request content.</li>
<li><strong>timeout</strong>:  (optional) How long to wait for the server to send
data before giving up, as a float, or a :ref:<code>(connect timeout,
read timeout) &lt;timeouts&gt;</code> tuple.</li>
<li><strong>verify</strong>:  (optional) Either a boolean, in which case it controls whether
we verify the server's TLS certificate, or a string, in which case it
must be a path to a CA bundle to use</li>
<li><strong>cert</strong>:  (optional) Any user-provided SSL certificate to be trusted.</li>
<li><strong>proxies</strong>:  (optional) The proxies dictionary to apply to the request.</li>
</ul>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt>requests.adapters.HTTPAdapter</dt>
                                <dd id="TimeoutHTTPAdapter.init_poolmanager" class="function">init_poolmanager</dd>
                <dd id="TimeoutHTTPAdapter.proxy_manager_for" class="function">proxy_manager_for</dd>
                <dd id="TimeoutHTTPAdapter.cert_verify" class="function">cert_verify</dd>
                <dd id="TimeoutHTTPAdapter.build_response" class="function">build_response</dd>
                <dd id="TimeoutHTTPAdapter.get_connection" class="function">get_connection</dd>
                <dd id="TimeoutHTTPAdapter.close" class="function">close</dd>
                <dd id="TimeoutHTTPAdapter.request_url" class="function">request_url</dd>
                <dd id="TimeoutHTTPAdapter.add_headers" class="function">add_headers</dd>
                <dd id="TimeoutHTTPAdapter.proxy_headers" class="function">proxy_headers</dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="initialise_http_client">
                            <div class="attr function"><a class="headerlink" href="#initialise_http_client">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">initialise_http_client</span><span class="signature">()</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="initialise_http_client-34"><a href="#initialise_http_client-34"><span class="linenos">34</span></a><span class="k">def</span> <span class="nf">initialise_http_client</span><span class="p">():</span>
</span><span id="initialise_http_client-35"><a href="#initialise_http_client-35"><span class="linenos">35</span></a>    <span class="n">retries</span> <span class="o">=</span> <span class="n">Retry</span><span class="p">(</span><span class="n">total</span><span class="o">=</span><span class="n">local_configurations</span><span class="o">.</span><span class="n">MAX_RETRIES</span><span class="p">,</span> <span class="n">backoff_factor</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span><span id="initialise_http_client-36"><a href="#initialise_http_client-36"><span class="linenos">36</span></a>                    <span class="n">status_forcelist</span><span class="o">=</span><span class="p">[</span><span class="mi">429</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="mi">502</span><span class="p">,</span> <span class="mi">503</span><span class="p">,</span> <span class="mi">504</span><span class="p">])</span>
</span><span id="initialise_http_client-37"><a href="#initialise_http_client-37"><span class="linenos">37</span></a>    <span class="n">http</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">Session</span><span class="p">()</span>
</span><span id="initialise_http_client-38"><a href="#initialise_http_client-38"><span class="linenos">38</span></a>    <span class="n">adapter</span> <span class="o">=</span> <span class="n">TimeoutHTTPAdapter</span><span class="p">(</span><span class="n">max_retries</span><span class="o">=</span><span class="n">retries</span><span class="p">)</span>
</span><span id="initialise_http_client-39"><a href="#initialise_http_client-39"><span class="linenos">39</span></a>    <span class="n">http</span><span class="o">.</span><span class="n">mount</span><span class="p">(</span><span class="s2">&quot;https://&quot;</span><span class="p">,</span> <span class="n">adapter</span><span class="p">)</span>
</span><span id="initialise_http_client-40"><a href="#initialise_http_client-40"><span class="linenos">40</span></a>    <span class="n">http</span><span class="o">.</span><span class="n">mount</span><span class="p">(</span><span class="s2">&quot;http://&quot;</span><span class="p">,</span> <span class="n">adapter</span><span class="p">)</span>
</span><span id="initialise_http_client-41"><a href="#initialise_http_client-41"><span class="linenos">41</span></a>    <span class="k">return</span> <span class="n">http</span>
</span></pre></div>

        </details>

    

                </section>
                <section id="BaseClient">
                                <div class="attr class">
        <a class="headerlink" href="#BaseClient">#&nbsp;&nbsp</a>

        
        <span class="def">class</span>
        <span class="name">BaseClient</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="BaseClient-44"><a href="#BaseClient-44"><span class="linenos"> 44</span></a><span class="k">class</span> <span class="nc">BaseClient</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
</span><span id="BaseClient-45"><a href="#BaseClient-45"><span class="linenos"> 45</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="BaseClient-46"><a href="#BaseClient-46"><span class="linenos"> 46</span></a>        <span class="c1"># print(&quot;Inside BaseClient&quot;)</span>
</span><span id="BaseClient-47"><a href="#BaseClient-47"><span class="linenos"> 47</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">client_config</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="BaseClient-48"><a href="#BaseClient-48"><span class="linenos"> 48</span></a>            <span class="s1">&#39;protocol&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="BaseClient-49"><a href="#BaseClient-49"><span class="linenos"> 49</span></a>            <span class="s1">&#39;ip&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="BaseClient-50"><a href="#BaseClient-50"><span class="linenos"> 50</span></a>            <span class="s1">&#39;port&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="BaseClient-51"><a href="#BaseClient-51"><span class="linenos"> 51</span></a>            <span class="s1">&#39;refresh_token&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="BaseClient-52"><a href="#BaseClient-52"><span class="linenos"> 52</span></a>            <span class="s1">&#39;bearer_token&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="BaseClient-53"><a href="#BaseClient-53"><span class="linenos"> 53</span></a>            <span class="s1">&#39;default_environment_id&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="BaseClient-54"><a href="#BaseClient-54"><span class="linenos"> 54</span></a>            <span class="s1">&#39;default_storage_id&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="BaseClient-55"><a href="#BaseClient-55"><span class="linenos"> 55</span></a>            <span class="s1">&#39;default_compute_id&#39;</span><span class="p">:</span> <span class="kc">None</span>
</span><span id="BaseClient-56"><a href="#BaseClient-56"><span class="linenos"> 56</span></a>        <span class="p">}</span>
</span><span id="BaseClient-57"><a href="#BaseClient-57"><span class="linenos"> 57</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">secrets_config</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;custom_secrets_read&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">}</span>
</span><span id="BaseClient-58"><a href="#BaseClient-58"><span class="linenos"> 58</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mappings</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="BaseClient-59"><a href="#BaseClient-59"><span class="linenos"> 59</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">http</span> <span class="o">=</span> <span class="n">initialise_http_client</span><span class="p">()</span>
</span><span id="BaseClient-60"><a href="#BaseClient-60"><span class="linenos"> 60</span></a>        <span class="n">log_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">local_configurations</span><span class="o">.</span><span class="n">LOG_LOCATION</span><span class="p">)</span>
</span><span id="BaseClient-61"><a href="#BaseClient-61"><span class="linenos"> 61</span></a>        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">log_path</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">absolute</span><span class="p">()):</span>
</span><span id="BaseClient-62"><a href="#BaseClient-62"><span class="linenos"> 62</span></a>            <span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="n">local_configurations</span><span class="o">.</span><span class="n">LOG_LOCATION</span><span class="p">,</span> <span class="n">filemode</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span>
</span><span id="BaseClient-63"><a href="#BaseClient-63"><span class="linenos"> 63</span></a>                                <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%(asctime)s</span><span class="s1"> - </span><span class="si">%(module)s</span><span class="s1"> - </span><span class="si">%(pathname)s</span><span class="s1"> - </span><span class="si">%(lineno)d</span><span class="s1"> - </span><span class="si">%(levelname)s</span><span class="s1"> - </span><span class="si">%(message)s</span><span class="s1">&#39;</span><span class="p">,</span>
</span><span id="BaseClient-64"><a href="#BaseClient-64"><span class="linenos"> 64</span></a>                                <span class="n">level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">DEBUG</span><span class="p">,</span> <span class="n">datefmt</span><span class="o">=</span><span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1"> %H:%M:%S&#39;</span><span class="p">)</span>
</span><span id="BaseClient-65"><a href="#BaseClient-65"><span class="linenos"> 65</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="BaseClient-66"><a href="#BaseClient-66"><span class="linenos"> 66</span></a>            <span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span>
</span><span id="BaseClient-67"><a href="#BaseClient-67"><span class="linenos"> 67</span></a>                <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%(asctime)s</span><span class="s1"> - </span><span class="si">%(module)s</span><span class="s1"> - </span><span class="si">%(pathname)s</span><span class="s1"> - </span><span class="si">%(lineno)d</span><span class="s1"> - </span><span class="si">%(levelname)s</span><span class="s1"> - </span><span class="si">%(message)s</span><span class="s1">&#39;</span><span class="p">,</span>
</span><span id="BaseClient-68"><a href="#BaseClient-68"><span class="linenos"> 68</span></a>                <span class="n">level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">DEBUG</span><span class="p">,</span> <span class="n">datefmt</span><span class="o">=</span><span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1"> %H:%M:%S&#39;</span><span class="p">)</span>
</span><span id="BaseClient-69"><a href="#BaseClient-69"><span class="linenos"> 69</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s1">&#39;infoworks_sdk_logs&#39;</span><span class="p">)</span>
</span><span id="BaseClient-70"><a href="#BaseClient-70"><span class="linenos"> 70</span></a>
</span><span id="BaseClient-71"><a href="#BaseClient-71"><span class="linenos"> 71</span></a>    <span class="k">def</span> <span class="nf">initialize_client</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">protocol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ip</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="p">):</span>
</span><span id="BaseClient-72"><a href="#BaseClient-72"><span class="linenos"> 72</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="BaseClient-73"><a href="#BaseClient-73"><span class="linenos"> 73</span></a><span class="sd">        initialize the client</span>
</span><span id="BaseClient-74"><a href="#BaseClient-74"><span class="linenos"> 74</span></a><span class="sd">        :param protocol: protocol to be used for server call</span>
</span><span id="BaseClient-75"><a href="#BaseClient-75"><span class="linenos"> 75</span></a><span class="sd">        :type protocol: String</span>
</span><span id="BaseClient-76"><a href="#BaseClient-76"><span class="linenos"> 76</span></a><span class="sd">        :param ip: Client IP</span>
</span><span id="BaseClient-77"><a href="#BaseClient-77"><span class="linenos"> 77</span></a><span class="sd">        :type ip: String</span>
</span><span id="BaseClient-78"><a href="#BaseClient-78"><span class="linenos"> 78</span></a><span class="sd">        :param port: Client Port</span>
</span><span id="BaseClient-79"><a href="#BaseClient-79"><span class="linenos"> 79</span></a><span class="sd">        :type port: String</span>
</span><span id="BaseClient-80"><a href="#BaseClient-80"><span class="linenos"> 80</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="BaseClient-81"><a href="#BaseClient-81"><span class="linenos"> 81</span></a>
</span><span id="BaseClient-82"><a href="#BaseClient-82"><span class="linenos"> 82</span></a>        <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="n">v</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="p">[</span><span class="n">protocol</span><span class="p">,</span> <span class="n">ip</span><span class="p">,</span> <span class="n">port</span><span class="p">]):</span>
</span><span id="BaseClient-83"><a href="#BaseClient-83"><span class="linenos"> 83</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">client_config</span><span class="p">[</span><span class="s1">&#39;protocol&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">protocol</span>
</span><span id="BaseClient-84"><a href="#BaseClient-84"><span class="linenos"> 84</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">client_config</span><span class="p">[</span><span class="s1">&#39;ip&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ip</span>
</span><span id="BaseClient-85"><a href="#BaseClient-85"><span class="linenos"> 85</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">client_config</span><span class="p">[</span><span class="s1">&#39;port&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">port</span>
</span><span id="BaseClient-86"><a href="#BaseClient-86"><span class="linenos"> 86</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="BaseClient-87"><a href="#BaseClient-87"><span class="linenos"> 87</span></a>            <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Pass valid values&quot;</span><span class="p">))</span>
</span><span id="BaseClient-88"><a href="#BaseClient-88"><span class="linenos"> 88</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Pass valid values&quot;</span><span class="p">)</span>
</span><span id="BaseClient-89"><a href="#BaseClient-89"><span class="linenos"> 89</span></a>
</span><span id="BaseClient-90"><a href="#BaseClient-90"><span class="linenos"> 90</span></a>    <span class="k">def</span> <span class="nf">initialize_client_with_defaults</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">protocol</span><span class="p">,</span> <span class="n">ip</span><span class="p">,</span> <span class="n">port</span><span class="p">,</span> <span class="n">refresh_token</span><span class="p">,</span> <span class="n">default_environment_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="BaseClient-91"><a href="#BaseClient-91"><span class="linenos"> 91</span></a>                                        <span class="n">default_storage_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">default_compute_id</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="BaseClient-92"><a href="#BaseClient-92"><span class="linenos"> 92</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="BaseClient-93"><a href="#BaseClient-93"><span class="linenos"> 93</span></a><span class="sd">        initializes the client and a user with given configuration</span>
</span><span id="BaseClient-94"><a href="#BaseClient-94"><span class="linenos"> 94</span></a><span class="sd">        :param protocol: protocol to be used for server call</span>
</span><span id="BaseClient-95"><a href="#BaseClient-95"><span class="linenos"> 95</span></a><span class="sd">        :type protocol: String</span>
</span><span id="BaseClient-96"><a href="#BaseClient-96"><span class="linenos"> 96</span></a><span class="sd">        :param ip: ip address of the server</span>
</span><span id="BaseClient-97"><a href="#BaseClient-97"><span class="linenos"> 97</span></a><span class="sd">        :type ip: String</span>
</span><span id="BaseClient-98"><a href="#BaseClient-98"><span class="linenos"> 98</span></a><span class="sd">        :param port: port on which the rest service resides</span>
</span><span id="BaseClient-99"><a href="#BaseClient-99"><span class="linenos"> 99</span></a><span class="sd">        :type port: String</span>
</span><span id="BaseClient-100"><a href="#BaseClient-100"><span class="linenos">100</span></a><span class="sd">        :param refresh_token: refresh_token of the user</span>
</span><span id="BaseClient-101"><a href="#BaseClient-101"><span class="linenos">101</span></a><span class="sd">        :type refresh_token: String</span>
</span><span id="BaseClient-102"><a href="#BaseClient-102"><span class="linenos">102</span></a><span class="sd">        :param default_compute_id: Pass the default compute id to be used for all the artifacts to be created</span>
</span><span id="BaseClient-103"><a href="#BaseClient-103"><span class="linenos">103</span></a><span class="sd">        :param default_storage_id: Pass the default storage id to be used for all the artifacts to be created</span>
</span><span id="BaseClient-104"><a href="#BaseClient-104"><span class="linenos">104</span></a><span class="sd">        :param default_environment_id: Pass the default environment id to be used for all the artifacts to be created</span>
</span><span id="BaseClient-105"><a href="#BaseClient-105"><span class="linenos">105</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="BaseClient-106"><a href="#BaseClient-106"><span class="linenos">106</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">client_config</span><span class="p">[</span><span class="s1">&#39;refresh_token&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">refresh_token</span>
</span><span id="BaseClient-107"><a href="#BaseClient-107"><span class="linenos">107</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">client_config</span><span class="p">[</span><span class="s1">&#39;bearer_token&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_bearer_token</span><span class="p">(</span><span class="n">protocol</span><span class="p">,</span> <span class="n">ip</span><span class="p">,</span> <span class="n">port</span><span class="p">,</span> <span class="n">refresh_token</span><span class="p">)</span>
</span><span id="BaseClient-108"><a href="#BaseClient-108"><span class="linenos">108</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">initialize_client</span><span class="p">(</span><span class="n">protocol</span><span class="p">,</span> <span class="n">ip</span><span class="p">,</span> <span class="n">port</span><span class="p">)</span>
</span><span id="BaseClient-109"><a href="#BaseClient-109"><span class="linenos">109</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">client_config</span><span class="p">[</span>
</span><span id="BaseClient-110"><a href="#BaseClient-110"><span class="linenos">110</span></a>            <span class="s1">&#39;default_environment_id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">default_environment_id</span> <span class="k">if</span> <span class="n">default_environment_id</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span>
</span><span id="BaseClient-111"><a href="#BaseClient-111"><span class="linenos">111</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">client_config</span><span class="p">[</span><span class="s1">&#39;default_storage_id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">default_storage_id</span> <span class="k">if</span> <span class="n">default_storage_id</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span>
</span><span id="BaseClient-112"><a href="#BaseClient-112"><span class="linenos">112</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">client_config</span><span class="p">[</span><span class="s1">&#39;default_compute_id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">default_compute_id</span> <span class="k">if</span> <span class="n">default_compute_id</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span>
</span><span id="BaseClient-113"><a href="#BaseClient-113"><span class="linenos">113</span></a>
</span><span id="BaseClient-114"><a href="#BaseClient-114"><span class="linenos">114</span></a>    <span class="k">def</span> <span class="nf">get_configurations</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="BaseClient-115"><a href="#BaseClient-115"><span class="linenos">115</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="BaseClient-116"><a href="#BaseClient-116"><span class="linenos">116</span></a><span class="sd">        returns client configurations</span>
</span><span id="BaseClient-117"><a href="#BaseClient-117"><span class="linenos">117</span></a><span class="sd">        :return: configuration dictionary</span>
</span><span id="BaseClient-118"><a href="#BaseClient-118"><span class="linenos">118</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="BaseClient-119"><a href="#BaseClient-119"><span class="linenos">119</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">client_config</span>
</span><span id="BaseClient-120"><a href="#BaseClient-120"><span class="linenos">120</span></a>
</span><span id="BaseClient-121"><a href="#BaseClient-121"><span class="linenos">121</span></a>    <span class="k">def</span> <span class="nf">regenerate_bearer_token_if_needed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">headers</span><span class="p">):</span>
</span><span id="BaseClient-122"><a href="#BaseClient-122"><span class="linenos">122</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">is_token_valid</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">client_config</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">http</span><span class="p">):</span>
</span><span id="BaseClient-123"><a href="#BaseClient-123"><span class="linenos">123</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">client_config</span><span class="p">[</span><span class="s1">&#39;bearer_token&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_bearer_token</span><span class="p">(</span><span class="n">protocol</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">client_config</span><span class="p">[</span><span class="s2">&quot;protocol&quot;</span><span class="p">],</span>
</span><span id="BaseClient-124"><a href="#BaseClient-124"><span class="linenos">124</span></a>                                                                  <span class="n">ip</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">client_config</span><span class="p">[</span><span class="s2">&quot;ip&quot;</span><span class="p">],</span>
</span><span id="BaseClient-125"><a href="#BaseClient-125"><span class="linenos">125</span></a>                                                                  <span class="n">port</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">client_config</span><span class="p">[</span><span class="s2">&quot;port&quot;</span><span class="p">],</span>
</span><span id="BaseClient-126"><a href="#BaseClient-126"><span class="linenos">126</span></a>                                                                  <span class="n">refresh_token</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">client_config</span><span class="p">[</span><span class="s2">&quot;refresh_token&quot;</span><span class="p">])</span>
</span><span id="BaseClient-127"><a href="#BaseClient-127"><span class="linenos">127</span></a>            <span class="n">headers</span> <span class="o">=</span> <span class="n">IWUtils</span><span class="o">.</span><span class="n">get_default_header_for_v3</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">client_config</span><span class="p">[</span><span class="s1">&#39;bearer_token&#39;</span><span class="p">])</span>
</span><span id="BaseClient-128"><a href="#BaseClient-128"><span class="linenos">128</span></a>        <span class="k">return</span> <span class="n">headers</span>
</span><span id="BaseClient-129"><a href="#BaseClient-129"><span class="linenos">129</span></a>
</span><span id="BaseClient-130"><a href="#BaseClient-130"><span class="linenos">130</span></a>    <span class="k">def</span> <span class="nf">call_api</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="BaseClient-131"><a href="#BaseClient-131"><span class="linenos">131</span></a>        <span class="c1"># headers = self.regenerate_bearer_token_if_needed(headers)</span>
</span><span id="BaseClient-132"><a href="#BaseClient-132"><span class="linenos">132</span></a>        <span class="k">if</span> <span class="n">method</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;GET&quot;</span><span class="p">:</span>
</span><span id="BaseClient-133"><a href="#BaseClient-133"><span class="linenos">133</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Calling </span><span class="si">{</span><span class="n">url</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="BaseClient-134"><a href="#BaseClient-134"><span class="linenos">134</span></a>            <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">http</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="n">local_configurations</span><span class="o">.</span><span class="n">REQUEST_TIMEOUT_IN_SEC</span><span class="p">,</span>
</span><span id="BaseClient-135"><a href="#BaseClient-135"><span class="linenos">135</span></a>                                     <span class="n">verify</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
</span><span id="BaseClient-136"><a href="#BaseClient-136"><span class="linenos">136</span></a>            <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">406</span><span class="p">:</span>
</span><span id="BaseClient-137"><a href="#BaseClient-137"><span class="linenos">137</span></a>                <span class="n">headers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">regenerate_bearer_token_if_needed</span><span class="p">(</span><span class="n">headers</span><span class="p">)</span>
</span><span id="BaseClient-138"><a href="#BaseClient-138"><span class="linenos">138</span></a>                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">http</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="n">local_configurations</span><span class="o">.</span><span class="n">REQUEST_TIMEOUT_IN_SEC</span><span class="p">,</span>
</span><span id="BaseClient-139"><a href="#BaseClient-139"><span class="linenos">139</span></a>                                     <span class="n">verify</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
</span><span id="BaseClient-140"><a href="#BaseClient-140"><span class="linenos">140</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="BaseClient-141"><a href="#BaseClient-141"><span class="linenos">141</span></a>                <span class="k">return</span> <span class="n">response</span>
</span><span id="BaseClient-142"><a href="#BaseClient-142"><span class="linenos">142</span></a>        <span class="k">elif</span> <span class="n">method</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;POST&quot;</span><span class="p">:</span>
</span><span id="BaseClient-143"><a href="#BaseClient-143"><span class="linenos">143</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Calling </span><span class="si">{</span><span class="n">url</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="BaseClient-144"><a href="#BaseClient-144"><span class="linenos">144</span></a>            <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">http</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
</span><span id="BaseClient-145"><a href="#BaseClient-145"><span class="linenos">145</span></a>                                      <span class="n">timeout</span><span class="o">=</span><span class="n">local_configurations</span><span class="o">.</span><span class="n">REQUEST_TIMEOUT_IN_SEC</span><span class="p">,</span> <span class="n">verify</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="BaseClient-146"><a href="#BaseClient-146"><span class="linenos">146</span></a>            <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">406</span><span class="p">:</span>
</span><span id="BaseClient-147"><a href="#BaseClient-147"><span class="linenos">147</span></a>                <span class="n">headers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">regenerate_bearer_token_if_needed</span><span class="p">(</span><span class="n">headers</span><span class="p">)</span>
</span><span id="BaseClient-148"><a href="#BaseClient-148"><span class="linenos">148</span></a>                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">http</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
</span><span id="BaseClient-149"><a href="#BaseClient-149"><span class="linenos">149</span></a>                                      <span class="n">timeout</span><span class="o">=</span><span class="n">local_configurations</span><span class="o">.</span><span class="n">REQUEST_TIMEOUT_IN_SEC</span><span class="p">,</span> <span class="n">verify</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="BaseClient-150"><a href="#BaseClient-150"><span class="linenos">150</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="BaseClient-151"><a href="#BaseClient-151"><span class="linenos">151</span></a>                <span class="k">return</span> <span class="n">response</span>
</span><span id="BaseClient-152"><a href="#BaseClient-152"><span class="linenos">152</span></a>        <span class="k">elif</span> <span class="n">method</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;PUT&quot;</span><span class="p">:</span>
</span><span id="BaseClient-153"><a href="#BaseClient-153"><span class="linenos">153</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Calling </span><span class="si">{</span><span class="n">url</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="BaseClient-154"><a href="#BaseClient-154"><span class="linenos">154</span></a>            <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">http</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
</span><span id="BaseClient-155"><a href="#BaseClient-155"><span class="linenos">155</span></a>                                     <span class="n">timeout</span><span class="o">=</span><span class="n">local_configurations</span><span class="o">.</span><span class="n">REQUEST_TIMEOUT_IN_SEC</span><span class="p">,</span> <span class="n">verify</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="BaseClient-156"><a href="#BaseClient-156"><span class="linenos">156</span></a>            <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">406</span><span class="p">:</span>
</span><span id="BaseClient-157"><a href="#BaseClient-157"><span class="linenos">157</span></a>                <span class="n">headers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">regenerate_bearer_token_if_needed</span><span class="p">(</span><span class="n">headers</span><span class="p">)</span>
</span><span id="BaseClient-158"><a href="#BaseClient-158"><span class="linenos">158</span></a>                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">http</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
</span><span id="BaseClient-159"><a href="#BaseClient-159"><span class="linenos">159</span></a>                                     <span class="n">timeout</span><span class="o">=</span><span class="n">local_configurations</span><span class="o">.</span><span class="n">REQUEST_TIMEOUT_IN_SEC</span><span class="p">,</span> <span class="n">verify</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="BaseClient-160"><a href="#BaseClient-160"><span class="linenos">160</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="BaseClient-161"><a href="#BaseClient-161"><span class="linenos">161</span></a>                <span class="k">return</span> <span class="n">response</span>
</span><span id="BaseClient-162"><a href="#BaseClient-162"><span class="linenos">162</span></a>        <span class="k">elif</span> <span class="n">method</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;PATCH&quot;</span><span class="p">:</span>
</span><span id="BaseClient-163"><a href="#BaseClient-163"><span class="linenos">163</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Calling </span><span class="si">{</span><span class="n">url</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="BaseClient-164"><a href="#BaseClient-164"><span class="linenos">164</span></a>            <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">http</span><span class="o">.</span><span class="n">patch</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
</span><span id="BaseClient-165"><a href="#BaseClient-165"><span class="linenos">165</span></a>                                       <span class="n">timeout</span><span class="o">=</span><span class="n">local_configurations</span><span class="o">.</span><span class="n">REQUEST_TIMEOUT_IN_SEC</span><span class="p">,</span> <span class="n">verify</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="BaseClient-166"><a href="#BaseClient-166"><span class="linenos">166</span></a>            <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">406</span><span class="p">:</span>
</span><span id="BaseClient-167"><a href="#BaseClient-167"><span class="linenos">167</span></a>                <span class="n">headers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">regenerate_bearer_token_if_needed</span><span class="p">(</span><span class="n">headers</span><span class="p">)</span>
</span><span id="BaseClient-168"><a href="#BaseClient-168"><span class="linenos">168</span></a>                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">http</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
</span><span id="BaseClient-169"><a href="#BaseClient-169"><span class="linenos">169</span></a>                                     <span class="n">timeout</span><span class="o">=</span><span class="n">local_configurations</span><span class="o">.</span><span class="n">REQUEST_TIMEOUT_IN_SEC</span><span class="p">,</span> <span class="n">verify</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="BaseClient-170"><a href="#BaseClient-170"><span class="linenos">170</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="BaseClient-171"><a href="#BaseClient-171"><span class="linenos">171</span></a>                <span class="k">return</span> <span class="n">response</span>
</span><span id="BaseClient-172"><a href="#BaseClient-172"><span class="linenos">172</span></a>        <span class="k">elif</span> <span class="n">method</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;DELETE&quot;</span><span class="p">:</span>
</span><span id="BaseClient-173"><a href="#BaseClient-173"><span class="linenos">173</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Calling </span><span class="si">{</span><span class="n">url</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="BaseClient-174"><a href="#BaseClient-174"><span class="linenos">174</span></a>            <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">http</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="n">local_configurations</span><span class="o">.</span><span class="n">REQUEST_TIMEOUT_IN_SEC</span><span class="p">,</span>
</span><span id="BaseClient-175"><a href="#BaseClient-175"><span class="linenos">175</span></a>                                        <span class="n">verify</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="BaseClient-176"><a href="#BaseClient-176"><span class="linenos">176</span></a>            <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">406</span><span class="p">:</span>
</span><span id="BaseClient-177"><a href="#BaseClient-177"><span class="linenos">177</span></a>                <span class="n">headers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">regenerate_bearer_token_if_needed</span><span class="p">(</span><span class="n">headers</span><span class="p">)</span>
</span><span id="BaseClient-178"><a href="#BaseClient-178"><span class="linenos">178</span></a>                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">http</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="n">local_configurations</span><span class="o">.</span><span class="n">REQUEST_TIMEOUT_IN_SEC</span><span class="p">,</span>
</span><span id="BaseClient-179"><a href="#BaseClient-179"><span class="linenos">179</span></a>                                        <span class="n">verify</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="BaseClient-180"><a href="#BaseClient-180"><span class="linenos">180</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="BaseClient-181"><a href="#BaseClient-181"><span class="linenos">181</span></a>                <span class="k">return</span> <span class="n">response</span>
</span><span id="BaseClient-182"><a href="#BaseClient-182"><span class="linenos">182</span></a>
</span><span id="BaseClient-183"><a href="#BaseClient-183"><span class="linenos">183</span></a>    <span class="k">def</span> <span class="nf">get_mappings_from_config_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ini_config_file_path</span><span class="p">):</span>
</span><span id="BaseClient-184"><a href="#BaseClient-184"><span class="linenos">184</span></a>        <span class="n">config</span> <span class="o">=</span> <span class="n">ConfigParser</span><span class="p">()</span>
</span><span id="BaseClient-185"><a href="#BaseClient-185"><span class="linenos">185</span></a>        <span class="n">config</span><span class="o">.</span><span class="n">optionxform</span> <span class="o">=</span> <span class="nb">str</span>
</span><span id="BaseClient-186"><a href="#BaseClient-186"><span class="linenos">186</span></a>        <span class="n">config</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">ini_config_file_path</span><span class="p">)</span>
</span><span id="BaseClient-187"><a href="#BaseClient-187"><span class="linenos">187</span></a>        <span class="k">if</span> <span class="s2">&quot;environment&quot;</span> <span class="ow">in</span> <span class="n">config</span><span class="p">:</span>
</span><span id="BaseClient-188"><a href="#BaseClient-188"><span class="linenos">188</span></a>            <span class="n">default_environment_id</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;environment&quot;</span><span class="p">,</span> <span class="s2">&quot;environment_id&quot;</span><span class="p">)</span>
</span><span id="BaseClient-189"><a href="#BaseClient-189"><span class="linenos">189</span></a>            <span class="n">default_storage_id</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;environment&quot;</span><span class="p">,</span> <span class="s2">&quot;storage_id&quot;</span><span class="p">)</span>
</span><span id="BaseClient-190"><a href="#BaseClient-190"><span class="linenos">190</span></a>            <span class="n">default_interactive_id</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;environment&quot;</span><span class="p">,</span> <span class="s2">&quot;interactive_id&quot;</span><span class="p">)</span>
</span><span id="BaseClient-191"><a href="#BaseClient-191"><span class="linenos">191</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">client_config</span><span class="p">[</span><span class="s2">&quot;default_environment_id&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">default_environment_id</span>
</span><span id="BaseClient-192"><a href="#BaseClient-192"><span class="linenos">192</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">client_config</span><span class="p">[</span><span class="s2">&quot;default_storage_id&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">default_storage_id</span>
</span><span id="BaseClient-193"><a href="#BaseClient-193"><span class="linenos">193</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">client_config</span><span class="p">[</span><span class="s2">&quot;default_compute_id&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">default_interactive_id</span>
</span><span id="BaseClient-194"><a href="#BaseClient-194"><span class="linenos">194</span></a>        <span class="k">if</span> <span class="s2">&quot;environment_mappings&quot;</span> <span class="ow">in</span> <span class="n">config</span><span class="p">:</span>
</span><span id="BaseClient-195"><a href="#BaseClient-195"><span class="linenos">195</span></a>            <span class="n">environment_mappings</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">items</span><span class="p">(</span><span class="s2">&quot;environment_mappings&quot;</span><span class="p">))</span>
</span><span id="BaseClient-196"><a href="#BaseClient-196"><span class="linenos">196</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">mappings</span><span class="p">[</span><span class="s2">&quot;environment_mappings&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">environment_mappings</span>
</span><span id="BaseClient-197"><a href="#BaseClient-197"><span class="linenos">197</span></a>        <span class="k">if</span> <span class="s2">&quot;storage_mappings&quot;</span> <span class="ow">in</span> <span class="n">config</span><span class="p">:</span>
</span><span id="BaseClient-198"><a href="#BaseClient-198"><span class="linenos">198</span></a>            <span class="n">storage_mappings</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">items</span><span class="p">(</span><span class="s2">&quot;storage_mappings&quot;</span><span class="p">))</span>
</span><span id="BaseClient-199"><a href="#BaseClient-199"><span class="linenos">199</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">mappings</span><span class="p">[</span><span class="s2">&quot;storage_mappings&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">storage_mappings</span>
</span><span id="BaseClient-200"><a href="#BaseClient-200"><span class="linenos">200</span></a>        <span class="k">if</span> <span class="s2">&quot;compute_mappings&quot;</span> <span class="ow">in</span> <span class="n">config</span><span class="p">:</span>
</span><span id="BaseClient-201"><a href="#BaseClient-201"><span class="linenos">201</span></a>            <span class="n">compute_mappings</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">items</span><span class="p">(</span><span class="s2">&quot;compute_mappings&quot;</span><span class="p">))</span>
</span><span id="BaseClient-202"><a href="#BaseClient-202"><span class="linenos">202</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">mappings</span><span class="p">[</span><span class="s2">&quot;compute_mappings&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">compute_mappings</span>
</span><span id="BaseClient-203"><a href="#BaseClient-203"><span class="linenos">203</span></a>        <span class="k">if</span> <span class="s2">&quot;gcp_details&quot;</span> <span class="ow">in</span> <span class="n">config</span><span class="p">:</span>
</span><span id="BaseClient-204"><a href="#BaseClient-204"><span class="linenos">204</span></a>            <span class="n">gcp_details</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">items</span><span class="p">(</span><span class="s2">&quot;gcp_details&quot;</span><span class="p">))</span>
</span><span id="BaseClient-205"><a href="#BaseClient-205"><span class="linenos">205</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">mappings</span><span class="p">[</span><span class="s2">&quot;gcp_details&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">gcp_details</span>
</span><span id="BaseClient-206"><a href="#BaseClient-206"><span class="linenos">206</span></a>        <span class="k">if</span> <span class="s2">&quot;gcp_project_id_mappings&quot;</span> <span class="ow">in</span> <span class="n">config</span><span class="p">:</span>
</span><span id="BaseClient-207"><a href="#BaseClient-207"><span class="linenos">207</span></a>            <span class="n">gcp_project_id_mappings</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">items</span><span class="p">(</span><span class="s2">&quot;gcp_project_id_mappings&quot;</span><span class="p">))</span>
</span><span id="BaseClient-208"><a href="#BaseClient-208"><span class="linenos">208</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">mappings</span><span class="p">[</span><span class="s2">&quot;gcp_project_id_mappings&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">gcp_project_id_mappings</span>
</span><span id="BaseClient-209"><a href="#BaseClient-209"><span class="linenos">209</span></a>        <span class="k">if</span> <span class="s2">&quot;service_json_mappings&quot;</span> <span class="ow">in</span> <span class="n">config</span><span class="p">:</span>
</span><span id="BaseClient-210"><a href="#BaseClient-210"><span class="linenos">210</span></a>            <span class="n">service_json_mappings</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">items</span><span class="p">(</span><span class="s2">&quot;service_json_mappings&quot;</span><span class="p">))</span>
</span><span id="BaseClient-211"><a href="#BaseClient-211"><span class="linenos">211</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">mappings</span><span class="p">[</span><span class="s2">&quot;service_json_mappings&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">service_json_mappings</span>
</span><span id="BaseClient-212"><a href="#BaseClient-212"><span class="linenos">212</span></a>        <span class="k">if</span> <span class="s2">&quot;table_group_compute_mappings&quot;</span> <span class="ow">in</span> <span class="n">config</span><span class="p">:</span>
</span><span id="BaseClient-213"><a href="#BaseClient-213"><span class="linenos">213</span></a>            <span class="n">table_group_compute_mappings</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">items</span><span class="p">(</span><span class="s2">&quot;table_group_compute_mappings&quot;</span><span class="p">))</span>
</span><span id="BaseClient-214"><a href="#BaseClient-214"><span class="linenos">214</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">mappings</span><span class="p">[</span><span class="s2">&quot;table_group_compute_mappings&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">table_group_compute_mappings</span>
</span><span id="BaseClient-215"><a href="#BaseClient-215"><span class="linenos">215</span></a>        <span class="k">if</span> <span class="s2">&quot;kms&quot;</span> <span class="ow">in</span> <span class="n">config</span><span class="p">:</span>
</span><span id="BaseClient-216"><a href="#BaseClient-216"><span class="linenos">216</span></a>            <span class="n">kms</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">items</span><span class="p">(</span><span class="s2">&quot;kms&quot;</span><span class="p">))</span>
</span><span id="BaseClient-217"><a href="#BaseClient-217"><span class="linenos">217</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">mappings</span><span class="p">[</span><span class="s2">&quot;kms&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kms</span>
</span><span id="BaseClient-218"><a href="#BaseClient-218"><span class="linenos">218</span></a>
</span><span id="BaseClient-219"><a href="#BaseClient-219"><span class="linenos">219</span></a>    <span class="k">def</span> <span class="nf">_topological_sort_grouping</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">g</span><span class="p">):</span>
</span><span id="BaseClient-220"><a href="#BaseClient-220"><span class="linenos">220</span></a>        <span class="c1"># copy the graph</span>
</span><span id="BaseClient-221"><a href="#BaseClient-221"><span class="linenos">221</span></a>        <span class="n">_g</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="BaseClient-222"><a href="#BaseClient-222"><span class="linenos">222</span></a>        <span class="n">res</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="BaseClient-223"><a href="#BaseClient-223"><span class="linenos">223</span></a>        <span class="c1"># while _g is not empty</span>
</span><span id="BaseClient-224"><a href="#BaseClient-224"><span class="linenos">224</span></a>        <span class="k">while</span> <span class="n">_g</span><span class="p">:</span>
</span><span id="BaseClient-225"><a href="#BaseClient-225"><span class="linenos">225</span></a>            <span class="n">zero_indegree</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span> <span class="k">for</span> <span class="n">v</span><span class="p">,</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">_g</span><span class="o">.</span><span class="n">in_degree</span><span class="p">()</span> <span class="k">if</span> <span class="n">d</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span>
</span><span id="BaseClient-226"><a href="#BaseClient-226"><span class="linenos">226</span></a>            <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">zero_indegree</span><span class="p">)</span>
</span><span id="BaseClient-227"><a href="#BaseClient-227"><span class="linenos">227</span></a>            <span class="n">_g</span><span class="o">.</span><span class="n">remove_nodes_from</span><span class="p">(</span><span class="n">zero_indegree</span><span class="p">)</span>
</span><span id="BaseClient-228"><a href="#BaseClient-228"><span class="linenos">228</span></a>        <span class="k">return</span> <span class="n">res</span>
</span><span id="BaseClient-229"><a href="#BaseClient-229"><span class="linenos">229</span></a>
</span><span id="BaseClient-230"><a href="#BaseClient-230"><span class="linenos">230</span></a>    <span class="k">def</span> <span class="nf">get_all_secrets</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">secret_type</span><span class="p">,</span> <span class="n">ini_config_file_path</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">keys</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="BaseClient-231"><a href="#BaseClient-231"><span class="linenos">231</span></a>        <span class="c1"># Read all secrets from file and load inmemory</span>
</span><span id="BaseClient-232"><a href="#BaseClient-232"><span class="linenos">232</span></a>        <span class="c1"># Encrypt using infoworks encoding</span>
</span><span id="BaseClient-233"><a href="#BaseClient-233"><span class="linenos">233</span></a>        <span class="k">if</span> <span class="n">secret_type</span> <span class="o">==</span> <span class="s2">&quot;gcp_kms&quot;</span> <span class="ow">and</span> <span class="n">ini_config_file_path</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="BaseClient-234"><a href="#BaseClient-234"><span class="linenos">234</span></a>            <span class="n">config</span> <span class="o">=</span> <span class="n">ConfigParser</span><span class="p">()</span>
</span><span id="BaseClient-235"><a href="#BaseClient-235"><span class="linenos">235</span></a>            <span class="n">config</span><span class="o">.</span><span class="n">optionxform</span> <span class="o">=</span> <span class="nb">str</span>
</span><span id="BaseClient-236"><a href="#BaseClient-236"><span class="linenos">236</span></a>            <span class="n">config</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">ini_config_file_path</span><span class="p">)</span>
</span><span id="BaseClient-237"><a href="#BaseClient-237"><span class="linenos">237</span></a>            <span class="c1"># Cloud KMS CryptoKey Encrypter</span>
</span><span id="BaseClient-238"><a href="#BaseClient-238"><span class="linenos">238</span></a>            <span class="n">service_json_path</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;gcp_kms&quot;</span><span class="p">,</span> <span class="s2">&quot;service_json_path&quot;</span><span class="p">)</span>
</span><span id="BaseClient-239"><a href="#BaseClient-239"><span class="linenos">239</span></a>            <span class="c1"># Reading Config Parameters</span>
</span><span id="BaseClient-240"><a href="#BaseClient-240"><span class="linenos">240</span></a>            <span class="n">projectId</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;gcp_kms&quot;</span><span class="p">,</span> <span class="s2">&quot;projectId&quot;</span><span class="p">)</span>
</span><span id="BaseClient-241"><a href="#BaseClient-241"><span class="linenos">241</span></a>            <span class="n">locationId</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;gcp_kms&quot;</span><span class="p">,</span> <span class="s2">&quot;locationId&quot;</span><span class="p">)</span>
</span><span id="BaseClient-242"><a href="#BaseClient-242"><span class="linenos">242</span></a>            <span class="n">keyRingId</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;gcp_kms&quot;</span><span class="p">,</span> <span class="s2">&quot;keyRingId&quot;</span><span class="p">)</span>
</span><span id="BaseClient-243"><a href="#BaseClient-243"><span class="linenos">243</span></a>            <span class="n">keyId</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;gcp_kms&quot;</span><span class="p">,</span> <span class="s2">&quot;keyId&quot;</span><span class="p">)</span>
</span><span id="BaseClient-244"><a href="#BaseClient-244"><span class="linenos">244</span></a>            <span class="n">bucketName</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;gcp_kms&quot;</span><span class="p">,</span> <span class="s2">&quot;bucketName&quot;</span><span class="p">)</span>
</span><span id="BaseClient-245"><a href="#BaseClient-245"><span class="linenos">245</span></a>            <span class="n">blobName</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;gcp_kms&quot;</span><span class="p">,</span> <span class="s2">&quot;encrypted_key_filename&quot;</span><span class="p">)</span>
</span><span id="BaseClient-246"><a href="#BaseClient-246"><span class="linenos">246</span></a>            <span class="c1"># Reading Encrypted Password File from Cloud Storage</span>
</span><span id="BaseClient-247"><a href="#BaseClient-247"><span class="linenos">247</span></a>            <span class="n">storageClient</span> <span class="o">=</span> <span class="n">storage</span><span class="o">.</span><span class="n">Client</span><span class="o">.</span><span class="n">from_service_account_json</span><span class="p">(</span><span class="n">service_json_path</span><span class="p">)</span>
</span><span id="BaseClient-248"><a href="#BaseClient-248"><span class="linenos">248</span></a>            <span class="n">bucket</span> <span class="o">=</span> <span class="n">storageClient</span><span class="o">.</span><span class="n">get_bucket</span><span class="p">(</span><span class="n">bucketName</span><span class="p">)</span>
</span><span id="BaseClient-249"><a href="#BaseClient-249"><span class="linenos">249</span></a>            <span class="n">blobFile</span> <span class="o">=</span> <span class="n">bucket</span><span class="o">.</span><span class="n">get_blob</span><span class="p">(</span><span class="n">blobName</span><span class="p">)</span>
</span><span id="BaseClient-250"><a href="#BaseClient-250"><span class="linenos">250</span></a>            <span class="n">cipherText</span> <span class="o">=</span> <span class="n">blobFile</span><span class="o">.</span><span class="n">download_as_string</span><span class="p">()</span>
</span><span id="BaseClient-251"><a href="#BaseClient-251"><span class="linenos">251</span></a>            <span class="n">kmsClient</span> <span class="o">=</span> <span class="n">kms</span><span class="o">.</span><span class="n">KeyManagementServiceClient</span><span class="o">.</span><span class="n">from_service_account_json</span><span class="p">(</span><span class="n">service_json_path</span><span class="p">)</span>
</span><span id="BaseClient-252"><a href="#BaseClient-252"><span class="linenos">252</span></a>            <span class="n">keyName</span> <span class="o">=</span> <span class="n">kmsClient</span><span class="o">.</span><span class="n">crypto_key_path</span><span class="p">(</span><span class="n">projectId</span><span class="p">,</span> <span class="n">locationId</span><span class="p">,</span> <span class="n">keyRingId</span><span class="p">,</span> <span class="n">keyId</span><span class="p">)</span>
</span><span id="BaseClient-253"><a href="#BaseClient-253"><span class="linenos">253</span></a>            <span class="c1"># Decrypt Password</span>
</span><span id="BaseClient-254"><a href="#BaseClient-254"><span class="linenos">254</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="BaseClient-255"><a href="#BaseClient-255"><span class="linenos">255</span></a>                <span class="n">decryptPassword</span> <span class="o">=</span> <span class="n">kmsClient</span><span class="o">.</span><span class="n">decrypt</span><span class="p">(</span><span class="n">request</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="n">keyName</span><span class="p">,</span> <span class="s1">&#39;ciphertext&#39;</span><span class="p">:</span> <span class="n">cipherText</span><span class="p">})</span>
</span><span id="BaseClient-256"><a href="#BaseClient-256"><span class="linenos">256</span></a>                <span class="n">plainText</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">decryptPassword</span><span class="o">.</span><span class="n">plaintext</span><span class="p">,</span> <span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>
</span><span id="BaseClient-257"><a href="#BaseClient-257"><span class="linenos">257</span></a>                <span class="n">plainTextStr</span> <span class="o">=</span> <span class="n">plainText</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span><span id="BaseClient-258"><a href="#BaseClient-258"><span class="linenos">258</span></a>                <span class="n">passwordsDictPlain</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">plainTextStr</span><span class="p">)</span>
</span><span id="BaseClient-259"><a href="#BaseClient-259"><span class="linenos">259</span></a>                <span class="n">passwordsDictEncrypted</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="BaseClient-260"><a href="#BaseClient-260"><span class="linenos">260</span></a>                <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">passwordsDictPlain</span><span class="p">:</span>
</span><span id="BaseClient-261"><a href="#BaseClient-261"><span class="linenos">261</span></a>                    <span class="n">passwordsDictEncrypted</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">aes_encrypt</span><span class="p">(</span><span class="n">passwordsDictPlain</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
</span><span id="BaseClient-262"><a href="#BaseClient-262"><span class="linenos">262</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">secrets_config</span> <span class="o">=</span> <span class="n">passwordsDictEncrypted</span>
</span><span id="BaseClient-263"><a href="#BaseClient-263"><span class="linenos">263</span></a>            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="BaseClient-264"><a href="#BaseClient-264"><span class="linenos">264</span></a>                <span class="nb">print</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
</span><span id="BaseClient-265"><a href="#BaseClient-265"><span class="linenos">265</span></a>                <span class="k">return</span> <span class="s2">&quot;&quot;</span>
</span><span id="BaseClient-266"><a href="#BaseClient-266"><span class="linenos">266</span></a>        <span class="k">elif</span> <span class="n">secret_type</span> <span class="o">==</span> <span class="s2">&quot;aws_kms&quot;</span> <span class="ow">and</span> <span class="n">ini_config_file_path</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="BaseClient-267"><a href="#BaseClient-267"><span class="linenos">267</span></a>            <span class="n">config</span> <span class="o">=</span> <span class="n">ConfigParser</span><span class="p">()</span>
</span><span id="BaseClient-268"><a href="#BaseClient-268"><span class="linenos">268</span></a>            <span class="n">config</span><span class="o">.</span><span class="n">optionxform</span> <span class="o">=</span> <span class="nb">str</span>
</span><span id="BaseClient-269"><a href="#BaseClient-269"><span class="linenos">269</span></a>            <span class="n">config</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">ini_config_file_path</span><span class="p">)</span>
</span><span id="BaseClient-270"><a href="#BaseClient-270"><span class="linenos">270</span></a>            <span class="c1"># Read the encrypted file into memory</span>
</span><span id="BaseClient-271"><a href="#BaseClient-271"><span class="linenos">271</span></a>            <span class="n">encrypted_filename</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;aws_kms&quot;</span><span class="p">,</span> <span class="s2">&quot;encrypted_filename&quot;</span><span class="p">)</span>
</span><span id="BaseClient-272"><a href="#BaseClient-272"><span class="linenos">272</span></a>            <span class="n">available_keys</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">items</span><span class="p">(</span><span class="s2">&quot;aws_kms&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
</span><span id="BaseClient-273"><a href="#BaseClient-273"><span class="linenos">273</span></a>            <span class="k">if</span> <span class="s2">&quot;access_id&quot;</span> <span class="ow">in</span> <span class="n">available_keys</span> <span class="ow">and</span> <span class="s2">&quot;secret_key&quot;</span> <span class="ow">in</span> <span class="n">available_keys</span><span class="p">:</span>
</span><span id="BaseClient-274"><a href="#BaseClient-274"><span class="linenos">274</span></a>                <span class="n">ACCESS_KEY</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;aws_kms&quot;</span><span class="p">,</span> <span class="s2">&quot;access_id&quot;</span><span class="p">)</span>
</span><span id="BaseClient-275"><a href="#BaseClient-275"><span class="linenos">275</span></a>                <span class="n">SECRET_KEY</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;aws_kms&quot;</span><span class="p">,</span> <span class="s2">&quot;secret_key&quot;</span><span class="p">)</span>
</span><span id="BaseClient-276"><a href="#BaseClient-276"><span class="linenos">276</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="BaseClient-277"><a href="#BaseClient-277"><span class="linenos">277</span></a>                <span class="n">ACCESS_KEY</span><span class="p">,</span> <span class="n">SECRET_KEY</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>
</span><span id="BaseClient-278"><a href="#BaseClient-278"><span class="linenos">278</span></a>            <span class="c1"># Read</span>
</span><span id="BaseClient-279"><a href="#BaseClient-279"><span class="linenos">279</span></a>            <span class="n">NUM_BYTES_FOR_LEN</span> <span class="o">=</span> <span class="mi">4</span>
</span><span id="BaseClient-280"><a href="#BaseClient-280"><span class="linenos">280</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="BaseClient-281"><a href="#BaseClient-281"><span class="linenos">281</span></a>                <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">encrypted_filename</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
</span><span id="BaseClient-282"><a href="#BaseClient-282"><span class="linenos">282</span></a>                    <span class="n">file_contents</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span><span id="BaseClient-283"><a href="#BaseClient-283"><span class="linenos">283</span></a>            <span class="k">except</span> <span class="ne">IOError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="BaseClient-284"><a href="#BaseClient-284"><span class="linenos">284</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
</span><span id="BaseClient-285"><a href="#BaseClient-285"><span class="linenos">285</span></a>                <span class="k">return</span> <span class="kc">False</span>
</span><span id="BaseClient-286"><a href="#BaseClient-286"><span class="linenos">286</span></a>            <span class="n">data_key_encrypted_len</span> <span class="o">=</span> <span class="nb">int</span><span class="o">.</span><span class="n">from_bytes</span><span class="p">(</span><span class="n">file_contents</span><span class="p">[:</span><span class="n">NUM_BYTES_FOR_LEN</span><span class="p">],</span>
</span><span id="BaseClient-287"><a href="#BaseClient-287"><span class="linenos">287</span></a>                                                    <span class="n">byteorder</span><span class="o">=</span><span class="s1">&#39;big&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="n">NUM_BYTES_FOR_LEN</span>
</span><span id="BaseClient-288"><a href="#BaseClient-288"><span class="linenos">288</span></a>            <span class="n">data_key_encrypted</span> <span class="o">=</span> <span class="n">file_contents</span><span class="p">[</span><span class="n">NUM_BYTES_FOR_LEN</span><span class="p">:</span><span class="n">data_key_encrypted_len</span><span class="p">]</span>
</span><span id="BaseClient-289"><a href="#BaseClient-289"><span class="linenos">289</span></a>            <span class="c1"># Decrypt the data key before using it</span>
</span><span id="BaseClient-290"><a href="#BaseClient-290"><span class="linenos">290</span></a>            <span class="k">if</span> <span class="n">ACCESS_KEY</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">SECRET_KEY</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="BaseClient-291"><a href="#BaseClient-291"><span class="linenos">291</span></a>                <span class="n">kms_client</span> <span class="o">=</span> <span class="n">boto3</span><span class="o">.</span><span class="n">client</span><span class="p">(</span><span class="s1">&#39;kms&#39;</span><span class="p">,</span> <span class="n">aws_access_key_id</span><span class="o">=</span><span class="n">ACCESS_KEY</span><span class="p">,</span> <span class="n">aws_secret_access_key</span><span class="o">=</span><span class="n">SECRET_KEY</span><span class="p">)</span>
</span><span id="BaseClient-292"><a href="#BaseClient-292"><span class="linenos">292</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="BaseClient-293"><a href="#BaseClient-293"><span class="linenos">293</span></a>                <span class="n">kms_client</span> <span class="o">=</span> <span class="n">boto3</span><span class="o">.</span><span class="n">client</span><span class="p">(</span><span class="s1">&#39;kms&#39;</span><span class="p">)</span>
</span><span id="BaseClient-294"><a href="#BaseClient-294"><span class="linenos">294</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="BaseClient-295"><a href="#BaseClient-295"><span class="linenos">295</span></a>                <span class="n">response</span> <span class="o">=</span> <span class="n">kms_client</span><span class="o">.</span><span class="n">decrypt</span><span class="p">(</span><span class="n">CiphertextBlob</span><span class="o">=</span><span class="n">data_key_encrypted</span><span class="p">)</span>
</span><span id="BaseClient-296"><a href="#BaseClient-296"><span class="linenos">296</span></a>                <span class="n">data_key_plaintext</span> <span class="o">=</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64encode</span><span class="p">((</span><span class="n">response</span><span class="p">[</span><span class="s1">&#39;Plaintext&#39;</span><span class="p">]))</span>
</span><span id="BaseClient-297"><a href="#BaseClient-297"><span class="linenos">297</span></a>            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="BaseClient-298"><a href="#BaseClient-298"><span class="linenos">298</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
</span><span id="BaseClient-299"><a href="#BaseClient-299"><span class="linenos">299</span></a>                <span class="k">return</span> <span class="kc">False</span>
</span><span id="BaseClient-300"><a href="#BaseClient-300"><span class="linenos">300</span></a>
</span><span id="BaseClient-301"><a href="#BaseClient-301"><span class="linenos">301</span></a>            <span class="k">if</span> <span class="n">data_key_plaintext</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="BaseClient-302"><a href="#BaseClient-302"><span class="linenos">302</span></a>                <span class="k">return</span> <span class="kc">False</span>
</span><span id="BaseClient-303"><a href="#BaseClient-303"><span class="linenos">303</span></a>            <span class="c1"># Decrypt the rest of the file</span>
</span><span id="BaseClient-304"><a href="#BaseClient-304"><span class="linenos">304</span></a>            <span class="n">f</span> <span class="o">=</span> <span class="n">Fernet</span><span class="p">(</span><span class="n">data_key_plaintext</span><span class="p">)</span>
</span><span id="BaseClient-305"><a href="#BaseClient-305"><span class="linenos">305</span></a>            <span class="n">file_contents_decrypted</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">decrypt</span><span class="p">(</span><span class="n">file_contents</span><span class="p">[</span><span class="n">data_key_encrypted_len</span><span class="p">:])</span>
</span><span id="BaseClient-306"><a href="#BaseClient-306"><span class="linenos">306</span></a>            <span class="n">passwordsDictPlain</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">file_contents_decrypted</span><span class="p">)</span>
</span><span id="BaseClient-307"><a href="#BaseClient-307"><span class="linenos">307</span></a>            <span class="n">passwordsDictEncrypted</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="BaseClient-308"><a href="#BaseClient-308"><span class="linenos">308</span></a>            <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">passwordsDictPlain</span><span class="p">:</span>
</span><span id="BaseClient-309"><a href="#BaseClient-309"><span class="linenos">309</span></a>                <span class="n">passwordsDictEncrypted</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">aes_encrypt</span><span class="p">(</span><span class="n">passwordsDictPlain</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
</span><span id="BaseClient-310"><a href="#BaseClient-310"><span class="linenos">310</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">secrets_config</span> <span class="o">=</span> <span class="n">passwordsDictEncrypted</span>
</span><span id="BaseClient-311"><a href="#BaseClient-311"><span class="linenos">311</span></a>            <span class="k">return</span> <span class="kc">True</span>
</span><span id="BaseClient-312"><a href="#BaseClient-312"><span class="linenos">312</span></a>        <span class="k">elif</span> <span class="n">secret_type</span> <span class="o">==</span> <span class="s2">&quot;aws_secrets&quot;</span><span class="p">:</span>
</span><span id="BaseClient-313"><a href="#BaseClient-313"><span class="linenos">313</span></a>            <span class="n">ACCESS_KEY</span><span class="p">,</span> <span class="n">SECRET_KEY</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>
</span><span id="BaseClient-314"><a href="#BaseClient-314"><span class="linenos">314</span></a>            <span class="n">region</span> <span class="o">=</span> <span class="s1">&#39;us-west-2&#39;</span>
</span><span id="BaseClient-315"><a href="#BaseClient-315"><span class="linenos">315</span></a>            <span class="k">if</span> <span class="n">ini_config_file_path</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="BaseClient-316"><a href="#BaseClient-316"><span class="linenos">316</span></a>                <span class="n">config</span> <span class="o">=</span> <span class="n">ConfigParser</span><span class="p">()</span>
</span><span id="BaseClient-317"><a href="#BaseClient-317"><span class="linenos">317</span></a>                <span class="n">config</span><span class="o">.</span><span class="n">optionxform</span> <span class="o">=</span> <span class="nb">str</span>
</span><span id="BaseClient-318"><a href="#BaseClient-318"><span class="linenos">318</span></a>                <span class="n">config</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">ini_config_file_path</span><span class="p">)</span>
</span><span id="BaseClient-319"><a href="#BaseClient-319"><span class="linenos">319</span></a>                <span class="n">available_keys</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">items</span><span class="p">(</span><span class="s2">&quot;aws_secrets&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
</span><span id="BaseClient-320"><a href="#BaseClient-320"><span class="linenos">320</span></a>                <span class="k">if</span> <span class="s2">&quot;access_id&quot;</span> <span class="ow">in</span> <span class="n">available_keys</span> <span class="ow">and</span> <span class="s2">&quot;secret_key&quot;</span> <span class="ow">in</span> <span class="n">available_keys</span><span class="p">:</span>
</span><span id="BaseClient-321"><a href="#BaseClient-321"><span class="linenos">321</span></a>                    <span class="n">ACCESS_KEY</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;aws_secrets&quot;</span><span class="p">,</span> <span class="s2">&quot;access_id&quot;</span><span class="p">)</span>
</span><span id="BaseClient-322"><a href="#BaseClient-322"><span class="linenos">322</span></a>                    <span class="n">SECRET_KEY</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;aws_secrets&quot;</span><span class="p">,</span> <span class="s2">&quot;secret_key&quot;</span><span class="p">)</span>
</span><span id="BaseClient-323"><a href="#BaseClient-323"><span class="linenos">323</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="BaseClient-324"><a href="#BaseClient-324"><span class="linenos">324</span></a>                    <span class="n">ACCESS_KEY</span><span class="p">,</span> <span class="n">SECRET_KEY</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>
</span><span id="BaseClient-325"><a href="#BaseClient-325"><span class="linenos">325</span></a>                <span class="k">if</span> <span class="s2">&quot;region&quot;</span> <span class="ow">in</span> <span class="n">available_keys</span><span class="p">:</span>
</span><span id="BaseClient-326"><a href="#BaseClient-326"><span class="linenos">326</span></a>                    <span class="n">region</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;aws_secrets&quot;</span><span class="p">,</span> <span class="s2">&quot;region&quot;</span><span class="p">)</span>
</span><span id="BaseClient-327"><a href="#BaseClient-327"><span class="linenos">327</span></a>            <span class="k">if</span> <span class="n">keys</span><span class="p">:</span>
</span><span id="BaseClient-328"><a href="#BaseClient-328"><span class="linenos">328</span></a>                <span class="n">output_values</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="BaseClient-329"><a href="#BaseClient-329"><span class="linenos">329</span></a>                <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">keys</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">):</span>
</span><span id="BaseClient-330"><a href="#BaseClient-330"><span class="linenos">330</span></a>                    <span class="n">secrets_client</span> <span class="o">=</span> <span class="n">boto3</span><span class="o">.</span><span class="n">client</span><span class="p">(</span><span class="s2">&quot;secretsmanager&quot;</span><span class="p">,</span> <span class="n">region_name</span><span class="o">=</span><span class="n">region</span><span class="p">)</span>
</span><span id="BaseClient-331"><a href="#BaseClient-331"><span class="linenos">331</span></a>                    <span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;SecretId&#39;</span><span class="p">:</span> <span class="n">key</span><span class="p">}</span>
</span><span id="BaseClient-332"><a href="#BaseClient-332"><span class="linenos">332</span></a>                    <span class="k">try</span><span class="p">:</span>
</span><span id="BaseClient-333"><a href="#BaseClient-333"><span class="linenos">333</span></a>                        <span class="n">value</span> <span class="o">=</span> <span class="n">secrets_client</span><span class="o">.</span><span class="n">get_secret_value</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)[</span><span class="s2">&quot;SecretString&quot;</span><span class="p">]</span>
</span><span id="BaseClient-334"><a href="#BaseClient-334"><span class="linenos">334</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">secrets_config</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="BaseClient-335"><a href="#BaseClient-335"><span class="linenos">335</span></a>                        <span class="n">output_values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="BaseClient-336"><a href="#BaseClient-336"><span class="linenos">336</span></a>                    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="BaseClient-337"><a href="#BaseClient-337"><span class="linenos">337</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
</span><span id="BaseClient-338"><a href="#BaseClient-338"><span class="linenos">338</span></a>                <span class="k">return</span> <span class="n">output_values</span>
</span><span id="BaseClient-339"><a href="#BaseClient-339"><span class="linenos">339</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="BaseClient-340"><a href="#BaseClient-340"><span class="linenos">340</span></a>                <span class="c1"># Get all the secrets</span>
</span><span id="BaseClient-341"><a href="#BaseClient-341"><span class="linenos">341</span></a>                <span class="k">if</span> <span class="n">ACCESS_KEY</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">SECRET_KEY</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="BaseClient-342"><a href="#BaseClient-342"><span class="linenos">342</span></a>                    <span class="n">secrets_client</span> <span class="o">=</span> <span class="n">boto3</span><span class="o">.</span><span class="n">client</span><span class="p">(</span><span class="s2">&quot;secretsmanager&quot;</span><span class="p">,</span> <span class="n">aws_access_key_id</span><span class="o">=</span><span class="n">ACCESS_KEY</span><span class="p">,</span>
</span><span id="BaseClient-343"><a href="#BaseClient-343"><span class="linenos">343</span></a>                                                  <span class="n">aws_secret_access_key</span><span class="o">=</span><span class="n">SECRET_KEY</span><span class="p">,</span> <span class="n">region</span><span class="o">=</span><span class="n">region</span><span class="p">)</span>
</span><span id="BaseClient-344"><a href="#BaseClient-344"><span class="linenos">344</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="BaseClient-345"><a href="#BaseClient-345"><span class="linenos">345</span></a>                    <span class="n">secrets_client</span> <span class="o">=</span> <span class="n">boto3</span><span class="o">.</span><span class="n">client</span><span class="p">(</span><span class="s2">&quot;secretsmanager&quot;</span><span class="p">,</span><span class="n">region</span><span class="o">=</span><span class="n">region</span><span class="p">)</span>
</span><span id="BaseClient-346"><a href="#BaseClient-346"><span class="linenos">346</span></a>                <span class="n">temp</span> <span class="o">=</span> <span class="n">secrets_client</span><span class="o">.</span><span class="n">list_secrets</span><span class="p">()[</span><span class="s2">&quot;SecretList&quot;</span><span class="p">]</span>
</span><span id="BaseClient-347"><a href="#BaseClient-347"><span class="linenos">347</span></a>                <span class="n">all_secrets</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="p">[</span><span class="s2">&quot;Name&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">temp</span><span class="p">]</span>
</span><span id="BaseClient-348"><a href="#BaseClient-348"><span class="linenos">348</span></a>                <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">all_secrets</span><span class="p">:</span>
</span><span id="BaseClient-349"><a href="#BaseClient-349"><span class="linenos">349</span></a>                    <span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;SecretId&#39;</span><span class="p">:</span> <span class="n">key</span><span class="p">}</span>
</span><span id="BaseClient-350"><a href="#BaseClient-350"><span class="linenos">350</span></a>                    <span class="k">try</span><span class="p">:</span>
</span><span id="BaseClient-351"><a href="#BaseClient-351"><span class="linenos">351</span></a>                        <span class="n">value</span> <span class="o">=</span> <span class="n">secrets_client</span><span class="o">.</span><span class="n">get_secret_value</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)[</span><span class="s2">&quot;SecretString&quot;</span><span class="p">]</span>
</span><span id="BaseClient-352"><a href="#BaseClient-352"><span class="linenos">352</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">secrets_config</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="BaseClient-353"><a href="#BaseClient-353"><span class="linenos">353</span></a>                    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="BaseClient-354"><a href="#BaseClient-354"><span class="linenos">354</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
</span><span id="BaseClient-355"><a href="#BaseClient-355"><span class="linenos">355</span></a>        <span class="k">elif</span> <span class="n">secret_type</span> <span class="o">==</span> <span class="s2">&quot;azure_keyvault&quot;</span><span class="p">:</span>
</span><span id="BaseClient-356"><a href="#BaseClient-356"><span class="linenos">356</span></a>            <span class="kn">from</span> <span class="nn">azure.keyvault.secrets</span> <span class="kn">import</span> <span class="n">SecretClient</span>
</span><span id="BaseClient-357"><a href="#BaseClient-357"><span class="linenos">357</span></a>            <span class="kn">from</span> <span class="nn">azure.identity</span> <span class="kn">import</span> <span class="n">ClientSecretCredential</span>
</span><span id="BaseClient-358"><a href="#BaseClient-358"><span class="linenos">358</span></a>            <span class="n">config</span> <span class="o">=</span> <span class="n">ConfigParser</span><span class="p">()</span>
</span><span id="BaseClient-359"><a href="#BaseClient-359"><span class="linenos">359</span></a>            <span class="n">config</span><span class="o">.</span><span class="n">optionxform</span> <span class="o">=</span> <span class="nb">str</span>
</span><span id="BaseClient-360"><a href="#BaseClient-360"><span class="linenos">360</span></a>            <span class="n">config</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">ini_config_file_path</span><span class="p">)</span>
</span><span id="BaseClient-361"><a href="#BaseClient-361"><span class="linenos">361</span></a>            <span class="c1"># Read the encrypted file into memory</span>
</span><span id="BaseClient-362"><a href="#BaseClient-362"><span class="linenos">362</span></a>            <span class="n">available_keys</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">items</span><span class="p">(</span><span class="s2">&quot;azure_keyvault&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
</span><span id="BaseClient-363"><a href="#BaseClient-363"><span class="linenos">363</span></a>            <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="n">x</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;keyVaultName&#39;</span><span class="p">,</span> <span class="s1">&#39;tenant_id&#39;</span><span class="p">,</span> <span class="s1">&#39;client_id&#39;</span><span class="p">,</span> <span class="s1">&#39;client_secret&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">available_keys</span><span class="p">):</span>
</span><span id="BaseClient-364"><a href="#BaseClient-364"><span class="linenos">364</span></a>                <span class="n">keyVaultName</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;azure_keyvault&quot;</span><span class="p">,</span> <span class="s2">&quot;keyVaultName&quot;</span><span class="p">)</span>
</span><span id="BaseClient-365"><a href="#BaseClient-365"><span class="linenos">365</span></a>                <span class="n">KVUri</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;https://</span><span class="si">{</span><span class="n">keyVaultName</span><span class="si">}</span><span class="s2">.vault.azure.net&quot;</span>
</span><span id="BaseClient-366"><a href="#BaseClient-366"><span class="linenos">366</span></a>                <span class="n">tenant_id</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;azure_keyvault&quot;</span><span class="p">,</span> <span class="s2">&quot;tenant_id&quot;</span><span class="p">)</span>
</span><span id="BaseClient-367"><a href="#BaseClient-367"><span class="linenos">367</span></a>                <span class="n">client_id</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;azure_keyvault&quot;</span><span class="p">,</span> <span class="s2">&quot;client_id&quot;</span><span class="p">)</span>
</span><span id="BaseClient-368"><a href="#BaseClient-368"><span class="linenos">368</span></a>                <span class="n">client_secret</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;azure_keyvault&quot;</span><span class="p">,</span> <span class="s2">&quot;client_secret&quot;</span><span class="p">)</span>
</span><span id="BaseClient-369"><a href="#BaseClient-369"><span class="linenos">369</span></a>                <span class="n">credential</span> <span class="o">=</span> <span class="n">ClientSecretCredential</span><span class="p">(</span><span class="n">tenant_id</span><span class="p">,</span> <span class="n">client_id</span><span class="p">,</span> <span class="n">client_secret</span><span class="p">)</span>
</span><span id="BaseClient-370"><a href="#BaseClient-370"><span class="linenos">370</span></a>                <span class="n">client</span> <span class="o">=</span> <span class="n">SecretClient</span><span class="p">(</span><span class="n">vault_url</span><span class="o">=</span><span class="n">KVUri</span><span class="p">,</span> <span class="n">credential</span><span class="o">=</span><span class="n">credential</span><span class="p">)</span>
</span><span id="BaseClient-371"><a href="#BaseClient-371"><span class="linenos">371</span></a>                <span class="k">if</span> <span class="n">keys</span><span class="p">:</span>
</span><span id="BaseClient-372"><a href="#BaseClient-372"><span class="linenos">372</span></a>                    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">keys</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">):</span>
</span><span id="BaseClient-373"><a href="#BaseClient-373"><span class="linenos">373</span></a>                        <span class="n">retrieved_secret</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">get_secret</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
</span><span id="BaseClient-374"><a href="#BaseClient-374"><span class="linenos">374</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">secrets_config</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">aes_encrypt</span><span class="p">(</span><span class="n">retrieved_secret</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
</span><span id="BaseClient-375"><a href="#BaseClient-375"><span class="linenos">375</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="BaseClient-376"><a href="#BaseClient-376"><span class="linenos">376</span></a>                    <span class="n">secret_properties</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">list_properties_of_secrets</span><span class="p">()</span>
</span><span id="BaseClient-377"><a href="#BaseClient-377"><span class="linenos">377</span></a>                    <span class="n">all_secrets</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">secret_properties</span><span class="p">]</span>
</span><span id="BaseClient-378"><a href="#BaseClient-378"><span class="linenos">378</span></a>                    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">all_secrets</span><span class="p">:</span>
</span><span id="BaseClient-379"><a href="#BaseClient-379"><span class="linenos">379</span></a>                        <span class="n">retrieved_secret</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">get_secret</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
</span><span id="BaseClient-380"><a href="#BaseClient-380"><span class="linenos">380</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">secrets_config</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">aes_encrypt</span><span class="p">(</span><span class="n">retrieved_secret</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
</span><span id="BaseClient-381"><a href="#BaseClient-381"><span class="linenos">381</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">secrets_config</span><span class="p">[</span><span class="s2">&quot;custom_secrets_read&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
</span></pre></div>

        </details>

    

                            <div id="BaseClient.__init__" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#BaseClient.__init__">#&nbsp;&nbsp</a>

        
            <span class="name">BaseClient</span><span class="signature">()</span>
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="BaseClient.__init__-45"><a href="#BaseClient.__init__-45"><span class="linenos">45</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="BaseClient.__init__-46"><a href="#BaseClient.__init__-46"><span class="linenos">46</span></a>        <span class="c1"># print(&quot;Inside BaseClient&quot;)</span>
</span><span id="BaseClient.__init__-47"><a href="#BaseClient.__init__-47"><span class="linenos">47</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">client_config</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="BaseClient.__init__-48"><a href="#BaseClient.__init__-48"><span class="linenos">48</span></a>            <span class="s1">&#39;protocol&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="BaseClient.__init__-49"><a href="#BaseClient.__init__-49"><span class="linenos">49</span></a>            <span class="s1">&#39;ip&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="BaseClient.__init__-50"><a href="#BaseClient.__init__-50"><span class="linenos">50</span></a>            <span class="s1">&#39;port&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="BaseClient.__init__-51"><a href="#BaseClient.__init__-51"><span class="linenos">51</span></a>            <span class="s1">&#39;refresh_token&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="BaseClient.__init__-52"><a href="#BaseClient.__init__-52"><span class="linenos">52</span></a>            <span class="s1">&#39;bearer_token&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="BaseClient.__init__-53"><a href="#BaseClient.__init__-53"><span class="linenos">53</span></a>            <span class="s1">&#39;default_environment_id&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="BaseClient.__init__-54"><a href="#BaseClient.__init__-54"><span class="linenos">54</span></a>            <span class="s1">&#39;default_storage_id&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="BaseClient.__init__-55"><a href="#BaseClient.__init__-55"><span class="linenos">55</span></a>            <span class="s1">&#39;default_compute_id&#39;</span><span class="p">:</span> <span class="kc">None</span>
</span><span id="BaseClient.__init__-56"><a href="#BaseClient.__init__-56"><span class="linenos">56</span></a>        <span class="p">}</span>
</span><span id="BaseClient.__init__-57"><a href="#BaseClient.__init__-57"><span class="linenos">57</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">secrets_config</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;custom_secrets_read&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">}</span>
</span><span id="BaseClient.__init__-58"><a href="#BaseClient.__init__-58"><span class="linenos">58</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">mappings</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="BaseClient.__init__-59"><a href="#BaseClient.__init__-59"><span class="linenos">59</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">http</span> <span class="o">=</span> <span class="n">initialise_http_client</span><span class="p">()</span>
</span><span id="BaseClient.__init__-60"><a href="#BaseClient.__init__-60"><span class="linenos">60</span></a>        <span class="n">log_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">local_configurations</span><span class="o">.</span><span class="n">LOG_LOCATION</span><span class="p">)</span>
</span><span id="BaseClient.__init__-61"><a href="#BaseClient.__init__-61"><span class="linenos">61</span></a>        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">log_path</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">absolute</span><span class="p">()):</span>
</span><span id="BaseClient.__init__-62"><a href="#BaseClient.__init__-62"><span class="linenos">62</span></a>            <span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="n">local_configurations</span><span class="o">.</span><span class="n">LOG_LOCATION</span><span class="p">,</span> <span class="n">filemode</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span>
</span><span id="BaseClient.__init__-63"><a href="#BaseClient.__init__-63"><span class="linenos">63</span></a>                                <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%(asctime)s</span><span class="s1"> - </span><span class="si">%(module)s</span><span class="s1"> - </span><span class="si">%(pathname)s</span><span class="s1"> - </span><span class="si">%(lineno)d</span><span class="s1"> - </span><span class="si">%(levelname)s</span><span class="s1"> - </span><span class="si">%(message)s</span><span class="s1">&#39;</span><span class="p">,</span>
</span><span id="BaseClient.__init__-64"><a href="#BaseClient.__init__-64"><span class="linenos">64</span></a>                                <span class="n">level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">DEBUG</span><span class="p">,</span> <span class="n">datefmt</span><span class="o">=</span><span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1"> %H:%M:%S&#39;</span><span class="p">)</span>
</span><span id="BaseClient.__init__-65"><a href="#BaseClient.__init__-65"><span class="linenos">65</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="BaseClient.__init__-66"><a href="#BaseClient.__init__-66"><span class="linenos">66</span></a>            <span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span>
</span><span id="BaseClient.__init__-67"><a href="#BaseClient.__init__-67"><span class="linenos">67</span></a>                <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%(asctime)s</span><span class="s1"> - </span><span class="si">%(module)s</span><span class="s1"> - </span><span class="si">%(pathname)s</span><span class="s1"> - </span><span class="si">%(lineno)d</span><span class="s1"> - </span><span class="si">%(levelname)s</span><span class="s1"> - </span><span class="si">%(message)s</span><span class="s1">&#39;</span><span class="p">,</span>
</span><span id="BaseClient.__init__-68"><a href="#BaseClient.__init__-68"><span class="linenos">68</span></a>                <span class="n">level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">DEBUG</span><span class="p">,</span> <span class="n">datefmt</span><span class="o">=</span><span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1"> %H:%M:%S&#39;</span><span class="p">)</span>
</span><span id="BaseClient.__init__-69"><a href="#BaseClient.__init__-69"><span class="linenos">69</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s1">&#39;infoworks_sdk_logs&#39;</span><span class="p">)</span>
</span></pre></div>

        </details>

    

                            </div>
                            <div id="BaseClient.initialize_client" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#BaseClient.initialize_client">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">initialize_client</span><span class="signature">(self, protocol=None, ip=None, port=None)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="BaseClient.initialize_client-71"><a href="#BaseClient.initialize_client-71"><span class="linenos">71</span></a>    <span class="k">def</span> <span class="nf">initialize_client</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">protocol</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ip</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="p">):</span>
</span><span id="BaseClient.initialize_client-72"><a href="#BaseClient.initialize_client-72"><span class="linenos">72</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="BaseClient.initialize_client-73"><a href="#BaseClient.initialize_client-73"><span class="linenos">73</span></a><span class="sd">        initialize the client</span>
</span><span id="BaseClient.initialize_client-74"><a href="#BaseClient.initialize_client-74"><span class="linenos">74</span></a><span class="sd">        :param protocol: protocol to be used for server call</span>
</span><span id="BaseClient.initialize_client-75"><a href="#BaseClient.initialize_client-75"><span class="linenos">75</span></a><span class="sd">        :type protocol: String</span>
</span><span id="BaseClient.initialize_client-76"><a href="#BaseClient.initialize_client-76"><span class="linenos">76</span></a><span class="sd">        :param ip: Client IP</span>
</span><span id="BaseClient.initialize_client-77"><a href="#BaseClient.initialize_client-77"><span class="linenos">77</span></a><span class="sd">        :type ip: String</span>
</span><span id="BaseClient.initialize_client-78"><a href="#BaseClient.initialize_client-78"><span class="linenos">78</span></a><span class="sd">        :param port: Client Port</span>
</span><span id="BaseClient.initialize_client-79"><a href="#BaseClient.initialize_client-79"><span class="linenos">79</span></a><span class="sd">        :type port: String</span>
</span><span id="BaseClient.initialize_client-80"><a href="#BaseClient.initialize_client-80"><span class="linenos">80</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="BaseClient.initialize_client-81"><a href="#BaseClient.initialize_client-81"><span class="linenos">81</span></a>
</span><span id="BaseClient.initialize_client-82"><a href="#BaseClient.initialize_client-82"><span class="linenos">82</span></a>        <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="n">v</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="p">[</span><span class="n">protocol</span><span class="p">,</span> <span class="n">ip</span><span class="p">,</span> <span class="n">port</span><span class="p">]):</span>
</span><span id="BaseClient.initialize_client-83"><a href="#BaseClient.initialize_client-83"><span class="linenos">83</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">client_config</span><span class="p">[</span><span class="s1">&#39;protocol&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">protocol</span>
</span><span id="BaseClient.initialize_client-84"><a href="#BaseClient.initialize_client-84"><span class="linenos">84</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">client_config</span><span class="p">[</span><span class="s1">&#39;ip&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ip</span>
</span><span id="BaseClient.initialize_client-85"><a href="#BaseClient.initialize_client-85"><span class="linenos">85</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">client_config</span><span class="p">[</span><span class="s1">&#39;port&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">port</span>
</span><span id="BaseClient.initialize_client-86"><a href="#BaseClient.initialize_client-86"><span class="linenos">86</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="BaseClient.initialize_client-87"><a href="#BaseClient.initialize_client-87"><span class="linenos">87</span></a>            <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Pass valid values&quot;</span><span class="p">))</span>
</span><span id="BaseClient.initialize_client-88"><a href="#BaseClient.initialize_client-88"><span class="linenos">88</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Pass valid values&quot;</span><span class="p">)</span>
</span></pre></div>

        </details>

            <div class="docstring"><p>initialize the client</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>protocol</strong>:  protocol to be used for server call</li>
<li><strong>ip</strong>:  Client IP</li>
<li><strong>port</strong>:  Client Port</li>
</ul>
</div>


                            </div>
                            <div id="BaseClient.initialize_client_with_defaults" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#BaseClient.initialize_client_with_defaults">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">initialize_client_with_defaults</span><span class="signature">(
    self,
    protocol,
    ip,
    port,
    refresh_token,
    default_environment_id=None,
    default_storage_id=None,
    default_compute_id=None
)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="BaseClient.initialize_client_with_defaults-90"><a href="#BaseClient.initialize_client_with_defaults-90"><span class="linenos"> 90</span></a>    <span class="k">def</span> <span class="nf">initialize_client_with_defaults</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">protocol</span><span class="p">,</span> <span class="n">ip</span><span class="p">,</span> <span class="n">port</span><span class="p">,</span> <span class="n">refresh_token</span><span class="p">,</span> <span class="n">default_environment_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="BaseClient.initialize_client_with_defaults-91"><a href="#BaseClient.initialize_client_with_defaults-91"><span class="linenos"> 91</span></a>                                        <span class="n">default_storage_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">default_compute_id</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="BaseClient.initialize_client_with_defaults-92"><a href="#BaseClient.initialize_client_with_defaults-92"><span class="linenos"> 92</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="BaseClient.initialize_client_with_defaults-93"><a href="#BaseClient.initialize_client_with_defaults-93"><span class="linenos"> 93</span></a><span class="sd">        initializes the client and a user with given configuration</span>
</span><span id="BaseClient.initialize_client_with_defaults-94"><a href="#BaseClient.initialize_client_with_defaults-94"><span class="linenos"> 94</span></a><span class="sd">        :param protocol: protocol to be used for server call</span>
</span><span id="BaseClient.initialize_client_with_defaults-95"><a href="#BaseClient.initialize_client_with_defaults-95"><span class="linenos"> 95</span></a><span class="sd">        :type protocol: String</span>
</span><span id="BaseClient.initialize_client_with_defaults-96"><a href="#BaseClient.initialize_client_with_defaults-96"><span class="linenos"> 96</span></a><span class="sd">        :param ip: ip address of the server</span>
</span><span id="BaseClient.initialize_client_with_defaults-97"><a href="#BaseClient.initialize_client_with_defaults-97"><span class="linenos"> 97</span></a><span class="sd">        :type ip: String</span>
</span><span id="BaseClient.initialize_client_with_defaults-98"><a href="#BaseClient.initialize_client_with_defaults-98"><span class="linenos"> 98</span></a><span class="sd">        :param port: port on which the rest service resides</span>
</span><span id="BaseClient.initialize_client_with_defaults-99"><a href="#BaseClient.initialize_client_with_defaults-99"><span class="linenos"> 99</span></a><span class="sd">        :type port: String</span>
</span><span id="BaseClient.initialize_client_with_defaults-100"><a href="#BaseClient.initialize_client_with_defaults-100"><span class="linenos">100</span></a><span class="sd">        :param refresh_token: refresh_token of the user</span>
</span><span id="BaseClient.initialize_client_with_defaults-101"><a href="#BaseClient.initialize_client_with_defaults-101"><span class="linenos">101</span></a><span class="sd">        :type refresh_token: String</span>
</span><span id="BaseClient.initialize_client_with_defaults-102"><a href="#BaseClient.initialize_client_with_defaults-102"><span class="linenos">102</span></a><span class="sd">        :param default_compute_id: Pass the default compute id to be used for all the artifacts to be created</span>
</span><span id="BaseClient.initialize_client_with_defaults-103"><a href="#BaseClient.initialize_client_with_defaults-103"><span class="linenos">103</span></a><span class="sd">        :param default_storage_id: Pass the default storage id to be used for all the artifacts to be created</span>
</span><span id="BaseClient.initialize_client_with_defaults-104"><a href="#BaseClient.initialize_client_with_defaults-104"><span class="linenos">104</span></a><span class="sd">        :param default_environment_id: Pass the default environment id to be used for all the artifacts to be created</span>
</span><span id="BaseClient.initialize_client_with_defaults-105"><a href="#BaseClient.initialize_client_with_defaults-105"><span class="linenos">105</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="BaseClient.initialize_client_with_defaults-106"><a href="#BaseClient.initialize_client_with_defaults-106"><span class="linenos">106</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">client_config</span><span class="p">[</span><span class="s1">&#39;refresh_token&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">refresh_token</span>
</span><span id="BaseClient.initialize_client_with_defaults-107"><a href="#BaseClient.initialize_client_with_defaults-107"><span class="linenos">107</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">client_config</span><span class="p">[</span><span class="s1">&#39;bearer_token&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_bearer_token</span><span class="p">(</span><span class="n">protocol</span><span class="p">,</span> <span class="n">ip</span><span class="p">,</span> <span class="n">port</span><span class="p">,</span> <span class="n">refresh_token</span><span class="p">)</span>
</span><span id="BaseClient.initialize_client_with_defaults-108"><a href="#BaseClient.initialize_client_with_defaults-108"><span class="linenos">108</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">initialize_client</span><span class="p">(</span><span class="n">protocol</span><span class="p">,</span> <span class="n">ip</span><span class="p">,</span> <span class="n">port</span><span class="p">)</span>
</span><span id="BaseClient.initialize_client_with_defaults-109"><a href="#BaseClient.initialize_client_with_defaults-109"><span class="linenos">109</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">client_config</span><span class="p">[</span>
</span><span id="BaseClient.initialize_client_with_defaults-110"><a href="#BaseClient.initialize_client_with_defaults-110"><span class="linenos">110</span></a>            <span class="s1">&#39;default_environment_id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">default_environment_id</span> <span class="k">if</span> <span class="n">default_environment_id</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span>
</span><span id="BaseClient.initialize_client_with_defaults-111"><a href="#BaseClient.initialize_client_with_defaults-111"><span class="linenos">111</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">client_config</span><span class="p">[</span><span class="s1">&#39;default_storage_id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">default_storage_id</span> <span class="k">if</span> <span class="n">default_storage_id</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span>
</span><span id="BaseClient.initialize_client_with_defaults-112"><a href="#BaseClient.initialize_client_with_defaults-112"><span class="linenos">112</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">client_config</span><span class="p">[</span><span class="s1">&#39;default_compute_id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">default_compute_id</span> <span class="k">if</span> <span class="n">default_compute_id</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span>
</span></pre></div>

        </details>

            <div class="docstring"><p>initializes the client and a user with given configuration</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>protocol</strong>:  protocol to be used for server call</li>
<li><strong>ip</strong>:  ip address of the server</li>
<li><strong>port</strong>:  port on which the rest service resides</li>
<li><strong>refresh_token</strong>:  refresh_token of the user</li>
<li><strong>default_compute_id</strong>:  Pass the default compute id to be used for all the artifacts to be created</li>
<li><strong>default_storage_id</strong>:  Pass the default storage id to be used for all the artifacts to be created</li>
<li><strong>default_environment_id</strong>:  Pass the default environment id to be used for all the artifacts to be created</li>
</ul>
</div>


                            </div>
                            <div id="BaseClient.get_configurations" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#BaseClient.get_configurations">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">get_configurations</span><span class="signature">(self)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="BaseClient.get_configurations-114"><a href="#BaseClient.get_configurations-114"><span class="linenos">114</span></a>    <span class="k">def</span> <span class="nf">get_configurations</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="BaseClient.get_configurations-115"><a href="#BaseClient.get_configurations-115"><span class="linenos">115</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="BaseClient.get_configurations-116"><a href="#BaseClient.get_configurations-116"><span class="linenos">116</span></a><span class="sd">        returns client configurations</span>
</span><span id="BaseClient.get_configurations-117"><a href="#BaseClient.get_configurations-117"><span class="linenos">117</span></a><span class="sd">        :return: configuration dictionary</span>
</span><span id="BaseClient.get_configurations-118"><a href="#BaseClient.get_configurations-118"><span class="linenos">118</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="BaseClient.get_configurations-119"><a href="#BaseClient.get_configurations-119"><span class="linenos">119</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">client_config</span>
</span></pre></div>

        </details>

            <div class="docstring"><p>returns client configurations</p>

<h6 id="returns">Returns</h6>

<blockquote>
  <p>configuration dictionary</p>
</blockquote>
</div>


                            </div>
                            <div id="BaseClient.regenerate_bearer_token_if_needed" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#BaseClient.regenerate_bearer_token_if_needed">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">regenerate_bearer_token_if_needed</span><span class="signature">(self, headers)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="BaseClient.regenerate_bearer_token_if_needed-121"><a href="#BaseClient.regenerate_bearer_token_if_needed-121"><span class="linenos">121</span></a>    <span class="k">def</span> <span class="nf">regenerate_bearer_token_if_needed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">headers</span><span class="p">):</span>
</span><span id="BaseClient.regenerate_bearer_token_if_needed-122"><a href="#BaseClient.regenerate_bearer_token_if_needed-122"><span class="linenos">122</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">is_token_valid</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">client_config</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">http</span><span class="p">):</span>
</span><span id="BaseClient.regenerate_bearer_token_if_needed-123"><a href="#BaseClient.regenerate_bearer_token_if_needed-123"><span class="linenos">123</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">client_config</span><span class="p">[</span><span class="s1">&#39;bearer_token&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_bearer_token</span><span class="p">(</span><span class="n">protocol</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">client_config</span><span class="p">[</span><span class="s2">&quot;protocol&quot;</span><span class="p">],</span>
</span><span id="BaseClient.regenerate_bearer_token_if_needed-124"><a href="#BaseClient.regenerate_bearer_token_if_needed-124"><span class="linenos">124</span></a>                                                                  <span class="n">ip</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">client_config</span><span class="p">[</span><span class="s2">&quot;ip&quot;</span><span class="p">],</span>
</span><span id="BaseClient.regenerate_bearer_token_if_needed-125"><a href="#BaseClient.regenerate_bearer_token_if_needed-125"><span class="linenos">125</span></a>                                                                  <span class="n">port</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">client_config</span><span class="p">[</span><span class="s2">&quot;port&quot;</span><span class="p">],</span>
</span><span id="BaseClient.regenerate_bearer_token_if_needed-126"><a href="#BaseClient.regenerate_bearer_token_if_needed-126"><span class="linenos">126</span></a>                                                                  <span class="n">refresh_token</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">client_config</span><span class="p">[</span><span class="s2">&quot;refresh_token&quot;</span><span class="p">])</span>
</span><span id="BaseClient.regenerate_bearer_token_if_needed-127"><a href="#BaseClient.regenerate_bearer_token_if_needed-127"><span class="linenos">127</span></a>            <span class="n">headers</span> <span class="o">=</span> <span class="n">IWUtils</span><span class="o">.</span><span class="n">get_default_header_for_v3</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">client_config</span><span class="p">[</span><span class="s1">&#39;bearer_token&#39;</span><span class="p">])</span>
</span><span id="BaseClient.regenerate_bearer_token_if_needed-128"><a href="#BaseClient.regenerate_bearer_token_if_needed-128"><span class="linenos">128</span></a>        <span class="k">return</span> <span class="n">headers</span>
</span></pre></div>

        </details>

    

                            </div>
                            <div id="BaseClient.call_api" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#BaseClient.call_api">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">call_api</span><span class="signature">(self, method, url, headers=None, data=None)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="BaseClient.call_api-130"><a href="#BaseClient.call_api-130"><span class="linenos">130</span></a>    <span class="k">def</span> <span class="nf">call_api</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="BaseClient.call_api-131"><a href="#BaseClient.call_api-131"><span class="linenos">131</span></a>        <span class="c1"># headers = self.regenerate_bearer_token_if_needed(headers)</span>
</span><span id="BaseClient.call_api-132"><a href="#BaseClient.call_api-132"><span class="linenos">132</span></a>        <span class="k">if</span> <span class="n">method</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;GET&quot;</span><span class="p">:</span>
</span><span id="BaseClient.call_api-133"><a href="#BaseClient.call_api-133"><span class="linenos">133</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Calling </span><span class="si">{</span><span class="n">url</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="BaseClient.call_api-134"><a href="#BaseClient.call_api-134"><span class="linenos">134</span></a>            <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">http</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="n">local_configurations</span><span class="o">.</span><span class="n">REQUEST_TIMEOUT_IN_SEC</span><span class="p">,</span>
</span><span id="BaseClient.call_api-135"><a href="#BaseClient.call_api-135"><span class="linenos">135</span></a>                                     <span class="n">verify</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
</span><span id="BaseClient.call_api-136"><a href="#BaseClient.call_api-136"><span class="linenos">136</span></a>            <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">406</span><span class="p">:</span>
</span><span id="BaseClient.call_api-137"><a href="#BaseClient.call_api-137"><span class="linenos">137</span></a>                <span class="n">headers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">regenerate_bearer_token_if_needed</span><span class="p">(</span><span class="n">headers</span><span class="p">)</span>
</span><span id="BaseClient.call_api-138"><a href="#BaseClient.call_api-138"><span class="linenos">138</span></a>                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">http</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="n">local_configurations</span><span class="o">.</span><span class="n">REQUEST_TIMEOUT_IN_SEC</span><span class="p">,</span>
</span><span id="BaseClient.call_api-139"><a href="#BaseClient.call_api-139"><span class="linenos">139</span></a>                                     <span class="n">verify</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
</span><span id="BaseClient.call_api-140"><a href="#BaseClient.call_api-140"><span class="linenos">140</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="BaseClient.call_api-141"><a href="#BaseClient.call_api-141"><span class="linenos">141</span></a>                <span class="k">return</span> <span class="n">response</span>
</span><span id="BaseClient.call_api-142"><a href="#BaseClient.call_api-142"><span class="linenos">142</span></a>        <span class="k">elif</span> <span class="n">method</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;POST&quot;</span><span class="p">:</span>
</span><span id="BaseClient.call_api-143"><a href="#BaseClient.call_api-143"><span class="linenos">143</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Calling </span><span class="si">{</span><span class="n">url</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="BaseClient.call_api-144"><a href="#BaseClient.call_api-144"><span class="linenos">144</span></a>            <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">http</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
</span><span id="BaseClient.call_api-145"><a href="#BaseClient.call_api-145"><span class="linenos">145</span></a>                                      <span class="n">timeout</span><span class="o">=</span><span class="n">local_configurations</span><span class="o">.</span><span class="n">REQUEST_TIMEOUT_IN_SEC</span><span class="p">,</span> <span class="n">verify</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="BaseClient.call_api-146"><a href="#BaseClient.call_api-146"><span class="linenos">146</span></a>            <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">406</span><span class="p">:</span>
</span><span id="BaseClient.call_api-147"><a href="#BaseClient.call_api-147"><span class="linenos">147</span></a>                <span class="n">headers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">regenerate_bearer_token_if_needed</span><span class="p">(</span><span class="n">headers</span><span class="p">)</span>
</span><span id="BaseClient.call_api-148"><a href="#BaseClient.call_api-148"><span class="linenos">148</span></a>                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">http</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
</span><span id="BaseClient.call_api-149"><a href="#BaseClient.call_api-149"><span class="linenos">149</span></a>                                      <span class="n">timeout</span><span class="o">=</span><span class="n">local_configurations</span><span class="o">.</span><span class="n">REQUEST_TIMEOUT_IN_SEC</span><span class="p">,</span> <span class="n">verify</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="BaseClient.call_api-150"><a href="#BaseClient.call_api-150"><span class="linenos">150</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="BaseClient.call_api-151"><a href="#BaseClient.call_api-151"><span class="linenos">151</span></a>                <span class="k">return</span> <span class="n">response</span>
</span><span id="BaseClient.call_api-152"><a href="#BaseClient.call_api-152"><span class="linenos">152</span></a>        <span class="k">elif</span> <span class="n">method</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;PUT&quot;</span><span class="p">:</span>
</span><span id="BaseClient.call_api-153"><a href="#BaseClient.call_api-153"><span class="linenos">153</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Calling </span><span class="si">{</span><span class="n">url</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="BaseClient.call_api-154"><a href="#BaseClient.call_api-154"><span class="linenos">154</span></a>            <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">http</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
</span><span id="BaseClient.call_api-155"><a href="#BaseClient.call_api-155"><span class="linenos">155</span></a>                                     <span class="n">timeout</span><span class="o">=</span><span class="n">local_configurations</span><span class="o">.</span><span class="n">REQUEST_TIMEOUT_IN_SEC</span><span class="p">,</span> <span class="n">verify</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="BaseClient.call_api-156"><a href="#BaseClient.call_api-156"><span class="linenos">156</span></a>            <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">406</span><span class="p">:</span>
</span><span id="BaseClient.call_api-157"><a href="#BaseClient.call_api-157"><span class="linenos">157</span></a>                <span class="n">headers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">regenerate_bearer_token_if_needed</span><span class="p">(</span><span class="n">headers</span><span class="p">)</span>
</span><span id="BaseClient.call_api-158"><a href="#BaseClient.call_api-158"><span class="linenos">158</span></a>                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">http</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
</span><span id="BaseClient.call_api-159"><a href="#BaseClient.call_api-159"><span class="linenos">159</span></a>                                     <span class="n">timeout</span><span class="o">=</span><span class="n">local_configurations</span><span class="o">.</span><span class="n">REQUEST_TIMEOUT_IN_SEC</span><span class="p">,</span> <span class="n">verify</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="BaseClient.call_api-160"><a href="#BaseClient.call_api-160"><span class="linenos">160</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="BaseClient.call_api-161"><a href="#BaseClient.call_api-161"><span class="linenos">161</span></a>                <span class="k">return</span> <span class="n">response</span>
</span><span id="BaseClient.call_api-162"><a href="#BaseClient.call_api-162"><span class="linenos">162</span></a>        <span class="k">elif</span> <span class="n">method</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;PATCH&quot;</span><span class="p">:</span>
</span><span id="BaseClient.call_api-163"><a href="#BaseClient.call_api-163"><span class="linenos">163</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Calling </span><span class="si">{</span><span class="n">url</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="BaseClient.call_api-164"><a href="#BaseClient.call_api-164"><span class="linenos">164</span></a>            <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">http</span><span class="o">.</span><span class="n">patch</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
</span><span id="BaseClient.call_api-165"><a href="#BaseClient.call_api-165"><span class="linenos">165</span></a>                                       <span class="n">timeout</span><span class="o">=</span><span class="n">local_configurations</span><span class="o">.</span><span class="n">REQUEST_TIMEOUT_IN_SEC</span><span class="p">,</span> <span class="n">verify</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="BaseClient.call_api-166"><a href="#BaseClient.call_api-166"><span class="linenos">166</span></a>            <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">406</span><span class="p">:</span>
</span><span id="BaseClient.call_api-167"><a href="#BaseClient.call_api-167"><span class="linenos">167</span></a>                <span class="n">headers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">regenerate_bearer_token_if_needed</span><span class="p">(</span><span class="n">headers</span><span class="p">)</span>
</span><span id="BaseClient.call_api-168"><a href="#BaseClient.call_api-168"><span class="linenos">168</span></a>                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">http</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
</span><span id="BaseClient.call_api-169"><a href="#BaseClient.call_api-169"><span class="linenos">169</span></a>                                     <span class="n">timeout</span><span class="o">=</span><span class="n">local_configurations</span><span class="o">.</span><span class="n">REQUEST_TIMEOUT_IN_SEC</span><span class="p">,</span> <span class="n">verify</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="BaseClient.call_api-170"><a href="#BaseClient.call_api-170"><span class="linenos">170</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="BaseClient.call_api-171"><a href="#BaseClient.call_api-171"><span class="linenos">171</span></a>                <span class="k">return</span> <span class="n">response</span>
</span><span id="BaseClient.call_api-172"><a href="#BaseClient.call_api-172"><span class="linenos">172</span></a>        <span class="k">elif</span> <span class="n">method</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;DELETE&quot;</span><span class="p">:</span>
</span><span id="BaseClient.call_api-173"><a href="#BaseClient.call_api-173"><span class="linenos">173</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Calling </span><span class="si">{</span><span class="n">url</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="BaseClient.call_api-174"><a href="#BaseClient.call_api-174"><span class="linenos">174</span></a>            <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">http</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="n">local_configurations</span><span class="o">.</span><span class="n">REQUEST_TIMEOUT_IN_SEC</span><span class="p">,</span>
</span><span id="BaseClient.call_api-175"><a href="#BaseClient.call_api-175"><span class="linenos">175</span></a>                                        <span class="n">verify</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="BaseClient.call_api-176"><a href="#BaseClient.call_api-176"><span class="linenos">176</span></a>            <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">406</span><span class="p">:</span>
</span><span id="BaseClient.call_api-177"><a href="#BaseClient.call_api-177"><span class="linenos">177</span></a>                <span class="n">headers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">regenerate_bearer_token_if_needed</span><span class="p">(</span><span class="n">headers</span><span class="p">)</span>
</span><span id="BaseClient.call_api-178"><a href="#BaseClient.call_api-178"><span class="linenos">178</span></a>                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">http</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="n">local_configurations</span><span class="o">.</span><span class="n">REQUEST_TIMEOUT_IN_SEC</span><span class="p">,</span>
</span><span id="BaseClient.call_api-179"><a href="#BaseClient.call_api-179"><span class="linenos">179</span></a>                                        <span class="n">verify</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="BaseClient.call_api-180"><a href="#BaseClient.call_api-180"><span class="linenos">180</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="BaseClient.call_api-181"><a href="#BaseClient.call_api-181"><span class="linenos">181</span></a>                <span class="k">return</span> <span class="n">response</span>
</span></pre></div>

        </details>

    

                            </div>
                            <div id="BaseClient.get_mappings_from_config_file" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#BaseClient.get_mappings_from_config_file">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">get_mappings_from_config_file</span><span class="signature">(self, ini_config_file_path)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="BaseClient.get_mappings_from_config_file-183"><a href="#BaseClient.get_mappings_from_config_file-183"><span class="linenos">183</span></a>    <span class="k">def</span> <span class="nf">get_mappings_from_config_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ini_config_file_path</span><span class="p">):</span>
</span><span id="BaseClient.get_mappings_from_config_file-184"><a href="#BaseClient.get_mappings_from_config_file-184"><span class="linenos">184</span></a>        <span class="n">config</span> <span class="o">=</span> <span class="n">ConfigParser</span><span class="p">()</span>
</span><span id="BaseClient.get_mappings_from_config_file-185"><a href="#BaseClient.get_mappings_from_config_file-185"><span class="linenos">185</span></a>        <span class="n">config</span><span class="o">.</span><span class="n">optionxform</span> <span class="o">=</span> <span class="nb">str</span>
</span><span id="BaseClient.get_mappings_from_config_file-186"><a href="#BaseClient.get_mappings_from_config_file-186"><span class="linenos">186</span></a>        <span class="n">config</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">ini_config_file_path</span><span class="p">)</span>
</span><span id="BaseClient.get_mappings_from_config_file-187"><a href="#BaseClient.get_mappings_from_config_file-187"><span class="linenos">187</span></a>        <span class="k">if</span> <span class="s2">&quot;environment&quot;</span> <span class="ow">in</span> <span class="n">config</span><span class="p">:</span>
</span><span id="BaseClient.get_mappings_from_config_file-188"><a href="#BaseClient.get_mappings_from_config_file-188"><span class="linenos">188</span></a>            <span class="n">default_environment_id</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;environment&quot;</span><span class="p">,</span> <span class="s2">&quot;environment_id&quot;</span><span class="p">)</span>
</span><span id="BaseClient.get_mappings_from_config_file-189"><a href="#BaseClient.get_mappings_from_config_file-189"><span class="linenos">189</span></a>            <span class="n">default_storage_id</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;environment&quot;</span><span class="p">,</span> <span class="s2">&quot;storage_id&quot;</span><span class="p">)</span>
</span><span id="BaseClient.get_mappings_from_config_file-190"><a href="#BaseClient.get_mappings_from_config_file-190"><span class="linenos">190</span></a>            <span class="n">default_interactive_id</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;environment&quot;</span><span class="p">,</span> <span class="s2">&quot;interactive_id&quot;</span><span class="p">)</span>
</span><span id="BaseClient.get_mappings_from_config_file-191"><a href="#BaseClient.get_mappings_from_config_file-191"><span class="linenos">191</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">client_config</span><span class="p">[</span><span class="s2">&quot;default_environment_id&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">default_environment_id</span>
</span><span id="BaseClient.get_mappings_from_config_file-192"><a href="#BaseClient.get_mappings_from_config_file-192"><span class="linenos">192</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">client_config</span><span class="p">[</span><span class="s2">&quot;default_storage_id&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">default_storage_id</span>
</span><span id="BaseClient.get_mappings_from_config_file-193"><a href="#BaseClient.get_mappings_from_config_file-193"><span class="linenos">193</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">client_config</span><span class="p">[</span><span class="s2">&quot;default_compute_id&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">default_interactive_id</span>
</span><span id="BaseClient.get_mappings_from_config_file-194"><a href="#BaseClient.get_mappings_from_config_file-194"><span class="linenos">194</span></a>        <span class="k">if</span> <span class="s2">&quot;environment_mappings&quot;</span> <span class="ow">in</span> <span class="n">config</span><span class="p">:</span>
</span><span id="BaseClient.get_mappings_from_config_file-195"><a href="#BaseClient.get_mappings_from_config_file-195"><span class="linenos">195</span></a>            <span class="n">environment_mappings</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">items</span><span class="p">(</span><span class="s2">&quot;environment_mappings&quot;</span><span class="p">))</span>
</span><span id="BaseClient.get_mappings_from_config_file-196"><a href="#BaseClient.get_mappings_from_config_file-196"><span class="linenos">196</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">mappings</span><span class="p">[</span><span class="s2">&quot;environment_mappings&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">environment_mappings</span>
</span><span id="BaseClient.get_mappings_from_config_file-197"><a href="#BaseClient.get_mappings_from_config_file-197"><span class="linenos">197</span></a>        <span class="k">if</span> <span class="s2">&quot;storage_mappings&quot;</span> <span class="ow">in</span> <span class="n">config</span><span class="p">:</span>
</span><span id="BaseClient.get_mappings_from_config_file-198"><a href="#BaseClient.get_mappings_from_config_file-198"><span class="linenos">198</span></a>            <span class="n">storage_mappings</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">items</span><span class="p">(</span><span class="s2">&quot;storage_mappings&quot;</span><span class="p">))</span>
</span><span id="BaseClient.get_mappings_from_config_file-199"><a href="#BaseClient.get_mappings_from_config_file-199"><span class="linenos">199</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">mappings</span><span class="p">[</span><span class="s2">&quot;storage_mappings&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">storage_mappings</span>
</span><span id="BaseClient.get_mappings_from_config_file-200"><a href="#BaseClient.get_mappings_from_config_file-200"><span class="linenos">200</span></a>        <span class="k">if</span> <span class="s2">&quot;compute_mappings&quot;</span> <span class="ow">in</span> <span class="n">config</span><span class="p">:</span>
</span><span id="BaseClient.get_mappings_from_config_file-201"><a href="#BaseClient.get_mappings_from_config_file-201"><span class="linenos">201</span></a>            <span class="n">compute_mappings</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">items</span><span class="p">(</span><span class="s2">&quot;compute_mappings&quot;</span><span class="p">))</span>
</span><span id="BaseClient.get_mappings_from_config_file-202"><a href="#BaseClient.get_mappings_from_config_file-202"><span class="linenos">202</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">mappings</span><span class="p">[</span><span class="s2">&quot;compute_mappings&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">compute_mappings</span>
</span><span id="BaseClient.get_mappings_from_config_file-203"><a href="#BaseClient.get_mappings_from_config_file-203"><span class="linenos">203</span></a>        <span class="k">if</span> <span class="s2">&quot;gcp_details&quot;</span> <span class="ow">in</span> <span class="n">config</span><span class="p">:</span>
</span><span id="BaseClient.get_mappings_from_config_file-204"><a href="#BaseClient.get_mappings_from_config_file-204"><span class="linenos">204</span></a>            <span class="n">gcp_details</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">items</span><span class="p">(</span><span class="s2">&quot;gcp_details&quot;</span><span class="p">))</span>
</span><span id="BaseClient.get_mappings_from_config_file-205"><a href="#BaseClient.get_mappings_from_config_file-205"><span class="linenos">205</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">mappings</span><span class="p">[</span><span class="s2">&quot;gcp_details&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">gcp_details</span>
</span><span id="BaseClient.get_mappings_from_config_file-206"><a href="#BaseClient.get_mappings_from_config_file-206"><span class="linenos">206</span></a>        <span class="k">if</span> <span class="s2">&quot;gcp_project_id_mappings&quot;</span> <span class="ow">in</span> <span class="n">config</span><span class="p">:</span>
</span><span id="BaseClient.get_mappings_from_config_file-207"><a href="#BaseClient.get_mappings_from_config_file-207"><span class="linenos">207</span></a>            <span class="n">gcp_project_id_mappings</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">items</span><span class="p">(</span><span class="s2">&quot;gcp_project_id_mappings&quot;</span><span class="p">))</span>
</span><span id="BaseClient.get_mappings_from_config_file-208"><a href="#BaseClient.get_mappings_from_config_file-208"><span class="linenos">208</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">mappings</span><span class="p">[</span><span class="s2">&quot;gcp_project_id_mappings&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">gcp_project_id_mappings</span>
</span><span id="BaseClient.get_mappings_from_config_file-209"><a href="#BaseClient.get_mappings_from_config_file-209"><span class="linenos">209</span></a>        <span class="k">if</span> <span class="s2">&quot;service_json_mappings&quot;</span> <span class="ow">in</span> <span class="n">config</span><span class="p">:</span>
</span><span id="BaseClient.get_mappings_from_config_file-210"><a href="#BaseClient.get_mappings_from_config_file-210"><span class="linenos">210</span></a>            <span class="n">service_json_mappings</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">items</span><span class="p">(</span><span class="s2">&quot;service_json_mappings&quot;</span><span class="p">))</span>
</span><span id="BaseClient.get_mappings_from_config_file-211"><a href="#BaseClient.get_mappings_from_config_file-211"><span class="linenos">211</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">mappings</span><span class="p">[</span><span class="s2">&quot;service_json_mappings&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">service_json_mappings</span>
</span><span id="BaseClient.get_mappings_from_config_file-212"><a href="#BaseClient.get_mappings_from_config_file-212"><span class="linenos">212</span></a>        <span class="k">if</span> <span class="s2">&quot;table_group_compute_mappings&quot;</span> <span class="ow">in</span> <span class="n">config</span><span class="p">:</span>
</span><span id="BaseClient.get_mappings_from_config_file-213"><a href="#BaseClient.get_mappings_from_config_file-213"><span class="linenos">213</span></a>            <span class="n">table_group_compute_mappings</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">items</span><span class="p">(</span><span class="s2">&quot;table_group_compute_mappings&quot;</span><span class="p">))</span>
</span><span id="BaseClient.get_mappings_from_config_file-214"><a href="#BaseClient.get_mappings_from_config_file-214"><span class="linenos">214</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">mappings</span><span class="p">[</span><span class="s2">&quot;table_group_compute_mappings&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">table_group_compute_mappings</span>
</span><span id="BaseClient.get_mappings_from_config_file-215"><a href="#BaseClient.get_mappings_from_config_file-215"><span class="linenos">215</span></a>        <span class="k">if</span> <span class="s2">&quot;kms&quot;</span> <span class="ow">in</span> <span class="n">config</span><span class="p">:</span>
</span><span id="BaseClient.get_mappings_from_config_file-216"><a href="#BaseClient.get_mappings_from_config_file-216"><span class="linenos">216</span></a>            <span class="n">kms</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">items</span><span class="p">(</span><span class="s2">&quot;kms&quot;</span><span class="p">))</span>
</span><span id="BaseClient.get_mappings_from_config_file-217"><a href="#BaseClient.get_mappings_from_config_file-217"><span class="linenos">217</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">mappings</span><span class="p">[</span><span class="s2">&quot;kms&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kms</span>
</span></pre></div>

        </details>

    

                            </div>
                            <div id="BaseClient.get_all_secrets" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#BaseClient.get_all_secrets">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">get_all_secrets</span><span class="signature">(self, secret_type, ini_config_file_path=None, keys=None)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span id="BaseClient.get_all_secrets-230"><a href="#BaseClient.get_all_secrets-230"><span class="linenos">230</span></a>    <span class="k">def</span> <span class="nf">get_all_secrets</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">secret_type</span><span class="p">,</span> <span class="n">ini_config_file_path</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">keys</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="BaseClient.get_all_secrets-231"><a href="#BaseClient.get_all_secrets-231"><span class="linenos">231</span></a>        <span class="c1"># Read all secrets from file and load inmemory</span>
</span><span id="BaseClient.get_all_secrets-232"><a href="#BaseClient.get_all_secrets-232"><span class="linenos">232</span></a>        <span class="c1"># Encrypt using infoworks encoding</span>
</span><span id="BaseClient.get_all_secrets-233"><a href="#BaseClient.get_all_secrets-233"><span class="linenos">233</span></a>        <span class="k">if</span> <span class="n">secret_type</span> <span class="o">==</span> <span class="s2">&quot;gcp_kms&quot;</span> <span class="ow">and</span> <span class="n">ini_config_file_path</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="BaseClient.get_all_secrets-234"><a href="#BaseClient.get_all_secrets-234"><span class="linenos">234</span></a>            <span class="n">config</span> <span class="o">=</span> <span class="n">ConfigParser</span><span class="p">()</span>
</span><span id="BaseClient.get_all_secrets-235"><a href="#BaseClient.get_all_secrets-235"><span class="linenos">235</span></a>            <span class="n">config</span><span class="o">.</span><span class="n">optionxform</span> <span class="o">=</span> <span class="nb">str</span>
</span><span id="BaseClient.get_all_secrets-236"><a href="#BaseClient.get_all_secrets-236"><span class="linenos">236</span></a>            <span class="n">config</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">ini_config_file_path</span><span class="p">)</span>
</span><span id="BaseClient.get_all_secrets-237"><a href="#BaseClient.get_all_secrets-237"><span class="linenos">237</span></a>            <span class="c1"># Cloud KMS CryptoKey Encrypter</span>
</span><span id="BaseClient.get_all_secrets-238"><a href="#BaseClient.get_all_secrets-238"><span class="linenos">238</span></a>            <span class="n">service_json_path</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;gcp_kms&quot;</span><span class="p">,</span> <span class="s2">&quot;service_json_path&quot;</span><span class="p">)</span>
</span><span id="BaseClient.get_all_secrets-239"><a href="#BaseClient.get_all_secrets-239"><span class="linenos">239</span></a>            <span class="c1"># Reading Config Parameters</span>
</span><span id="BaseClient.get_all_secrets-240"><a href="#BaseClient.get_all_secrets-240"><span class="linenos">240</span></a>            <span class="n">projectId</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;gcp_kms&quot;</span><span class="p">,</span> <span class="s2">&quot;projectId&quot;</span><span class="p">)</span>
</span><span id="BaseClient.get_all_secrets-241"><a href="#BaseClient.get_all_secrets-241"><span class="linenos">241</span></a>            <span class="n">locationId</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;gcp_kms&quot;</span><span class="p">,</span> <span class="s2">&quot;locationId&quot;</span><span class="p">)</span>
</span><span id="BaseClient.get_all_secrets-242"><a href="#BaseClient.get_all_secrets-242"><span class="linenos">242</span></a>            <span class="n">keyRingId</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;gcp_kms&quot;</span><span class="p">,</span> <span class="s2">&quot;keyRingId&quot;</span><span class="p">)</span>
</span><span id="BaseClient.get_all_secrets-243"><a href="#BaseClient.get_all_secrets-243"><span class="linenos">243</span></a>            <span class="n">keyId</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;gcp_kms&quot;</span><span class="p">,</span> <span class="s2">&quot;keyId&quot;</span><span class="p">)</span>
</span><span id="BaseClient.get_all_secrets-244"><a href="#BaseClient.get_all_secrets-244"><span class="linenos">244</span></a>            <span class="n">bucketName</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;gcp_kms&quot;</span><span class="p">,</span> <span class="s2">&quot;bucketName&quot;</span><span class="p">)</span>
</span><span id="BaseClient.get_all_secrets-245"><a href="#BaseClient.get_all_secrets-245"><span class="linenos">245</span></a>            <span class="n">blobName</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;gcp_kms&quot;</span><span class="p">,</span> <span class="s2">&quot;encrypted_key_filename&quot;</span><span class="p">)</span>
</span><span id="BaseClient.get_all_secrets-246"><a href="#BaseClient.get_all_secrets-246"><span class="linenos">246</span></a>            <span class="c1"># Reading Encrypted Password File from Cloud Storage</span>
</span><span id="BaseClient.get_all_secrets-247"><a href="#BaseClient.get_all_secrets-247"><span class="linenos">247</span></a>            <span class="n">storageClient</span> <span class="o">=</span> <span class="n">storage</span><span class="o">.</span><span class="n">Client</span><span class="o">.</span><span class="n">from_service_account_json</span><span class="p">(</span><span class="n">service_json_path</span><span class="p">)</span>
</span><span id="BaseClient.get_all_secrets-248"><a href="#BaseClient.get_all_secrets-248"><span class="linenos">248</span></a>            <span class="n">bucket</span> <span class="o">=</span> <span class="n">storageClient</span><span class="o">.</span><span class="n">get_bucket</span><span class="p">(</span><span class="n">bucketName</span><span class="p">)</span>
</span><span id="BaseClient.get_all_secrets-249"><a href="#BaseClient.get_all_secrets-249"><span class="linenos">249</span></a>            <span class="n">blobFile</span> <span class="o">=</span> <span class="n">bucket</span><span class="o">.</span><span class="n">get_blob</span><span class="p">(</span><span class="n">blobName</span><span class="p">)</span>
</span><span id="BaseClient.get_all_secrets-250"><a href="#BaseClient.get_all_secrets-250"><span class="linenos">250</span></a>            <span class="n">cipherText</span> <span class="o">=</span> <span class="n">blobFile</span><span class="o">.</span><span class="n">download_as_string</span><span class="p">()</span>
</span><span id="BaseClient.get_all_secrets-251"><a href="#BaseClient.get_all_secrets-251"><span class="linenos">251</span></a>            <span class="n">kmsClient</span> <span class="o">=</span> <span class="n">kms</span><span class="o">.</span><span class="n">KeyManagementServiceClient</span><span class="o">.</span><span class="n">from_service_account_json</span><span class="p">(</span><span class="n">service_json_path</span><span class="p">)</span>
</span><span id="BaseClient.get_all_secrets-252"><a href="#BaseClient.get_all_secrets-252"><span class="linenos">252</span></a>            <span class="n">keyName</span> <span class="o">=</span> <span class="n">kmsClient</span><span class="o">.</span><span class="n">crypto_key_path</span><span class="p">(</span><span class="n">projectId</span><span class="p">,</span> <span class="n">locationId</span><span class="p">,</span> <span class="n">keyRingId</span><span class="p">,</span> <span class="n">keyId</span><span class="p">)</span>
</span><span id="BaseClient.get_all_secrets-253"><a href="#BaseClient.get_all_secrets-253"><span class="linenos">253</span></a>            <span class="c1"># Decrypt Password</span>
</span><span id="BaseClient.get_all_secrets-254"><a href="#BaseClient.get_all_secrets-254"><span class="linenos">254</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="BaseClient.get_all_secrets-255"><a href="#BaseClient.get_all_secrets-255"><span class="linenos">255</span></a>                <span class="n">decryptPassword</span> <span class="o">=</span> <span class="n">kmsClient</span><span class="o">.</span><span class="n">decrypt</span><span class="p">(</span><span class="n">request</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="n">keyName</span><span class="p">,</span> <span class="s1">&#39;ciphertext&#39;</span><span class="p">:</span> <span class="n">cipherText</span><span class="p">})</span>
</span><span id="BaseClient.get_all_secrets-256"><a href="#BaseClient.get_all_secrets-256"><span class="linenos">256</span></a>                <span class="n">plainText</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">decryptPassword</span><span class="o">.</span><span class="n">plaintext</span><span class="p">,</span> <span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>
</span><span id="BaseClient.get_all_secrets-257"><a href="#BaseClient.get_all_secrets-257"><span class="linenos">257</span></a>                <span class="n">plainTextStr</span> <span class="o">=</span> <span class="n">plainText</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span><span id="BaseClient.get_all_secrets-258"><a href="#BaseClient.get_all_secrets-258"><span class="linenos">258</span></a>                <span class="n">passwordsDictPlain</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">plainTextStr</span><span class="p">)</span>
</span><span id="BaseClient.get_all_secrets-259"><a href="#BaseClient.get_all_secrets-259"><span class="linenos">259</span></a>                <span class="n">passwordsDictEncrypted</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="BaseClient.get_all_secrets-260"><a href="#BaseClient.get_all_secrets-260"><span class="linenos">260</span></a>                <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">passwordsDictPlain</span><span class="p">:</span>
</span><span id="BaseClient.get_all_secrets-261"><a href="#BaseClient.get_all_secrets-261"><span class="linenos">261</span></a>                    <span class="n">passwordsDictEncrypted</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">aes_encrypt</span><span class="p">(</span><span class="n">passwordsDictPlain</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
</span><span id="BaseClient.get_all_secrets-262"><a href="#BaseClient.get_all_secrets-262"><span class="linenos">262</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">secrets_config</span> <span class="o">=</span> <span class="n">passwordsDictEncrypted</span>
</span><span id="BaseClient.get_all_secrets-263"><a href="#BaseClient.get_all_secrets-263"><span class="linenos">263</span></a>            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="BaseClient.get_all_secrets-264"><a href="#BaseClient.get_all_secrets-264"><span class="linenos">264</span></a>                <span class="nb">print</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
</span><span id="BaseClient.get_all_secrets-265"><a href="#BaseClient.get_all_secrets-265"><span class="linenos">265</span></a>                <span class="k">return</span> <span class="s2">&quot;&quot;</span>
</span><span id="BaseClient.get_all_secrets-266"><a href="#BaseClient.get_all_secrets-266"><span class="linenos">266</span></a>        <span class="k">elif</span> <span class="n">secret_type</span> <span class="o">==</span> <span class="s2">&quot;aws_kms&quot;</span> <span class="ow">and</span> <span class="n">ini_config_file_path</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="BaseClient.get_all_secrets-267"><a href="#BaseClient.get_all_secrets-267"><span class="linenos">267</span></a>            <span class="n">config</span> <span class="o">=</span> <span class="n">ConfigParser</span><span class="p">()</span>
</span><span id="BaseClient.get_all_secrets-268"><a href="#BaseClient.get_all_secrets-268"><span class="linenos">268</span></a>            <span class="n">config</span><span class="o">.</span><span class="n">optionxform</span> <span class="o">=</span> <span class="nb">str</span>
</span><span id="BaseClient.get_all_secrets-269"><a href="#BaseClient.get_all_secrets-269"><span class="linenos">269</span></a>            <span class="n">config</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">ini_config_file_path</span><span class="p">)</span>
</span><span id="BaseClient.get_all_secrets-270"><a href="#BaseClient.get_all_secrets-270"><span class="linenos">270</span></a>            <span class="c1"># Read the encrypted file into memory</span>
</span><span id="BaseClient.get_all_secrets-271"><a href="#BaseClient.get_all_secrets-271"><span class="linenos">271</span></a>            <span class="n">encrypted_filename</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;aws_kms&quot;</span><span class="p">,</span> <span class="s2">&quot;encrypted_filename&quot;</span><span class="p">)</span>
</span><span id="BaseClient.get_all_secrets-272"><a href="#BaseClient.get_all_secrets-272"><span class="linenos">272</span></a>            <span class="n">available_keys</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">items</span><span class="p">(</span><span class="s2">&quot;aws_kms&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
</span><span id="BaseClient.get_all_secrets-273"><a href="#BaseClient.get_all_secrets-273"><span class="linenos">273</span></a>            <span class="k">if</span> <span class="s2">&quot;access_id&quot;</span> <span class="ow">in</span> <span class="n">available_keys</span> <span class="ow">and</span> <span class="s2">&quot;secret_key&quot;</span> <span class="ow">in</span> <span class="n">available_keys</span><span class="p">:</span>
</span><span id="BaseClient.get_all_secrets-274"><a href="#BaseClient.get_all_secrets-274"><span class="linenos">274</span></a>                <span class="n">ACCESS_KEY</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;aws_kms&quot;</span><span class="p">,</span> <span class="s2">&quot;access_id&quot;</span><span class="p">)</span>
</span><span id="BaseClient.get_all_secrets-275"><a href="#BaseClient.get_all_secrets-275"><span class="linenos">275</span></a>                <span class="n">SECRET_KEY</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;aws_kms&quot;</span><span class="p">,</span> <span class="s2">&quot;secret_key&quot;</span><span class="p">)</span>
</span><span id="BaseClient.get_all_secrets-276"><a href="#BaseClient.get_all_secrets-276"><span class="linenos">276</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="BaseClient.get_all_secrets-277"><a href="#BaseClient.get_all_secrets-277"><span class="linenos">277</span></a>                <span class="n">ACCESS_KEY</span><span class="p">,</span> <span class="n">SECRET_KEY</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>
</span><span id="BaseClient.get_all_secrets-278"><a href="#BaseClient.get_all_secrets-278"><span class="linenos">278</span></a>            <span class="c1"># Read</span>
</span><span id="BaseClient.get_all_secrets-279"><a href="#BaseClient.get_all_secrets-279"><span class="linenos">279</span></a>            <span class="n">NUM_BYTES_FOR_LEN</span> <span class="o">=</span> <span class="mi">4</span>
</span><span id="BaseClient.get_all_secrets-280"><a href="#BaseClient.get_all_secrets-280"><span class="linenos">280</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="BaseClient.get_all_secrets-281"><a href="#BaseClient.get_all_secrets-281"><span class="linenos">281</span></a>                <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">encrypted_filename</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
</span><span id="BaseClient.get_all_secrets-282"><a href="#BaseClient.get_all_secrets-282"><span class="linenos">282</span></a>                    <span class="n">file_contents</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span><span id="BaseClient.get_all_secrets-283"><a href="#BaseClient.get_all_secrets-283"><span class="linenos">283</span></a>            <span class="k">except</span> <span class="ne">IOError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="BaseClient.get_all_secrets-284"><a href="#BaseClient.get_all_secrets-284"><span class="linenos">284</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
</span><span id="BaseClient.get_all_secrets-285"><a href="#BaseClient.get_all_secrets-285"><span class="linenos">285</span></a>                <span class="k">return</span> <span class="kc">False</span>
</span><span id="BaseClient.get_all_secrets-286"><a href="#BaseClient.get_all_secrets-286"><span class="linenos">286</span></a>            <span class="n">data_key_encrypted_len</span> <span class="o">=</span> <span class="nb">int</span><span class="o">.</span><span class="n">from_bytes</span><span class="p">(</span><span class="n">file_contents</span><span class="p">[:</span><span class="n">NUM_BYTES_FOR_LEN</span><span class="p">],</span>
</span><span id="BaseClient.get_all_secrets-287"><a href="#BaseClient.get_all_secrets-287"><span class="linenos">287</span></a>                                                    <span class="n">byteorder</span><span class="o">=</span><span class="s1">&#39;big&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="n">NUM_BYTES_FOR_LEN</span>
</span><span id="BaseClient.get_all_secrets-288"><a href="#BaseClient.get_all_secrets-288"><span class="linenos">288</span></a>            <span class="n">data_key_encrypted</span> <span class="o">=</span> <span class="n">file_contents</span><span class="p">[</span><span class="n">NUM_BYTES_FOR_LEN</span><span class="p">:</span><span class="n">data_key_encrypted_len</span><span class="p">]</span>
</span><span id="BaseClient.get_all_secrets-289"><a href="#BaseClient.get_all_secrets-289"><span class="linenos">289</span></a>            <span class="c1"># Decrypt the data key before using it</span>
</span><span id="BaseClient.get_all_secrets-290"><a href="#BaseClient.get_all_secrets-290"><span class="linenos">290</span></a>            <span class="k">if</span> <span class="n">ACCESS_KEY</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">SECRET_KEY</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="BaseClient.get_all_secrets-291"><a href="#BaseClient.get_all_secrets-291"><span class="linenos">291</span></a>                <span class="n">kms_client</span> <span class="o">=</span> <span class="n">boto3</span><span class="o">.</span><span class="n">client</span><span class="p">(</span><span class="s1">&#39;kms&#39;</span><span class="p">,</span> <span class="n">aws_access_key_id</span><span class="o">=</span><span class="n">ACCESS_KEY</span><span class="p">,</span> <span class="n">aws_secret_access_key</span><span class="o">=</span><span class="n">SECRET_KEY</span><span class="p">)</span>
</span><span id="BaseClient.get_all_secrets-292"><a href="#BaseClient.get_all_secrets-292"><span class="linenos">292</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="BaseClient.get_all_secrets-293"><a href="#BaseClient.get_all_secrets-293"><span class="linenos">293</span></a>                <span class="n">kms_client</span> <span class="o">=</span> <span class="n">boto3</span><span class="o">.</span><span class="n">client</span><span class="p">(</span><span class="s1">&#39;kms&#39;</span><span class="p">)</span>
</span><span id="BaseClient.get_all_secrets-294"><a href="#BaseClient.get_all_secrets-294"><span class="linenos">294</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="BaseClient.get_all_secrets-295"><a href="#BaseClient.get_all_secrets-295"><span class="linenos">295</span></a>                <span class="n">response</span> <span class="o">=</span> <span class="n">kms_client</span><span class="o">.</span><span class="n">decrypt</span><span class="p">(</span><span class="n">CiphertextBlob</span><span class="o">=</span><span class="n">data_key_encrypted</span><span class="p">)</span>
</span><span id="BaseClient.get_all_secrets-296"><a href="#BaseClient.get_all_secrets-296"><span class="linenos">296</span></a>                <span class="n">data_key_plaintext</span> <span class="o">=</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64encode</span><span class="p">((</span><span class="n">response</span><span class="p">[</span><span class="s1">&#39;Plaintext&#39;</span><span class="p">]))</span>
</span><span id="BaseClient.get_all_secrets-297"><a href="#BaseClient.get_all_secrets-297"><span class="linenos">297</span></a>            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="BaseClient.get_all_secrets-298"><a href="#BaseClient.get_all_secrets-298"><span class="linenos">298</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
</span><span id="BaseClient.get_all_secrets-299"><a href="#BaseClient.get_all_secrets-299"><span class="linenos">299</span></a>                <span class="k">return</span> <span class="kc">False</span>
</span><span id="BaseClient.get_all_secrets-300"><a href="#BaseClient.get_all_secrets-300"><span class="linenos">300</span></a>
</span><span id="BaseClient.get_all_secrets-301"><a href="#BaseClient.get_all_secrets-301"><span class="linenos">301</span></a>            <span class="k">if</span> <span class="n">data_key_plaintext</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="BaseClient.get_all_secrets-302"><a href="#BaseClient.get_all_secrets-302"><span class="linenos">302</span></a>                <span class="k">return</span> <span class="kc">False</span>
</span><span id="BaseClient.get_all_secrets-303"><a href="#BaseClient.get_all_secrets-303"><span class="linenos">303</span></a>            <span class="c1"># Decrypt the rest of the file</span>
</span><span id="BaseClient.get_all_secrets-304"><a href="#BaseClient.get_all_secrets-304"><span class="linenos">304</span></a>            <span class="n">f</span> <span class="o">=</span> <span class="n">Fernet</span><span class="p">(</span><span class="n">data_key_plaintext</span><span class="p">)</span>
</span><span id="BaseClient.get_all_secrets-305"><a href="#BaseClient.get_all_secrets-305"><span class="linenos">305</span></a>            <span class="n">file_contents_decrypted</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">decrypt</span><span class="p">(</span><span class="n">file_contents</span><span class="p">[</span><span class="n">data_key_encrypted_len</span><span class="p">:])</span>
</span><span id="BaseClient.get_all_secrets-306"><a href="#BaseClient.get_all_secrets-306"><span class="linenos">306</span></a>            <span class="n">passwordsDictPlain</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">file_contents_decrypted</span><span class="p">)</span>
</span><span id="BaseClient.get_all_secrets-307"><a href="#BaseClient.get_all_secrets-307"><span class="linenos">307</span></a>            <span class="n">passwordsDictEncrypted</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="BaseClient.get_all_secrets-308"><a href="#BaseClient.get_all_secrets-308"><span class="linenos">308</span></a>            <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">passwordsDictPlain</span><span class="p">:</span>
</span><span id="BaseClient.get_all_secrets-309"><a href="#BaseClient.get_all_secrets-309"><span class="linenos">309</span></a>                <span class="n">passwordsDictEncrypted</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">aes_encrypt</span><span class="p">(</span><span class="n">passwordsDictPlain</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
</span><span id="BaseClient.get_all_secrets-310"><a href="#BaseClient.get_all_secrets-310"><span class="linenos">310</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">secrets_config</span> <span class="o">=</span> <span class="n">passwordsDictEncrypted</span>
</span><span id="BaseClient.get_all_secrets-311"><a href="#BaseClient.get_all_secrets-311"><span class="linenos">311</span></a>            <span class="k">return</span> <span class="kc">True</span>
</span><span id="BaseClient.get_all_secrets-312"><a href="#BaseClient.get_all_secrets-312"><span class="linenos">312</span></a>        <span class="k">elif</span> <span class="n">secret_type</span> <span class="o">==</span> <span class="s2">&quot;aws_secrets&quot;</span><span class="p">:</span>
</span><span id="BaseClient.get_all_secrets-313"><a href="#BaseClient.get_all_secrets-313"><span class="linenos">313</span></a>            <span class="n">ACCESS_KEY</span><span class="p">,</span> <span class="n">SECRET_KEY</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>
</span><span id="BaseClient.get_all_secrets-314"><a href="#BaseClient.get_all_secrets-314"><span class="linenos">314</span></a>            <span class="n">region</span> <span class="o">=</span> <span class="s1">&#39;us-west-2&#39;</span>
</span><span id="BaseClient.get_all_secrets-315"><a href="#BaseClient.get_all_secrets-315"><span class="linenos">315</span></a>            <span class="k">if</span> <span class="n">ini_config_file_path</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="BaseClient.get_all_secrets-316"><a href="#BaseClient.get_all_secrets-316"><span class="linenos">316</span></a>                <span class="n">config</span> <span class="o">=</span> <span class="n">ConfigParser</span><span class="p">()</span>
</span><span id="BaseClient.get_all_secrets-317"><a href="#BaseClient.get_all_secrets-317"><span class="linenos">317</span></a>                <span class="n">config</span><span class="o">.</span><span class="n">optionxform</span> <span class="o">=</span> <span class="nb">str</span>
</span><span id="BaseClient.get_all_secrets-318"><a href="#BaseClient.get_all_secrets-318"><span class="linenos">318</span></a>                <span class="n">config</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">ini_config_file_path</span><span class="p">)</span>
</span><span id="BaseClient.get_all_secrets-319"><a href="#BaseClient.get_all_secrets-319"><span class="linenos">319</span></a>                <span class="n">available_keys</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">items</span><span class="p">(</span><span class="s2">&quot;aws_secrets&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
</span><span id="BaseClient.get_all_secrets-320"><a href="#BaseClient.get_all_secrets-320"><span class="linenos">320</span></a>                <span class="k">if</span> <span class="s2">&quot;access_id&quot;</span> <span class="ow">in</span> <span class="n">available_keys</span> <span class="ow">and</span> <span class="s2">&quot;secret_key&quot;</span> <span class="ow">in</span> <span class="n">available_keys</span><span class="p">:</span>
</span><span id="BaseClient.get_all_secrets-321"><a href="#BaseClient.get_all_secrets-321"><span class="linenos">321</span></a>                    <span class="n">ACCESS_KEY</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;aws_secrets&quot;</span><span class="p">,</span> <span class="s2">&quot;access_id&quot;</span><span class="p">)</span>
</span><span id="BaseClient.get_all_secrets-322"><a href="#BaseClient.get_all_secrets-322"><span class="linenos">322</span></a>                    <span class="n">SECRET_KEY</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;aws_secrets&quot;</span><span class="p">,</span> <span class="s2">&quot;secret_key&quot;</span><span class="p">)</span>
</span><span id="BaseClient.get_all_secrets-323"><a href="#BaseClient.get_all_secrets-323"><span class="linenos">323</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="BaseClient.get_all_secrets-324"><a href="#BaseClient.get_all_secrets-324"><span class="linenos">324</span></a>                    <span class="n">ACCESS_KEY</span><span class="p">,</span> <span class="n">SECRET_KEY</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>
</span><span id="BaseClient.get_all_secrets-325"><a href="#BaseClient.get_all_secrets-325"><span class="linenos">325</span></a>                <span class="k">if</span> <span class="s2">&quot;region&quot;</span> <span class="ow">in</span> <span class="n">available_keys</span><span class="p">:</span>
</span><span id="BaseClient.get_all_secrets-326"><a href="#BaseClient.get_all_secrets-326"><span class="linenos">326</span></a>                    <span class="n">region</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;aws_secrets&quot;</span><span class="p">,</span> <span class="s2">&quot;region&quot;</span><span class="p">)</span>
</span><span id="BaseClient.get_all_secrets-327"><a href="#BaseClient.get_all_secrets-327"><span class="linenos">327</span></a>            <span class="k">if</span> <span class="n">keys</span><span class="p">:</span>
</span><span id="BaseClient.get_all_secrets-328"><a href="#BaseClient.get_all_secrets-328"><span class="linenos">328</span></a>                <span class="n">output_values</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="BaseClient.get_all_secrets-329"><a href="#BaseClient.get_all_secrets-329"><span class="linenos">329</span></a>                <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">keys</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">):</span>
</span><span id="BaseClient.get_all_secrets-330"><a href="#BaseClient.get_all_secrets-330"><span class="linenos">330</span></a>                    <span class="n">secrets_client</span> <span class="o">=</span> <span class="n">boto3</span><span class="o">.</span><span class="n">client</span><span class="p">(</span><span class="s2">&quot;secretsmanager&quot;</span><span class="p">,</span> <span class="n">region_name</span><span class="o">=</span><span class="n">region</span><span class="p">)</span>
</span><span id="BaseClient.get_all_secrets-331"><a href="#BaseClient.get_all_secrets-331"><span class="linenos">331</span></a>                    <span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;SecretId&#39;</span><span class="p">:</span> <span class="n">key</span><span class="p">}</span>
</span><span id="BaseClient.get_all_secrets-332"><a href="#BaseClient.get_all_secrets-332"><span class="linenos">332</span></a>                    <span class="k">try</span><span class="p">:</span>
</span><span id="BaseClient.get_all_secrets-333"><a href="#BaseClient.get_all_secrets-333"><span class="linenos">333</span></a>                        <span class="n">value</span> <span class="o">=</span> <span class="n">secrets_client</span><span class="o">.</span><span class="n">get_secret_value</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)[</span><span class="s2">&quot;SecretString&quot;</span><span class="p">]</span>
</span><span id="BaseClient.get_all_secrets-334"><a href="#BaseClient.get_all_secrets-334"><span class="linenos">334</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">secrets_config</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="BaseClient.get_all_secrets-335"><a href="#BaseClient.get_all_secrets-335"><span class="linenos">335</span></a>                        <span class="n">output_values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</span><span id="BaseClient.get_all_secrets-336"><a href="#BaseClient.get_all_secrets-336"><span class="linenos">336</span></a>                    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="BaseClient.get_all_secrets-337"><a href="#BaseClient.get_all_secrets-337"><span class="linenos">337</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
</span><span id="BaseClient.get_all_secrets-338"><a href="#BaseClient.get_all_secrets-338"><span class="linenos">338</span></a>                <span class="k">return</span> <span class="n">output_values</span>
</span><span id="BaseClient.get_all_secrets-339"><a href="#BaseClient.get_all_secrets-339"><span class="linenos">339</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="BaseClient.get_all_secrets-340"><a href="#BaseClient.get_all_secrets-340"><span class="linenos">340</span></a>                <span class="c1"># Get all the secrets</span>
</span><span id="BaseClient.get_all_secrets-341"><a href="#BaseClient.get_all_secrets-341"><span class="linenos">341</span></a>                <span class="k">if</span> <span class="n">ACCESS_KEY</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">SECRET_KEY</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="BaseClient.get_all_secrets-342"><a href="#BaseClient.get_all_secrets-342"><span class="linenos">342</span></a>                    <span class="n">secrets_client</span> <span class="o">=</span> <span class="n">boto3</span><span class="o">.</span><span class="n">client</span><span class="p">(</span><span class="s2">&quot;secretsmanager&quot;</span><span class="p">,</span> <span class="n">aws_access_key_id</span><span class="o">=</span><span class="n">ACCESS_KEY</span><span class="p">,</span>
</span><span id="BaseClient.get_all_secrets-343"><a href="#BaseClient.get_all_secrets-343"><span class="linenos">343</span></a>                                                  <span class="n">aws_secret_access_key</span><span class="o">=</span><span class="n">SECRET_KEY</span><span class="p">,</span> <span class="n">region</span><span class="o">=</span><span class="n">region</span><span class="p">)</span>
</span><span id="BaseClient.get_all_secrets-344"><a href="#BaseClient.get_all_secrets-344"><span class="linenos">344</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="BaseClient.get_all_secrets-345"><a href="#BaseClient.get_all_secrets-345"><span class="linenos">345</span></a>                    <span class="n">secrets_client</span> <span class="o">=</span> <span class="n">boto3</span><span class="o">.</span><span class="n">client</span><span class="p">(</span><span class="s2">&quot;secretsmanager&quot;</span><span class="p">,</span><span class="n">region</span><span class="o">=</span><span class="n">region</span><span class="p">)</span>
</span><span id="BaseClient.get_all_secrets-346"><a href="#BaseClient.get_all_secrets-346"><span class="linenos">346</span></a>                <span class="n">temp</span> <span class="o">=</span> <span class="n">secrets_client</span><span class="o">.</span><span class="n">list_secrets</span><span class="p">()[</span><span class="s2">&quot;SecretList&quot;</span><span class="p">]</span>
</span><span id="BaseClient.get_all_secrets-347"><a href="#BaseClient.get_all_secrets-347"><span class="linenos">347</span></a>                <span class="n">all_secrets</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="p">[</span><span class="s2">&quot;Name&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">temp</span><span class="p">]</span>
</span><span id="BaseClient.get_all_secrets-348"><a href="#BaseClient.get_all_secrets-348"><span class="linenos">348</span></a>                <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">all_secrets</span><span class="p">:</span>
</span><span id="BaseClient.get_all_secrets-349"><a href="#BaseClient.get_all_secrets-349"><span class="linenos">349</span></a>                    <span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;SecretId&#39;</span><span class="p">:</span> <span class="n">key</span><span class="p">}</span>
</span><span id="BaseClient.get_all_secrets-350"><a href="#BaseClient.get_all_secrets-350"><span class="linenos">350</span></a>                    <span class="k">try</span><span class="p">:</span>
</span><span id="BaseClient.get_all_secrets-351"><a href="#BaseClient.get_all_secrets-351"><span class="linenos">351</span></a>                        <span class="n">value</span> <span class="o">=</span> <span class="n">secrets_client</span><span class="o">.</span><span class="n">get_secret_value</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)[</span><span class="s2">&quot;SecretString&quot;</span><span class="p">]</span>
</span><span id="BaseClient.get_all_secrets-352"><a href="#BaseClient.get_all_secrets-352"><span class="linenos">352</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">secrets_config</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</span><span id="BaseClient.get_all_secrets-353"><a href="#BaseClient.get_all_secrets-353"><span class="linenos">353</span></a>                    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="BaseClient.get_all_secrets-354"><a href="#BaseClient.get_all_secrets-354"><span class="linenos">354</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
</span><span id="BaseClient.get_all_secrets-355"><a href="#BaseClient.get_all_secrets-355"><span class="linenos">355</span></a>        <span class="k">elif</span> <span class="n">secret_type</span> <span class="o">==</span> <span class="s2">&quot;azure_keyvault&quot;</span><span class="p">:</span>
</span><span id="BaseClient.get_all_secrets-356"><a href="#BaseClient.get_all_secrets-356"><span class="linenos">356</span></a>            <span class="kn">from</span> <span class="nn">azure.keyvault.secrets</span> <span class="kn">import</span> <span class="n">SecretClient</span>
</span><span id="BaseClient.get_all_secrets-357"><a href="#BaseClient.get_all_secrets-357"><span class="linenos">357</span></a>            <span class="kn">from</span> <span class="nn">azure.identity</span> <span class="kn">import</span> <span class="n">ClientSecretCredential</span>
</span><span id="BaseClient.get_all_secrets-358"><a href="#BaseClient.get_all_secrets-358"><span class="linenos">358</span></a>            <span class="n">config</span> <span class="o">=</span> <span class="n">ConfigParser</span><span class="p">()</span>
</span><span id="BaseClient.get_all_secrets-359"><a href="#BaseClient.get_all_secrets-359"><span class="linenos">359</span></a>            <span class="n">config</span><span class="o">.</span><span class="n">optionxform</span> <span class="o">=</span> <span class="nb">str</span>
</span><span id="BaseClient.get_all_secrets-360"><a href="#BaseClient.get_all_secrets-360"><span class="linenos">360</span></a>            <span class="n">config</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">ini_config_file_path</span><span class="p">)</span>
</span><span id="BaseClient.get_all_secrets-361"><a href="#BaseClient.get_all_secrets-361"><span class="linenos">361</span></a>            <span class="c1"># Read the encrypted file into memory</span>
</span><span id="BaseClient.get_all_secrets-362"><a href="#BaseClient.get_all_secrets-362"><span class="linenos">362</span></a>            <span class="n">available_keys</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">items</span><span class="p">(</span><span class="s2">&quot;azure_keyvault&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
</span><span id="BaseClient.get_all_secrets-363"><a href="#BaseClient.get_all_secrets-363"><span class="linenos">363</span></a>            <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="n">x</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;keyVaultName&#39;</span><span class="p">,</span> <span class="s1">&#39;tenant_id&#39;</span><span class="p">,</span> <span class="s1">&#39;client_id&#39;</span><span class="p">,</span> <span class="s1">&#39;client_secret&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">available_keys</span><span class="p">):</span>
</span><span id="BaseClient.get_all_secrets-364"><a href="#BaseClient.get_all_secrets-364"><span class="linenos">364</span></a>                <span class="n">keyVaultName</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;azure_keyvault&quot;</span><span class="p">,</span> <span class="s2">&quot;keyVaultName&quot;</span><span class="p">)</span>
</span><span id="BaseClient.get_all_secrets-365"><a href="#BaseClient.get_all_secrets-365"><span class="linenos">365</span></a>                <span class="n">KVUri</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;https://</span><span class="si">{</span><span class="n">keyVaultName</span><span class="si">}</span><span class="s2">.vault.azure.net&quot;</span>
</span><span id="BaseClient.get_all_secrets-366"><a href="#BaseClient.get_all_secrets-366"><span class="linenos">366</span></a>                <span class="n">tenant_id</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;azure_keyvault&quot;</span><span class="p">,</span> <span class="s2">&quot;tenant_id&quot;</span><span class="p">)</span>
</span><span id="BaseClient.get_all_secrets-367"><a href="#BaseClient.get_all_secrets-367"><span class="linenos">367</span></a>                <span class="n">client_id</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;azure_keyvault&quot;</span><span class="p">,</span> <span class="s2">&quot;client_id&quot;</span><span class="p">)</span>
</span><span id="BaseClient.get_all_secrets-368"><a href="#BaseClient.get_all_secrets-368"><span class="linenos">368</span></a>                <span class="n">client_secret</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;azure_keyvault&quot;</span><span class="p">,</span> <span class="s2">&quot;client_secret&quot;</span><span class="p">)</span>
</span><span id="BaseClient.get_all_secrets-369"><a href="#BaseClient.get_all_secrets-369"><span class="linenos">369</span></a>                <span class="n">credential</span> <span class="o">=</span> <span class="n">ClientSecretCredential</span><span class="p">(</span><span class="n">tenant_id</span><span class="p">,</span> <span class="n">client_id</span><span class="p">,</span> <span class="n">client_secret</span><span class="p">)</span>
</span><span id="BaseClient.get_all_secrets-370"><a href="#BaseClient.get_all_secrets-370"><span class="linenos">370</span></a>                <span class="n">client</span> <span class="o">=</span> <span class="n">SecretClient</span><span class="p">(</span><span class="n">vault_url</span><span class="o">=</span><span class="n">KVUri</span><span class="p">,</span> <span class="n">credential</span><span class="o">=</span><span class="n">credential</span><span class="p">)</span>
</span><span id="BaseClient.get_all_secrets-371"><a href="#BaseClient.get_all_secrets-371"><span class="linenos">371</span></a>                <span class="k">if</span> <span class="n">keys</span><span class="p">:</span>
</span><span id="BaseClient.get_all_secrets-372"><a href="#BaseClient.get_all_secrets-372"><span class="linenos">372</span></a>                    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">keys</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">):</span>
</span><span id="BaseClient.get_all_secrets-373"><a href="#BaseClient.get_all_secrets-373"><span class="linenos">373</span></a>                        <span class="n">retrieved_secret</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">get_secret</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
</span><span id="BaseClient.get_all_secrets-374"><a href="#BaseClient.get_all_secrets-374"><span class="linenos">374</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">secrets_config</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">aes_encrypt</span><span class="p">(</span><span class="n">retrieved_secret</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
</span><span id="BaseClient.get_all_secrets-375"><a href="#BaseClient.get_all_secrets-375"><span class="linenos">375</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="BaseClient.get_all_secrets-376"><a href="#BaseClient.get_all_secrets-376"><span class="linenos">376</span></a>                    <span class="n">secret_properties</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">list_properties_of_secrets</span><span class="p">()</span>
</span><span id="BaseClient.get_all_secrets-377"><a href="#BaseClient.get_all_secrets-377"><span class="linenos">377</span></a>                    <span class="n">all_secrets</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">secret_properties</span><span class="p">]</span>
</span><span id="BaseClient.get_all_secrets-378"><a href="#BaseClient.get_all_secrets-378"><span class="linenos">378</span></a>                    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">all_secrets</span><span class="p">:</span>
</span><span id="BaseClient.get_all_secrets-379"><a href="#BaseClient.get_all_secrets-379"><span class="linenos">379</span></a>                        <span class="n">retrieved_secret</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">get_secret</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
</span><span id="BaseClient.get_all_secrets-380"><a href="#BaseClient.get_all_secrets-380"><span class="linenos">380</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">secrets_config</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">aes_encrypt</span><span class="p">(</span><span class="n">retrieved_secret</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
</span><span id="BaseClient.get_all_secrets-381"><a href="#BaseClient.get_all_secrets-381"><span class="linenos">381</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">secrets_config</span><span class="p">[</span><span class="s2">&quot;custom_secrets_read&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
</span></pre></div>

        </details>

    

                            </div>
                </section>
    </main>
<script>
    function escapeHTML(html) {
        return document.createElement('div').appendChild(document.createTextNode(html)).parentNode.innerHTML;
    }

    const originalContent = document.querySelector("main.pdoc");
    let currentContent = originalContent;

    function setContent(innerHTML) {
        let elem;
        if (innerHTML) {
            elem = document.createElement("main");
            elem.classList.add("pdoc");
            elem.innerHTML = innerHTML;
        } else {
            elem = originalContent;
        }
        if (currentContent !== elem) {
            currentContent.replaceWith(elem);
            currentContent = elem;
        }
    }

    function getSearchTerm() {
        return (new URL(window.location)).searchParams.get("search");
    }

    const searchBox = document.querySelector(".pdoc input[type=search]");
    searchBox.addEventListener("input", function () {
        let url = new URL(window.location);
        if (searchBox.value.trim()) {
            url.hash = "";
            url.searchParams.set("search", searchBox.value);
        } else {
            url.searchParams.delete("search");
        }
        history.replaceState("", "", url.toString());
        onInput();
    });
    window.addEventListener("popstate", onInput);


    let search, searchErr;

    async function initialize() {
        try {
            search = await new Promise((resolve, reject) => {
                const script = document.createElement("script");
                script.type = "text/javascript";
                script.async = true;
                script.onload = () => resolve(window.pdocSearch);
                script.onerror = (e) => reject(e);
                script.src = "../../search.js";
                document.getElementsByTagName("head")[0].appendChild(script);
            });
        } catch (e) {
            console.error("Cannot fetch pdoc search index");
            searchErr = "Cannot fetch search index.";
        }
        onInput();

        document.querySelector("nav.pdoc").addEventListener("click", e => {
            if (e.target.hash) {
                searchBox.value = "";
                searchBox.dispatchEvent(new Event("input"));
            }
        });
    }

    function onInput() {
        setContent((() => {
            const term = getSearchTerm();
            if (!term) {
                return null
            }
            if (searchErr) {
                return `<h3>Error: ${searchErr}</h3>`
            }
            if (!search) {
                return "<h3>Searching...</h3>"
            }

            window.scrollTo({top: 0, left: 0, behavior: 'auto'});

            const results = search(term);

            let html;
            if (results.length === 0) {
                html = `No search results for '${escapeHTML(term)}'.`
            } else {
                html = `<h4>${results.length} search result${results.length > 1 ? "s" : ""} for '${escapeHTML(term)}'.</h4>`;
            }
            for (let result of results.slice(0, 10)) {
                let doc = result.doc;
                let url = `../../${doc.modulename.replaceAll(".", "/")}.html`;
                if (doc.qualname) {
                    url += `#${doc.qualname}`;
                }

                let heading;
                switch (result.doc.type) {
                    case "function":
                        heading = `<span class="def">${doc.funcdef}</span> <span class="name">${doc.fullname}</span><span class="signature">${doc.signature}:</span>`;
                        break;
                    case "class":
                        heading = `<span class="def">class</span> <span class="name">${doc.fullname}</span>`;
                        if (doc.bases)
                            heading += `<wbr>(<span class="base">${doc.bases}</span>)`;
                        heading += `:`;
                        break;
                    case "variable":
                        heading = `<span class="name">${doc.fullname}</span>`;
                        if (doc.annotation)
                            heading += `<span class="annotation">${doc.annotation}</span>`;
                        if (doc.default_value)
                            heading += `<span class="default_value">${doc.default_value}</span>`;
                        break;
                    default:
                        heading = `<span class="name">${doc.fullname}</span>`;
                        break;
                }
                html += `
                        <section class="search-result">
                        <a href="${url}" class="attr ${doc.type}">${heading}</a>
                        <div class="docstring">${doc.doc}</div>
                        </section>
                    `;

            }
            return html;
        })());
    }

    if (getSearchTerm()) {
        initialize();
        searchBox.value = getSearchTerm();
        onInput();
    } else {
        searchBox.addEventListener("focus", initialize, {once: true});
    }

    searchBox.addEventListener("keydown", e => {
        if (["ArrowDown", "ArrowUp", "Enter"].includes(e.key)) {
            let focused = currentContent.querySelector(".search-result.focused");
            if (!focused) {
                currentContent.querySelector(".search-result").classList.add("focused");
            } else if (
                e.key === "ArrowDown"
                && focused.nextElementSibling
                && focused.nextElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.nextElementSibling.classList.add("focused");
                focused.nextElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "ArrowUp"
                && focused.previousElementSibling
                && focused.previousElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.previousElementSibling.classList.add("focused");
                focused.previousElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "Enter"
            ) {
                focused.querySelector("a").click();
            }
        }
    });
</script></body>
</html>